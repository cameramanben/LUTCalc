function LUTGamma(){this.lutMaker=new LUTs,this.nul=!1,this.gammas=[],this.isTrans=!1,this.ver=0,this.curIn=0,this.curOut=0,this.eiMult=1,this.stopShift=0,this.inL=!1,this.outL=!0,this.clip=!0,this.clipB=!0,this.clipW=!1,this.clipL=!0,this.sIn=!1,this.sMin=0,this.sMax=1,this.bClip=0,this.mClip=67025937,this.linList=[],this.inList=[],this.outList=[],this.disList=[],this.catList=[],this.subNames=[],this.gammaSub=[],this.gammaDat=[],this.gammaExt=[],this.kSmooth=1,this.doBlkHi=!1,this.doASCCDL=!1,this.doBlkGam=!1,this.doDisplay=!1,this.blkGamLStop=-1.5,this.blkGamFStop=2,this.blkGamUL=.1,this.blkGamLL=.09,this.blkGamF=this.blkGamUL-this.blkGamLL,this.blkGamP=1,this.blkGamR=.1,this.gts=[],this.disGts=[],this.disM=new Float64Array([1,0,0,0,1,0,0,0,1]),this.disInM=[],this.disOutM=[],this.displayCSMatrices(),this.dispInGt=0,this.dispOutGt=0,this.camClip=11.52,this.hdrOut=!1,this.al=1,this.bl=0,this.ad=1,this.bd=0,this.highRef=.9,this.asc=new Float64Array([1,1,1,0,0,0,1,1,1,1]),this.gammaList()}function LUTGammaLog(t,i){this.name=t,this.params=i,this.iso=800,this.cat=0}function LUTGammaLogClip(t,i){this.name=t,this.params=i,this.iso=800,this.cat=0}function LUTGammaCineon(t,i){this.name=t,this.cv=i.cv,this.mul=i.cv2d/i.nGamma,this.wp=i.wp,this.bl=Math.pow(10,(i.bp-this.wp)*this.mul),this.den=.9*(1-this.bl),this.p0=(Math.pow(10,-this.wp*this.mul)-this.bl)/this.den,this.d0=((Math.pow(10,(1e-4*this.cv-this.wp)*this.mul)-this.bl)/this.den-this.p0)/1e-4,this.iso=800,this.cat=0}function LUTGammaArri(t,i){this.name=t,this.sup=i,this.iso=800,this.cat=0,this.params=[],this.tHK=[],this.fHK=[],this.tHS=0,this.fHS=0,this.knee=!1,this.xm=0,2===this.sup?(this.recleg=!1,this.outleg=!1,this.nominalEI=400,this.blackSignal=.003907,this.blackOffset=977e-6,this.midGraySignal=.01,this.encodingGain=.256598,this.encodingOffset=.391007):(this.recleg=!0,this.outleg=!0,this.nominalEI=400,this.blackSignal=16/4095,this.blackOffset=0,this.midGraySignal=.01,this.encodingGain=500/1023*.525,this.encodingOffset=400/1023),this.changeISO(this.iso)}function LUTGammaLogC4(t){this.name=t,this.iso=800,this.cat=0,this.recleg=!0,this.outleg=!0,this.a=(Math.pow(2,18)-16)/117.45,this.oneovera=1/this.a,this.b=928/1023,this.c=95/1023,this.s=7*Math.LN2*Math.pow(2,7-14*this.c/this.b)/(this.a*this.b),this.oneovers=1/this.s,this.t=(Math.pow(2,-14*this.c/this.b+6)-64)/this.a,this.bund14=14/this.b,this.bdiv14=1/this.bund14}function LUTGammaCLog3(t){this.name=t,this.iso=800,this.cat=0}function LUTGammaNLog(t){this.name=t,this.iso=800,this.cat=0,this.logCut=451.7887494/1023}function LUTGammaLogLog(t,i){this.name=t,this.params=i,this.iso=800,this.cat=0}function LUTGammaDaVinci(t){this.name=t,this.a=.0075,this.b=7,this.c=.07329248,this.m=10.44426855,this.lin_cut=.00262409,this.log_cut=.02740668,this.rescale=1/.9,this.iso=800,this.cat=0}function LUTGammaAppleLog(t,i){this.name=t,this.params=i,this.iso=800,this.cat=0,this.R0=-.05641088,this.Rt=.01,this.cc=47.28711236,this.beta=.00964052,this.gamma=.08550479,this.delta=.69336945,this.Pt=this.cc*(this.Rt-this.R0)*(this.Rt-this.R0)}function LUTGammaLog2(t,i,a){this.name=t,this.iso=800,this.cat=0,this.linMax=i,this.linMin=a,this.cut=.01125,this.cutLog=Math.log(this.cut)/Math.LN2,this.stopMax=Math.log(i-a+this.cut)/Math.LN2-this.cutLog,this.stopVert=1/this.stopMax,this.rLowSlope=this.cut*Math.LN2*this.stopMax,this.fLowSlope=1/this.rLowSlope,this.linOffset=this.cut-this.linMin,this.drMul=this.stopMax*Math.LN2,this.dfMul=1/this.drMul}function LUTGammaGam(t,i){this.name=t,this.params=i,i[5]||1===i[0]?i[5]!==i[0]?this.gamma="γ"+i[5].toFixed(2).toString()+" (exp"+i[0].toFixed(2).toString()+")":this.gamma="γ"+i[0].toFixed(2).toString():this.gamma="",this.iso=800,this.cat=1}function LUTGammaBBCGam(t,i){this.name=t,this.params=i,i[5]||1===i[0]?i[5]!==i[0]?this.gamma="γ"+i[5].toFixed(2).toString()+" (exp"+i[0].toFixed(2).toString()+")":this.gamma="γ"+i[0].toFixed(2).toString():this.gamma="",this.iso=800,this.cat=1}function LUTGammaLin(t,i){this.name=t,this.iso=800,this.zero=i/.2,this.gamma="γ1.0 (18% Gray = "+i+")",this.cat=1}function LUTGammaPQ(t,i){this.name=t,this.ootf=i,this.cat=7,this.m1=2610/16384,this.m2=78.84375,this.c1=.8359375,this.c2=18.8515625,this.c3=18.6875,this.iso=800,this.setLw()}function LUTGammaHLG(t,i){this.name=t,this.a=i.a,this.b=i.b,this.c=i.c,this.cat=5,this.iso=800,this.nbI=1,this.nbO=1}function LUTGammaOOTFPQ(t,i){if(this.name=t,"string"==typeof i.scale)if("normalised"===i.scale.toLowerCase())this.s=.01;else this.s=100;else this.s=100;this.setLw(i.Lw,i.Lw),this.iso=800,this.gamma="",this.cat=1,this.hdrOOTF=!0}function LUTGammaOOTFHLG(t,i){if(this.name=t,"string"==typeof i.scale)if("normalised"===i.scale.toLowerCase())this.s=.001;else this.s=1;else this.s=1;this.setLw(i.Lw,i.Lw,i.Lb,i.Lb),this.nbI=1,this.nbO=1,this.iso=800,this.gamma="",this.cat=1,this.hdrOOTF=!0}function LUTGammaOOTFNone(t,i){this.setLw(i.Lw,i.Lw)}function LUTGammaITUProp(t,i){this.name=t,this.iso=800,this.cat=5,this.setM(i.m)}function LUTGammaBBC283(t,i){this.name=t,this.iso=800,this.cat=5,this.setM(i.m),this.setS(1)}function LUTGammaACEScc(t,i){this.name=t,this.iso=800,this.cat=0,this.low=Math.pow(2,-15),this.m=(Math.log(.5*this.low)/Math.log(2)+9.72)/17.52,this.low2=(9.72-15)/17.52,this.mid=(Math.log(65504)/Math.log(2)+9.72)/17.52}function LUTGammaACESProxy(t,i){this.name=t,this.iso=800,this.cat=0,10===i?(this.blk=64,this.mul=50,this.off=425,this.hi=1023):(this.blk=256,this.mul=200,this.off=1700,this.hi=4095),this.low=Math.pow(2,-9.72)/.9}function LUTGammaGen(t,i){this.name=t,this.params=i,this.iso=800,this.cat=2}function LUTGammaLUTSL3(t,i){this.name=t,this.lut=new LUTQSpline(i.buffer),this.iso=800,this.cat=2}function LUTGammaLUTSimple(t,i){this.name=t,this.log=new Float64Array(5),this.log[0]=5/Math.pow(2,i.clip),this.log[1]=i.loggy/i.clip,this.log[2]=(Math.log(1+this.log[1])-Math.log(this.log[1]))/Math.LN10,this.log[3]=Math.log(this.log[1])/Math.LN10,this.log[4]=this.log[0]/(this.log[1]*this.log[2]*Math.LN10),this.spline=new LUTQSpline(i.lut.buffer),this.iso=800,this.cat=2}function LUTGammaIOLUT(t,i){this.name=t,this.rec=new LUTQSpline(i.rec.lut.buffer),this.out=new LUTQSpline(i.out.lut.buffer),this.iso=800,this.cat=6}function LUTGammaDLog(t){this.name=t,this.iso=800,this.cat=6,this.clip=4.802951742,this.loggy=.02,this.log=new Float64Array(6),this.rec=[],this.out=[],this.reccon=3,this.outcon=3,this.loadLUTs()}function LUTGammaLA(t,i){this.lutMaker=i,this.name=t,this.iso=800,this.cat=4}function LUTGammaNull(t){this.name=t,this.iso=800,this.cat=3}function LUTGammaWorker(){this.gammas=new LUTGamma,addEventListener("message",(function(t){var i=t.data;if(void 0===i.t);else if(0!==i.t&&i.t<20&&i.v!==lutGammaWorker.gammas.ver)postMessage({p:i.p,t:i.t,v:i.v,resend:!0,d:i.d});else switch(i.t){case 0:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.setParams(i.d));break;case 1:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.oneDCalc(i.p,i.t,i.d));break;case 2:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.laCalcRGB(i.p,i.t,i.d));break;case 3:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.inCalcRGB(i.p,i.t,i.d));break;case 4:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.outCalcRGB(i.p,i.t,i.d));break;case 5:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.getLists(i.p,i.t));break;case 6:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.setLA(i.p,i.t,i.d));break;case 7:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.setLATitle(i.p,i.t,i.d));break;case 8:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.SL3Val(i.p,i.t,i.d));break;case 10:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.ioNames(i.p,i.t));break;case 11:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.chartVals(i.p,i.t));break;case 12:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.preview(i.p,i.t,i.d));break;case 14:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.previewLin(i.p,i.t,i.d));break;case 15:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.getPrimaries(i.p,i.t,i.d));break;case 16:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.psstColours(i.p,i.t,i.d));break;case 17:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.multiColours(i.p,i.t,i.d));break;case 18:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.chartRGB(i.p,i.t,i.d));break;case 19:lutGammaWorker.sendGammaMessage(lutGammaWorker.gammas.changePQ(i.p,i.t,i.d))}}),!1)}function getGammaWorkerString(){var t="";for(var i in t+=LUTGamma.toString()+"\n",LUTGamma.prototype)t+="LUTGamma.prototype."+i+"="+LUTGamma.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLog.toString()+"\n",LUTGammaLog.prototype)t+="LUTGammaLog.prototype."+i+"="+LUTGammaLog.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLogClip.toString()+"\n",LUTGammaLogClip.prototype)t+="LUTGammaLogClip.prototype."+i+"="+LUTGammaLogClip.prototype[i].toString()+"\n";for(var i in t+=LUTGammaCineon.toString()+"\n",LUTGammaCineon.prototype)t+="LUTGammaCineon.prototype."+i+"="+LUTGammaCineon.prototype[i].toString()+"\n";for(var i in t+=LUTGammaArri.toString()+"\n",LUTGammaArri.prototype)t+="LUTGammaArri.prototype."+i+"="+LUTGammaArri.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLogC4.toString()+"\n",LUTGammaLogC4.prototype)t+="LUTGammaLogC4.prototype."+i+"="+LUTGammaLogC4.prototype[i].toString()+"\n";for(var i in t+=LUTGammaCLog3.toString()+"\n",LUTGammaCLog3.prototype)t+="LUTGammaCLog3.prototype."+i+"="+LUTGammaCLog3.prototype[i].toString()+"\n";for(var i in t+=LUTGammaNLog.toString()+"\n",LUTGammaNLog.prototype)t+="LUTGammaNLog.prototype."+i+"="+LUTGammaNLog.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLogLog.toString()+"\n",LUTGammaLogLog.prototype)t+="LUTGammaLogLog.prototype."+i+"="+LUTGammaLogLog.prototype[i].toString()+"\n";for(var i in t+=LUTGammaDaVinci.toString()+"\n",LUTGammaDaVinci.prototype)t+="LUTGammaDaVinci.prototype."+i+"="+LUTGammaDaVinci.prototype[i].toString()+"\n";for(var i in t+=LUTGammaAppleLog.toString()+"\n",LUTGammaAppleLog.prototype)t+="LUTGammaAppleLog.prototype."+i+"="+LUTGammaAppleLog.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLog2.toString()+"\n",LUTGammaLog2.prototype)t+="LUTGammaLog2.prototype."+i+"="+LUTGammaLog2.prototype[i].toString()+"\n";for(var i in t+=LUTGammaGam.toString()+"\n",LUTGammaGam.prototype)t+="LUTGammaGam.prototype."+i+"="+LUTGammaGam.prototype[i].toString()+"\n";for(var i in t+=LUTGammaBBCGam.toString()+"\n",LUTGammaBBCGam.prototype)t+="LUTGammaBBCGam.prototype."+i+"="+LUTGammaBBCGam.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLin.toString()+"\n",LUTGammaLin.prototype)t+="LUTGammaLin.prototype."+i+"="+LUTGammaLin.prototype[i].toString()+"\n";for(var i in t+=LUTGammaPQ.toString()+"\n",LUTGammaPQ.prototype)t+="LUTGammaPQ.prototype."+i+"="+LUTGammaPQ.prototype[i].toString()+"\n";for(var i in t+=LUTGammaHLG.toString()+"\n",LUTGammaHLG.prototype)t+="LUTGammaHLG.prototype."+i+"="+LUTGammaHLG.prototype[i].toString()+"\n";for(var i in t+=LUTGammaOOTFPQ.toString()+"\n",LUTGammaOOTFPQ.prototype)t+="LUTGammaOOTFPQ.prototype."+i+"="+LUTGammaOOTFPQ.prototype[i].toString()+"\n";for(var i in t+=LUTGammaOOTFHLG.toString()+"\n",LUTGammaOOTFHLG.prototype)t+="LUTGammaOOTFHLG.prototype."+i+"="+LUTGammaOOTFHLG.prototype[i].toString()+"\n";for(var i in t+=LUTGammaOOTFNone.toString()+"\n",LUTGammaOOTFNone.prototype)t+="LUTGammaOOTFNone.prototype."+i+"="+LUTGammaOOTFNone.prototype[i].toString()+"\n";for(var i in t+=LUTGammaITUProp.toString()+"\n",LUTGammaITUProp.prototype)t+="LUTGammaITUProp.prototype."+i+"="+LUTGammaITUProp.prototype[i].toString()+"\n";for(var i in t+=LUTGammaBBC283.toString()+"\n",LUTGammaBBC283.prototype)t+="LUTGammaBBC283.prototype."+i+"="+LUTGammaBBC283.prototype[i].toString()+"\n";for(var i in t+=LUTGammaACEScc.toString()+"\n",LUTGammaACEScc.prototype)t+="LUTGammaACEScc.prototype."+i+"="+LUTGammaACEScc.prototype[i].toString()+"\n";for(var i in t+=LUTGammaACESProxy.toString()+"\n",LUTGammaACESProxy.prototype)t+="LUTGammaACESProxy.prototype."+i+"="+LUTGammaACESProxy.prototype[i].toString()+"\n";for(var i in t+=LUTGammaGen.toString()+"\n",LUTGammaGen.prototype)t+="LUTGammaGen.prototype."+i+"="+LUTGammaGen.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLUTSL3.toString()+"\n",LUTGammaLUTSL3.prototype)t+="LUTGammaLUTSL3.prototype."+i+"="+LUTGammaLUTSL3.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLUTSimple.toString()+"\n",LUTGammaLUTSimple.prototype)t+="LUTGammaLUTSimple.prototype."+i+"="+LUTGammaLUTSimple.prototype[i].toString()+"\n";for(var i in t+=LUTGammaDLog.toString()+"\n",LUTGammaDLog.prototype)t+="LUTGammaDLog.prototype."+i+"="+LUTGammaDLog.prototype[i].toString()+"\n";for(var i in t+=LUTGammaIOLUT.toString()+"\n",LUTGammaIOLUT.prototype)t+="LUTGammaIOLUT.prototype."+i+"="+LUTGammaIOLUT.prototype[i].toString()+"\n";for(var i in t+=LUTGammaLA.toString()+"\n",LUTGammaLA.prototype)t+="LUTGammaLA.prototype."+i+"="+LUTGammaLA.prototype[i].toString()+"\n";for(var i in t+=LUTGammaNull.toString()+"\n",LUTGammaNull.prototype)t+="LUTGammaNull.prototype."+i+"="+LUTGammaNull.prototype[i].toString()+"\n";for(var i in t+=LUTGammaWorker.toString()+"\n",LUTGammaWorker.prototype)t+="LUTGammaWorker.prototype."+i+"="+LUTGammaWorker.prototype[i].toString()+"\n";return t+="var lutGammaWorker = new LUTGammaWorker();\n"}LUTGamma.prototype.subIdx=function(t){switch(t){case"Sony":return 0;case"ARRI":return 1;case"Canon":return 2;case"Apple":return 3;case"Panasonic":return 4;case"RED":return 5;case"GoPro":return 6;case"Panavision":return 7;case"Blackmagic":return 8;case"Bolex":return 9;case"Fujifilm":return 10;case"Nikon":return 11;case"DJI":return 12;case"Log":return 13;case"Display":return 14;case"HDR Display":return 15;case"Linear / γ":return 16}return!1},LUTGamma.prototype.gammaList=function(){this.subNames=["Sony","ARRI","Canon","Apple","Panasonic","RED","GoPro","Panavision","Blackmagic","Bolex","Fujifilm","Nikon","DJI","Log","Display","HDR Display","Linear / γ","All"],this.SL3Idx=0,this.gammas.push(new LUTGammaLog("S-Log3",[.167792292,-.015581884,.255620723,4.736842106,10,.410557185,.052631579,.167360992,.0125])),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Log")]),this.gts.push("Sony S-Gamut3.cine"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("S-Log2",[.330000000129966,-.0291229262672453,.370522310728792,.707762557077626,10,.616244473086815,.0375840001141552,.0879765396,0])),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Log")]),this.gts.push("Sony S-Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("S-Log",[.3241960136,-.0286107171,.370522311,1,10,.616244474,.037584,.088290045,1e-15])),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Log")]),this.gts.push("Sony S-Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.arriIdxList=[this.gammas.length],this.gammas.push(new LUTGammaLogC4("LogC4")),this.gammaSub.push([this.subIdx("ARRI"),this.subIdx("Log")]),this.gts.push("ARRI Wide Gamut 4"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.arriIdxList.push(this.gammas.length),this.gammas.push(new LUTGammaArri("LogC (Sup 3.x & 4.x)",3)),this.gammaSub.push([this.subIdx("ARRI"),this.subIdx("Log")]),this.gts.push("Alexa Wide Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaArri("LogC (Sup 2.x)",2)),this.gammaSub.push([this.subIdx("ARRI"),this.subIdx("Log")]),this.gts.push("Alexa Wide Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("C-Log",[.3734467748,-.0467265867,.45310179472141,10.1596,10,.1251224801564,1,.00391002619746,-.0452664])),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Log")]),this.gts.push("Rec709"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Canon C-Log2",[.045164984,-.006747091156,.241360772,87.09937546,10,.092864125,1,0,-.006747091156])),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Log")]),this.gts.push("Canon Cinema Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaCLog3("Canon C-Log3")),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Log")]),this.gts.push("Canon Cinema Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaAppleLog("Apple Log")),this.gammaSub.push([this.subIdx("Apple"),this.subIdx("Log")]),this.gts.push("Rec2020"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaCineon("Cineon",{cv:1023,bp:95,wp:685,nGamma:.6,cv2d:.002})),this.gammaSub.push([this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Panasonic V-Log",[.198412698,-.024801587,.241514,.9,10,.598206,.00873,.181,.009])),this.gammaSub.push([this.subIdx("Panasonic"),this.subIdx("Log")]),this.gts.push("Panasonic V-Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Fujifilm F-Log",[.1144737,-.010630486,.344676,.5000004,10,.790453,.009468,.100537775,988889e-9])),this.gammaSub.push([this.subIdx("Fujifilm"),this.subIdx("Log")]),this.gts.push("Fujifilm F-Log Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaCineon("REDLogFilm",{cv:1023,bp:95,wp:685,nGamma:.6,cv2d:.002})),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLogLog("RED Log3G10",[.224282,155.975327,.01])),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaDaVinci("DaVinci Intermediate")),this.gammaSub.push([this.subIdx("Blackmagic"),this.subIdx("Log")]),this.gts.push("DaVinci Wide Gamut"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLog("BMD Pocket Film",[.195367159/.9,-.014273567/.9,.36274758,1.05345192*.9,10,.63659829,.027616437,.096214896,.0040712976])),this.gammaSub.push([this.subIdx("Blackmagic"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("BMD Film",[.2350042002,-.0218236752,.367608577,.86786483/.9,10,.644065346,.03135747,.114002127,.005519226/.9])),this.gammaSub.push([this.subIdx("Blackmagic"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("BMD Film4k",[.335139246,-.0311227209,.582240088,2.617961052/.9,10,.461883884,.231964429,.10772883,.005534931/.9])),this.gammaSub.push([this.subIdx("Blackmagic"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("BMD Film4.6k",[.195367159/.9,-.014273567/.9,.36274758,1.05345192*.9,10,.63659829,.027616437,.096214896,.0040712976])),this.gammaSub.push([this.subIdx("Blackmagic"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Bolex Log",[1/(5.9861078*.9),-.011605853287321168,.2756705,5,10,.4150634,.0280665,.152007,.014948/.9])),this.gammaSub.push([this.subIdx("Bolex"),this.subIdx("Log")]),this.gts.push("Bolex Wide Gamut"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Panalog",[.324196014,-.020278938,.434198361,.956463747,10,.665276427,.040913561,.088290045,0])),this.gammaSub.push([this.subIdx("Panavision"),this.subIdx("Log")]),this.gts.push("Rec709"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLog("Protune",[0,0,876/1023,53.39427221,113,64/1023,1,0,0])),this.gammaSub.push([this.subIdx("GoPro"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLog("DJI X5/X7/X9 DLog",[1/5.4225,-.0929/5.4225,.256663,.89028,10,.584555,.0108,.14,.00702])),this.gammaSub.push([this.subIdx("DJI"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.DLogM=this.gammas.length,this.gammas.push(new LUTGammaDLog("DJI DLog-M")),this.gammaSub.push([this.subIdx("DJI"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLogClip("DJI X3 DLog",[.188272019,-.011778504,.473218054,6.086793376,10,.419294419,.169033387,.095812746,.00625,.902863937,1.59668525,22.90700861,-17.39462704])),this.gammaSub.push([this.subIdx("DJI"),this.subIdx("Log")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("DJI Mini 2",{rec:{lut:new Float64Array([.0251383,.03474122,.04434413,.05394705,.06354996,.07315288,.08274788,.09241272,.10271576,.11311513,.12351429,.13391345,.14431261,.15471177,.1651332,.17361913,.18110689,.1881293,.19473345,.20096606,.20686704,.21247143,.21780622,.22289498,.22776349,.2322036,.2371525,.24470811,.25063847,.25650566,.26230818,.26802904,.27366776,.27922389,.2846982,.29009155,.29540394,.30063666,.30579119,.31086787,.3158684,.32079436,.32564634,.33042651,.33513583,.33977568,.34434806,.34885353,.35329444,.35767138,.36198634,.36624039,.37043494,.37457151,.37865104,.3826753,.38664498,.3905619,.39442666,.39824102,.40200558,.40572187,.40939073,.41301326,.41659065,.4201235,.4236134,.42706051,.43046663,.43383182,.43715761,.44044453,.44369326,.44690512,.45008015,.45321988,.45632454,.45939486,.46243198,.46543587,.46840787,.47134835,.474227,.47702901,.47995529,.48316779,.48666135,.49065065,.49522288,.49965819,.50408629,.5085185,.51295463,.5173946,.52183816,.52628528,.53073572,.53518944,.53964626,.54410607,.54856878,.55303423,.55750237,.56197304,.56644619,.57092168,.57539945,.57987941,.58436144,.58884551,.59333149,.59781936,.60230899,.60680034,.61129335,.61578793,.62028405,.62478161,.62928058,.6337809,.63828252,.64278538,.64728943,.65179464,.65630094,.66080831,.66531669,.66982604])},out:{lut:new Float64Array([-.020612427,-.014156041,-.007699656,-.00124327,.005213115,.0116695,.018125886,.024582271,.031038657,.037495042,.043951427,.050407813,.056762235,.062724266,.068686298,.074648329,.080610361,.086572392,.092534424,.098496455,.104458487,.110420518,.117722628,.125979289,.134842844,.144357903,.154572353,.165537602,.177308837,.1899453,.203510588,.211860347,.222265361,.232860935,.243661342,.25468042,.265931684,.277428413,.289183731,.301210667,.313522213,.326131374,.339051208,.352294865,.365875622,.379806912,.394102353,.408775777,.42384125,.439313096,.455205924,.47153464,.488314476,.505561005,.52329016,.541518256,.560262004,.579538537,.59936542,.619760673,.640742792,.662330762,.680356837,.694388877,.708396075,.722380208,.736342926,.750285754,.764210104,.778117286,.792008513,.80588491,.819747522,.833597316,.847435193,.861261986,.87507847,.888885365,.902683339,.916473014,.930254967,.944029734,.957797814,.971559671,.985315736,.99906641,1.012812066,1.026553051,1.040289687,1.054022275,1.067751094,1.081476404,1.095198446,1.108917447,1.122633615,1.136347145,1.15005822,1.163767007,1.177473664,1.191178339,1.204881166,1.218582273,1.232281778,1.245979791,1.259676414,1.273371744,1.287065868,1.300758869,1.314450825,1.328141808,1.341831883,1.355521113,1.369209557,1.382897268,1.396584296,1.410270688,1.423956488,1.437641737,1.451326471,1.465010727,1.478694537,1.492377932,1.50606094,1.519743588,1.5334259,1.547107899,1.560789607,1.574471044])}})),this.gammaSub.push([this.subIdx("DJI"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaACEScc("ACEScc",{})),this.gammaSub.push([this.subIdx("Log")]),this.gts.push("ACES AP0"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaACESProxy("ACESproxy10",10)),this.gammaSub.push([this.subIdx("Log")]),this.gts.push("ACEScg AP1"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaACESProxy("ACESproxy12",12)),this.gammaSub.push([this.subIdx("Log")]),this.gts.push("ACEScg AP1"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("Amira709",new Float64Array([.0629449254,.0638344316,.0652122451,.0671149365,.0696389939,.0727578155,.0765583221,.0810732533,.0863050714,.0923235097,.0991202854,.1071573521,.1173890946,.1289127766,.1418248775,.1563577288,.1727759907,.1909101927,.2109039553,.2321740755,.2540878735,.2767513785,.3000392795,.3239141187,.3482661335,.3730445064,.3981118279,.4233801358,.4484330041,.473344163,.498079979,.5226516916,.5470832745,.5713748957,.5955474508,.6196006037,.6435589843,.6674248274,.6912186286,.7150335873,.7380830785,.7604458639,.7808803039,.798999691,.8151693266,.8293147178,.8419315718,.8532432154,.86328448,.8721146308,.8798286573,.8865081114,.8922250204,.8970825043,.9011319655,.9044962896,.9072088251,.9094085307,.9111140581,.9124771261,.9135050778,.9143603587,.9150416855,.9157172449,.9163807382]))),this.gammaSub.push([this.subIdx("ARRI"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("Alexa-X-2",new Float64Array([.0591392525,.059774105,.0612907229,.0636891061,.0670061726,.0713627697,.0766277967,.0826389777,.089234037,.096285491,.1039625761,.1129939936,.1252220091,.138140148,.1513807635,.1651563807,.1799534361,.196225104,.2139885968,.2330129188,.2532175057,.2745268479,.2973340978,.3215684734,.3464667648,.3712822467,.3957529493,.4204032336,.4450817523,.4696146868,.4938866713,.5180413154,.5420558969,.5658776148,.5894644299,.6129189039,.6361895435,.6591598802,.6817136956,.7042566286,.7267405614,.7484349074,.768610239,.7868717883,.8037179215,.8191567127,.8331581208,.8456621871,.856510339,.8659197184,.8741749179,.8815532343,.8878611055,.8930654735,.8974118356,.9011455804,.9042495877,.9065156533,.9082180048,.9096408106,.910957156,.911862817,.9125228715,.9131824676,.9140666658]))),this.gammaSub.push([this.subIdx("ARRI"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("s709",{rec:{lut:new Float64Array([-.128429281,-.087857693,-.047286105,-.006714517,.033857071,.074428659,.109404416,.142251149,.169103206,.191383375,.211313326,.22941725,.246207651,.261136216,.27457494,.286937936,.298350035,.309228929,.319721904,.329938595,.339920481,.349708889,.35935577,.368893896,.378339425,.387726702,.39709087,.406494373,.415959965,.425504727,.435091864,.444721031,.454388469,.464097425,.473848584,.483636782,.493448049,.503261998,.5130866,.522936843,.532878688,.542918355,.553067402,.56328643,.57360374,.58404873,.594627852,.605423139,.61654015,.6284926,.64151266,.6558432,.671742369,.689757007,.710737854,.736194343,.770900272,.831346604,1.079267818,2.077062181,3.074856545,4.072650908,5.070445272,6.068239635])},out:{lut:new Float64Array([.0504,.05652381,.06269047,.06866184,.07493765,.08147611,.08894732,.09601165,.10345157,.11143212,.12031592,.13072851,.14217459,.1545754,.16823161,.18258277,.19847487,.21647519,.23646249,.25861883,.28225966,.30694373,.33251343,.35871242,.38535787,.41224989,.43899291,.46540198,.49160841,.51763835,.54348663,.5691883,.59485339,.62044621,.64569807,.67053983,.69508328,.71918342,.74276274,.76534268,.78580574,.80409842,.8205254,.83516611,.84814976,.85956961,.86957328,.8781925,.88538127,.89133381,.89630257,.90038219,.9036953,.90632778,.90827715,.90984446,.91135117,.91290709,.91514511,.917036,.91794384,.91884742,.91911605,.91937392])}})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("LC709A",new Float64Array([.0690751760484848,.0728297103786901,.0769850051182796,.0815808343707722,.0864978758256109,.0915715413065494,.096977402514174,.1028781916478983,.1091478390349951,.1155131300480449,.1225782317505376,.1309263253436461,.1403471537869012,.1508689079248778,.1623594253036168,.1746108013986315,.1878784532660801,.2022370183965786,.2180209309622678,.2356278321531769,.2549427384062561,.2761380900003911,.2987492565998045,.3224798721943793,.3469975840860214,.3719286248248777,.3971008726561094,.4222027128650537,.4472788568813294,.4722718767181329,.4971765759100684,.5219774783500978,.546647994976344,.5711842754669599,.5955026274948191,.6197116512439393,.6432306188590422,.6651852019544967,.6865648023053763,.7082626223616812,.729692931713001,.7507956301978983,.7708870295194525,.7891859348525904,.8059247656203324,.8210325331867545,.8346382669036169,.8468258306587488,.8576597322080157,.8672077039163734,.8755439358443793,.8827308391279569,.8888714829059629,.8940610364006844,.8983856104977517,.9019299878681326,.9047933223781036,.9070732102109482,.908859107086608,.9102383165201858,.911314891309482,.9121898344043498,.9129595988637339,.9137217752193059,.9145739540027369]))),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("LC709",new Float64Array([.0681458330432062,.0691434801575758,.0705829599217986,.0724372206445259,.0747874173998045,.0776429161732649,.0811920325388074,.0855419981338221,.0909454307534702,.0976690797726784,.1057777820895406,.1155958029012708,.126611606685435,.138348622650391,.1510262218009775,.1646815963955523,.1793847118819159,.1951918111528836,.2121812541317693,.2304357320288367,.2499984938760508,.2709281624411535,.2932613077270772,.3170617964918866,.3423063612379277,.3695615137341154,.3971217829388074,.423172500107429,.448607770117693,.4736812772283969,.4984996145517106,.5232706256325024,.547944243431476,.5725367356025903,.5970569416109482,.621575167553177,.6459232811886606,.6699759671530302,.693675080914174,.7170080478474583,.7397128428660801,.7617580170455522,.7824392672742913,.8009083916954056,.8175656376203322,.832496424125904,.8457970340590418,.857557027737341,.8678819918256108,.8768748757833822,.8846331515440858,.8912549486405668,.8968412437341152,.9014929560172531,.90530838742913,.9083859090127075,.9108262326490713,.9127307504679862,.9141957927663734,.9153135383675464,.9161978338220919,.9170093433528834,.9176997927663735,.9182731424731183,.9187333528836756]))),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("Sony Cine+709",new Float64Array([.09536,.095478,.095477,.095487,.096065,.098802,.100993,.103192,.105328,.107778,.110405,.113748,.118809,.125443,.134203,.14799,.163574,.182266,.204615,.230647,.259499,.291063,.326191,.363425,.402596,.443342,.484945,.526625,.566841,.604381,.640827,.67481,.707318,.737661,.766663,.792151,.814736,.836382,.85493,.870464,.883507,.895957,.90574,.913164,.920182,.927134,.933985,.940772,.94755,.954329,.961108,.967887,.974666,.981445,.988224,.995003,1.001782,1.008561,1.01534,1.022119,1.028898,1.035677,1.042456,1.049235]))),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("Varicam V709",new Float64Array([.03093963,.03517715,.03975096,.04459771,.0498902,.05557408,.06190443,.06897675,.07677725,.08537468,.09473446,.10541067,.11868528,.13311738,.1487007,.16548566,.1835071,.20262917,.22283545,.24403145,.26617877,.28925105,.31327642,.33809209,.3635757,.3896826,.41631627,.44341889,.47081168,.49848151,.52623353,.55406649,.58169329,.60913806,.63624608,.66303621,.68930935,.71517113,.73981736,.76273104,.78514678,.80792983,.82988348,.85024823,.86926131,.88683223,.90300653,.91783703,.93129966,.94331701,.95391642,.96327691,.97138937,.97818037,.98361305,.98799011,.99133483,.9937684,.9951962,.99614917,.99691692,.9975211,.99811777,.99867865,.9992434]))),this.gammaSub.push([this.subIdx("Panasonic"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSL3("REDGamma",new Float64Array([.122209,.122628,.123047,.123466,.123864,.124153,.124373,.126399,.132256,.139311,.144668,.150222,.157654,.166187,.175914,.18672,.198454,.211823,.226955,.244314,.2638,.284623,.307611,.333972,.363098,.394923,.4287,.464298,.501315,.539313,.576918,.614116,.650874,.685866,.718698,.749114,.777078,.80297,.825409,.842033,.854127,.861731,.867448,.871675,.875699,.879379,.882654,.885762,.888901,.891917,.894805,.897616,.900351,.903046,.905325,.906683,.907624,.908566,.909507,.910449,.91139,.912332,.913273,.914215]))),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("REDGamma2",new Float64Array([.108361,.109008,.109654,.110301,.110914,.111361,.113363,.117263,.12595,.13667,.145798,.155437,.166925,.17921,.192282,.206362,.221594,.237788,.2549,.272774,.291467,.311447,.332405,.353942,.37623,.399321,.423152,.447735,.473302,.499739,.526754,.554079,.581395,.608528,.635397,.661888,.687921,.713102,.737264,.760012,.781281,.800987,.818704,.834386,.848327,.860566,.871203,.880394,.888265,.894957,.90053,.904801,.907617,.908281,.908509,.908737,.908965,.909193,.909421,.909649,.909877,.910105,.910333,.910561]))),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("REDGamma3",new Float64Array([-.03714517,-.00423269,.0286798,.06159228,.08210614,.08742128,.09352044,.10024791,.10760079,.11612612,.12508897,.13477347,.14708845,.16039003,.17473353,.19047034,.20764301,.22600144,.24574689,.26695764,.28923082,.31230737,.33598015,.36085173,.3858281,.41159915,.43762202,.46412136,.49040391,.51679063,.54330912,.56927544,.59476868,.61927984,.64375537,.66689702,.68910742,.71075087,.73073736,.74993632,.76768928,.78399945,.79911844,.81328213,.82578649,.8370763,.84742981,.85645727,.86438563,.87143002,.87786935,.88346431,.88841647,.89282182,.89677137,.9002692,.90328175,.90617316,.90922153,.91226993,.91531834,.91836678,.92141523,.92446369,.92751216]))),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSL3("REDGamma4",new Float64Array([.053893,.056375,.058856,.061338,.063694,.066402,.071655,.078517,.086253,.094471,.102953,.112794,.125421,.139898,.156136,.174021,.193439,.214284,.236454,.259851,.284385,.309967,.336515,.363952,.392203,.421199,.450864,.481018,.511437,.541908,.572226,.602196,.63163,.660345,.688159,.714896,.740381,.764439,.786892,.807565,.826276,.842863,.857382,.870007,.880892,.890167,.897948,.904337,.909429,.913312,.916075,.917816,.918669,.918866,.918866,.918866,.918866,.918866,.918866,.918866,.918866,.918866,.918866,.918866]))),this.gammaSub.push([this.subIdx("RED"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Rec709 (800%)",{rec:{lut:new Float64Array([-.0446421313,-.0204893067,.003663518,.0278163427,.0519691674,.0761219921,.1002707756,.1244698215,.1486224622,.1716290677,.1906642455,.2085204718,.2254012975,.2413982532,.2565166388,.2708530435,.2844393079,.2973183908,.309685462,.3215533433,.3328146131,.3436401143,.3540168103,.3639875695,.3735997301,.3828629905,.3917793547,.4004128911,.4088059207,.4169027148,.424714713,.4322985725,.4396753339,.4468468853,.4538127938,.4605775118,.4671640916,.4735878362,.479854576,.4860006009,.4920048747,.4977093585,.5038431061,.5116567043,.5181791292,.5247650308,.5315938853,.5385493314,.5456541485,.5530263072,.5606487371,.568600224,.5768926044,.585558601,.594826985,.6046748461,.6152549633,.626913847,.6396734938,.6541629455,.6710471506,.6915209719,.7181498682,.7574674791,.8445913579])},out:{lut:new Float64Array([.0289066996,.0390080746,.0491133029,.0592146779,.0693160529,.0794212813,.0895274289,.0996411169,.1097173681,.1197901614,.1300004174,.1408247747,.153593898,.1670471322,.1812353271,.1961807539,.211889775,.2285885784,.2462546509,.2650729108,.2848894628,.3059138202,.3282876301,.3520647492,.3773249255,.4041951748,.4326924843,.4630104118,.4953512291,.5296917198,.5663211163,.6052213632,.6468385483,.6811695613,.7179664821,.7526207094,.7849335846,.8147522501,.8419881738,.86649541,.8881412487,.9073422173,.923960799,.9381992542,.9503103153,.9605564777,.9690464375,.976216775,.9819309464,.9867203043,.9904006942,.993450019,.9956787345,.9979577502,.9998967591,1.0018141003,1.0037311922,1.0056480668,1.0075647537,1.009481276,1.0113976563,1.0133139134,1.0152300629,1.0171461197,1.0190620951])}})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("EOS Standard",{clip:3.7455,loggy:.01197,lut:new Float64Array([.062561095,.074860431,.092233233,.113525362,.148197424,.190542723,.248921196,.320439745,.417441612,.518356119,.637094759,.739691491,.833001228,.904285437,.955849432,.986588392,.997301612])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("EOS Standard (Legal)",{clip:3.7455,loggy:.01197,lut:new Float64Array([.062561095,.073828375,.089743398,.109248871,.141011547,.179803585,.23328343,.298800746,.387663035,.480109649,.588884745,.682872425,.768352397,.833655037,.880892217,.909051823,.91886608])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Canon Normal 1",{clip:4.9166,loggy:.002377,lut:new Float64Array([.082111437,.090584133,.102121123,.117689768,.140853869,.179297916,.229246771,.288545875,.355002175,.443743628,.567289457,.709945913,.855432239,.912823502,.973847336,1.053094692,1.344984113])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Canon Normal 2",{clip:3.6795,loggy:.010815,lut:new Float64Array([.082111437,.097513279,.113845203,.134727251,.167041692,.204979095,.252646999,.299167176,.354210924,.42337854,.51044802,.608850484,.724959368,.850680674,.89267391,.933266716,.982099746])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Canon Normal 3",{clip:3.675,loggy:.011418,lut:new Float64Array([.082111437,.09988293,.119699608,.143422866,.178649187,.214574932,.258160103,.305496005,.366356945,.432842236,.517627699,.615737774,.729766182,.852693579,.891819699,.933451248,.982740453])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Canon Normal 4",{clip:3.70456,loggy:.0093,lut:new Float64Array([.082111437,.098467583,.117300597,.140493024,.176093124,.219716004,.271868112,.32123868,.36749718,.427104487,.506362752,.603335607,.716870955,.848059317,.893373102,.934937886,.983834278])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaNLog("Nikon N-Log")),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Log")]),this.gts.push("Rec2020"),this.gammaDat.push(!0),this.gammaExt.push(!0),this.gammas.push(new LUTGammaIOLUT("Nikon Standard",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090182450305,.114844812055,.147037855967,.170190534243,.182505160319,.195266314669,.20385378499,.211095737876,.21922179278,.227999341155,.236282183331,.243254666213,.249799997985,.256337363135,.262712725704,.268527439248,.273815628826,.278801564019,.283644789095,.288392421002,.293133710416,.297755513447,.302175617216,.306502426672,.310752741262,.314959622924,.319114515832,.32316522984,.327112045597,.330908933709,.334586176331,.33817514842,.34168083381,.34513942645,.348544714039,.351947325653,.355371475627,.358794773339,.362214961661,.365622412467,.368960430415,.372229078201,.375549771636,.378978477443,.382437665513,.385876364569,.389311177226,.392717070632,.396099211847,.399596228751,.403257717617,.406948529183,.410631822241,.414307485422,.417949748127,.421597747322,.425300362807,.429011956465,.432665489009,.43629317957,.439950131174,.443618495668,.447217356045,.450752752428,.454308147167,.457896600163,.461486503027,.465077971802,.4686496255,.472179139518,.475681843863,.479172398173,.482643830686,.4860717159,.489456560345,.492829660552,.496199806504,.499557029186,.502883973225,.506202425833,.509583182445,.513027270364,.516439758293,.51979522907,.52313938737,.526486431936,.529841782722,.53323940665,.536673918577,.540201395758,.543843468628,.547563839344,.551365664452,.55521185863,.55906520697,.562987330755,.567008663481,.571141048171,.575388384633,.579852755032,.584596219521,.589656886066,.595013785817,.600608182746,.606593136633,.612862738119,.619558115806,.627134629835,.635771882841,.646090898198,.702378530367,.761472498521,.820637751415,.879845357987,.939077825206,.99832488086,1.057576659021,1.116828424985,1.17608019095,1.235331956914,1.294583722879])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063440922871,.065939828995,.068461377294,.071083719271,.073457071312,.075178362835,.076926716563,.078377767373,.079774496126,.082090196935,.087053858463,.091985226944,.096851206605,.101597266466,.108640869604,.117026469673,.124564288309,.131532001666,.138653050872,.147207407755,.156488919267,.16585936246,.175652722265,.186927260407,.199243267088,.212044116616,.225041844751,.238895615805,.253240133306,.267917983908,.283304261071,.299792645427,.317160501155,.335057795993,.352889810206,.370819575819,.389352213885,.407101174185,.424871237485,.442772100713,.459451481748,.476039712868,.492777153962,.509246934718,.526027527985,.54271292858,.559913284646,.576928975938,.593971033204,.611344689037,.628930013031,.646950916067,.665096433879,.683435767729,.70124317315,.719444395779,.737622227049,.755320491138,.772001056736,.787997434894,.803729034995,.818764033383,.832972783544,.845877373044,.857555748351,.868473696665,.878489111063,.887958347868,.896363952038,.903591827347,.910315723114,.915372062462,.918298748293,.918941618409,.918972202977,.919075471565,.91987971719,.92093980219,.921973664508,.923007251183,.924040581079,.925073671761,.926106539583,.927139199777,.928171666527,.929203953044,.930236071632,.931268033751,.932299850078,.933331530557,.934363084451,.93539452039,.936425846414,.937457070013,.938488198167,.939519237376,.940550193699,.941581072781,.94261187988,.943642619897,.944673297399,.94570391664,.946734481587,.947764995932,.94879546312,.949825886359,.950856268638,.951886612744,.952916921275,.953947196648,.95497744112,.956007656792,.957037845623,.958068009437,.959098149936,.960128268706,.961158367223])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Nikon Neutral",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090370277129,.111261816878,.130837070772,.154724281799,.167748578657,.175153042048,.18381360054,.193613893606,.201845384547,.208862712809,.216240385882,.223891266282,.231266341219,.238137235412,.244526657912,.250600574579,.256676156574,.262573904298,.268179682113,.273510523045,.278725079401,.283798074261,.288755859858,.293711495514,.298540024556,.303202660636,.307723722115,.312136686485,.316510929668,.320823103675,.325061599754,.329250845847,.333404903584,.337481786689,.341478003981,.345410076747,.349276802698,.353155050352,.35705517483,.360924326908,.36476190962,.368534160768,.372219561935,.375965970561,.379837133354,.383697823226,.387509788827,.391294383841,.395027283063,.398805761668,.402714808096,.406648722824,.410557207556,.414440514338,.418281270173,.422101311085,.425921487535,.429708258188,.433414855526,.43711358826,.440894188305,.444702269231,.448484157653,.452247923518,.45597962653,.459680464278,.463339649468,.466960507431,.470544248238,.474091256304,.477614456193,.481114289829,.484597025237,.488049600937,.491511604916,.495056838882,.498638495167,.502143788814,.505593447821,.509025317989,.512445400947,.515831817485,.51916966914,.52248136165,.525786987556,.529082557203,.532387937393,.535693607451,.539042131765,.542445907579,.545931580767,.549599723684,.55341783978,.557224827183,.561055098051,.564975986003,.568990380621,.573121964995,.577399927778,.581947100667,.586726717568,.591716948652,.596740236407,.601900927218,.60755293127,.614097227575,.621247444919,.628629296746,.636894410971,.647118201427,.701473594388,.7591174528,.81682793373,.874580070648,.932356983196,.990148625585,1.047946225923,1.105743851253,1.163541476583,1.221339101914,1.279136727244])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063424532172,.066451860312,.069540979037,.072767011953,.075906919979,.078853518191,.081631137728,.08411516114,.086479804114,.090146659344,.098326897931,.105813214308,.112411325511,.118632105327,.126340654717,.135121024858,.143188481435,.151214506061,.159704595685,.168946154075,.178917743693,.188988933153,.199496185802,.210829472801,.222607262009,.234859080761,.247268132837,.260349232373,.274083476359,.28813011277,.302582467828,.317331828344,.332620806037,.348365834915,.364049610993,.379997823816,.396454197491,.412256458371,.428299584401,.444563625444,.460140581966,.475797913493,.491724507182,.507769291577,.524243967159,.540321153567,.556518544281,.572986274856,.589827764317,.607037655073,.624500979893,.642132788801,.659260502589,.676925684511,.694832172329,.713193903044,.731687117698,.750046927552,.767681303891,.783847467497,.799775652757,.815021702518,.82940656557,.842479215886,.854706468324,.866698387523,.877330903455,.886205655894,.894607432632,.902626621574,.909273722489,.914867761327,.918285650651,.91894022057,.918992912762,.91912230606,.919952578245,.921038681814,.922098555256,.92315814612,.924217473745,.925276556137,.926335410063,.927394051136,.928452493899,.929510751894,.930568837735,.931626763171,.932684539147,.933742175856,.934799682795,.935857068813,.93691434215,.937971510485,.939028580973,.94008556028,.941142454614,.942199269764,.94325601112,.944312683707,.945369292206,.946425840978,.947482334089,.948538775326,.949595168219,.950651516058,.951707821906,.952764088621,.953820318865,.954876515118,.955932679692,.956988814742,.958044922274,.959101004161,.960157062147,.961213097856,.962269112803])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Nikon Vivid",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090022266287,.1249836181,.174358067479,.200885292861,.210394128231,.219679538515,.229782588225,.237527072241,.243640168554,.250127754776,.257349865517,.264748252859,.270564224518,.275807100363,.280794974454,.285678082679,.290496609151,.295301613189,.299695171061,.303797972903,.307751983351,.311586237919,.315404817492,.319170201075,.322828977424,.326392115832,.329816995605,.333116458736,.336347797973,.339521970675,.342645003881,.345727309828,.348765618565,.351808171675,.354882352416,.357954246165,.360988936855,.363995548567,.366968530013,.369872023109,.372746601324,.375718615365,.37883575789,.382015542918,.385197001913,.388398496231,.391560845343,.394665368289,.397769976495,.400928640905,.404115357104,.407272557992,.410397071901,.413502895037,.416589818624,.419660824008,.422740719992,.425840284669,.428929810665,.431975923618,.434993999602,.438037471593,.441136068781,.444236363145,.447275819442,.450270537122,.453286432626,.456347163141,.459436026617,.462554221976,.465705641406,.468868557494,.472022133151,.475193176007,.478429604773,.481730408691,.485010213005,.488233925164,.49146355624,.494758069364,.498091267968,.501401033442,.504676474735,.507998529829,.511426279031,.514894259405,.518319250205,.521742852369,.525265607959,.528889614943,.532532949141,.536178537282,.53989316695,.543690024018,.547605615691,.551688497347,.555854084117,.560050009191,.564521264881,.5693479558,.574322784361,.579510092645,.584961457677,.590754171202,.597105965002,.604106477697,.611752014152,.62058904128,.630734397016,.641901685999,.704513814536,.767045464082,.829654095144,.892306570909,.954983997519,1.017675103286,1.080368518869,1.143061934456,1.205755350042,1.268448765629,1.331142181216])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063422106433,.06516690209,.066857240455,.068727634913,.070315430976,.071522246881,.072621736604,.07363234562,.074546172578,.075767169852,.077558928054,.079330994587,.081062569715,.082816923899,.087517230265,.09421766009,.100822872848,.106844083563,.1134664882,.123209893266,.132666302326,.141121837628,.14949248079,.160487736691,.172594382415,.18518408479,.198017570112,.212665734218,.228431904394,.244606313346,.261721930295,.280252238739,.299659730327,.319685136453,.3395831715,.359954596243,.380963884464,.400400861762,.419544431276,.439164017255,.458393958826,.477973742903,.497810160738,.517555133739,.53769388748,.557430697093,.577710884416,.597523047859,.616894400479,.636145035402,.654723587302,.673606897408,.691989257762,.71050663024,.728218016286,.745983563913,.762868835952,.779520832114,.795442039283,.810311738796,.824686064119,.837470043276,.849512612712,.860724908386,.870992043119,.88002824133,.888298577234,.895604283736,.901898605243,.907772519766,.913241598575,.917684640033,.918890180731,.918814825701,.918933210545,.918973452193,.919720908703,.920724222029,.921701328915,.922678175291,.923654778984,.924631156594,.92560732358,.926583294335,.927559082266,.928534699858,.929510158739,.930485469742,.931460642955,.932435687778,.933410612965,.934385426672,.935360136499,.936334749524,.937309272342,.938283711099,.93925807152,.940232358939,.941206578328,.942180734318,.943154831224,.944128873068,.945102863597,.946076806303,.94705070444,.948024561041,.948998378932,.949972160744,.950945908934,.951919625787,.952893313435,.953866973864,.954840608925,.955814220343,.956787809726,.957761378572,.958734928277])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Nikon Monochrome",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090129558931,.118513428992,.161557439104,.183585697405,.200093975652,.208057578622,.215970131333,.225002608116,.233879495392,.240662071274,.247338185443,.254230227189,.261105306305,.267394020451,.272873708978,.278074662081,.283101734765,.288019832776,.292944821742,.297672426491,.302032614613,.306221352992,.310269266663,.314275256213,.318250784779,.32211960787,.325888885467,.329541475946,.333079047674,.336554832203,.339984067915,.343360976958,.34669310879,.349974270211,.353182034904,.356320329348,.359418720617,.362492160458,.36552995441,.368516385984,.371436781625,.374369295393,.377384246411,.380449869114,.383514484285,.386579658573,.389634808054,.392647838871,.395627110133,.39863888387,.401722968051,.404834439823,.407921483765,.410994007883,.414057208753,.417103783757,.42014560295,.423212741133,.426311460699,.429399300683,.43244261251,.435466396352,.438510650641,.441585590904,.444654826762,.44767882687,.450678493363,.453724102095,.456831012284,.459983753466,.463189922895,.466448049052,.469692451023,.472914434645,.476132751775,.479351891463,.482571917094,.485795265077,.489003126931,.492300997063,.49580568352,.499380185386,.502849518582,.506282440542,.509735949913,.513204774156,.51664172317,.520030088579,.523424396172,.526834100575,.530287729731,.533858145421,.537543411008,.541400840406,.545443580335,.549638874781,.553990299209,.558400834273,.562991914893,.567987937632,.572992749012,.578023423534,.583389324988,.58944954773,.596237282899,.603370029808,.610812834357,.618810651619,.628449397199,.641209364072,.656079610743,.670851711888,.685633413195,.700423865429,.715221980601,.73002680607,.744837506804,.759653351062,.774473698233,.789297986894,.804125719542])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063411298637,.065473225005,.067709381852,.069944812343,.071995254172,.073304162528,.074720219671,.076007169791,.077253960239,.078699062445,.081546572735,.084481566293,.087397030027,.090312742629,.096416171392,.104602992261,.111880792294,.118525378827,.125502768452,.134622916852,.143692343699,.152481137891,.16171145381,.172700686416,.184604076215,.196978236277,.209564548601,.223672279297,.238726919005,.254134628935,.270374429331,.287668992396,.305595138142,.324155748053,.34363938293,.363686479761,.384465305893,.404456370194,.424425227873,.444796339648,.464510678743,.48438851384,.504418236358,.524172308005,.544292886223,.564185830752,.584416939007,.603905098281,.622720493201,.641667395658,.66061350707,.679425795473,.696693040387,.714409322616,.732049896563,.750029943547,.767754182324,.784375558828,.799577226262,.813738486503,.827318392881,.839525636331,.851714184079,.862831025734,.872171976419,.88085896193,.88914180385,.896959604445,.903627190101,.909264232179,.913744505556,.917827820241,.921965195577,.926097506034,.930228497746,.93435802827,.938486197832,.942613099722,.946738820786,.950863441875,.954987038264,.959109680045,.963231432487,.967352356368,.971472508295,.975591940984,.979710703538,.98382884169,.987946398044,.992063412282,.996179921373,1.000295959754,1.00441155951,1.008526750532,1.012641560668,1.016756015863,1.020870140294,1.024983956485,1.029097485424,1.033210746667,1.037323758437,1.041436537713,1.045549100319,1.049661460998,1.05377363349,1.057885630599,1.061997464257,1.066109145582,1.070220684937,1.074332091976,1.078443375701,1.082554544497,1.086665606179,1.090776568032,1.094887436845,1.098998218942,1.10310892022])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Nikon Portrait",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090377297204,.11122644271,.13063356755,.154389555468,.167484430608,.174839594233,.183469996634,.193294111001,.20159014787,.208632209126,.21598740556,.223629338832,.231017469096,.237919995757,.244328495635,.250389900549,.256464961207,.262363127247,.26798633589,.273335963136,.278548689567,.283619640858,.288574227782,.293525082167,.298362229115,.303041988045,.307568668181,.311976904229,.316346477308,.320656949316,.324898573361,.329092080323,.333253752423,.337335390357,.34132955089,.345261031804,.349127299667,.353006646136,.356915623834,.360789759371,.364625604109,.368397738648,.372080006233,.375820505631,.379695767711,.383563170183,.387373448545,.391156890498,.39489114985,.398666495274,.402574220925,.406510206401,.41041485602,.4142960563,.418138859891,.421960984406,.425782809615,.429572667473,.433281562063,.436977734201,.440756156341,.444565180033,.448345285966,.452106942345,.455840644695,.459545962435,.463207496528,.466829072947,.470414623672,.47396422399,.477488781828,.480988569456,.484470908978,.487924337343,.491384406479,.494925495146,.498507119369,.502014399827,.505463972776,.50889533148,.512316255254,.515704743895,.519044770981,.522357771953,.525665262942,.528962750745,.532271028161,.535581223979,.538931946024,.542336228199,.545819335767,.549487438103,.553313651701,.557125889811,.560955468698,.564878349439,.568897239861,.573033256488,.577313495907,.581857451013,.586635041242,.59162792673,.596657408025,.601816456841,.607467824225,.614007423583,.621166374566,.628556362922,.63681164419,.647065080028,.699367091432,.753605174839,.807897396769,.862229480648,.916586008425,.970957527998,1.025337298823,1.079717878082,1.134098457344,1.188479036605,1.242859615866])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063423136263,.066462881746,.069554089606,.072792511194,.075979139105,.078932975596,.081758133236,.084242338721,.086596467332,.090414496703,.098632787117,.10610544801,.112691707091,.118886717045,.126607307194,.135381970506,.143446256435,.151488012869,.159970471694,.169194405121,.179186968869,.189265265898,.199781372605,.211087600159,.222882010816,.235146602782,.247564852184,.260618796978,.274368775975,.288433493799,.302881118328,.317614474157,.332918076574,.348667044053,.364322697224,.380282324822,.396752589681,.412531634149,.428585041949,.44484660668,.460417216218,.476090075277,.492011628887,.508051391505,.524528209215,.540603806442,.556812950525,.573270231981,.590112805234,.607317141768,.624784484757,.642417689555,.65955011155,.677221493533,.69512738654,.713484669929,.731966315749,.750300629233,.767925373457,.784054829694,.799974605754,.815195868133,.829558770206,.842627040471,.854840162809,.866820716862,.877438793785,.886299046904,.894688794916,.902697672504,.909338504065,.914892130237,.918231731742,.918915083032,.919043476065,.919239149469,.920136059151,.921288779755,.92241525117,.923541422251,.924667313553,.925792944212,.926918332049,.928043493659,.929168444498,.930293198958,.931417770448,.932542171453,.933666413606,.934790507742,.935914463954,.937038291645,.938161999576,.939285595908,.940409088244,.941532483668,.942655788782,.943779009735,.944902152257,.946025221689,.947148223006,.948271160844,.949394039523,.950516863068,.951639635232,.952762359509,.953885039159,.955007677216,.95613027651,.957252839678,.958375369175,.959497867293,.960620336166,.961742777781,.962865193993,.963987586528,.965109956997])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaIOLUT("Nikon Landscape",{rec:{lut:new Float64Array([-.342551352061,-.288177568708,-.233803785356,-.179430002004,-.125056218652,-.0706824353,-.016308651953,.03806513138,.090014281627,.125262756783,.175394871323,.201468245826,.210914156758,.220255090663,.230320004433,.237899490783,.244037210321,.250534903571,.257758397707,.265125636355,.270861063964,.276088839523,.281077811268,.285962815933,.290792094924,.295589187329,.299952875638,.304038876382,.307985999261,.311823369684,.3156475821,.319412786133,.323068235362,.326624111035,.330039441071,.333332259731,.336562154474,.339737539911,.342863954371,.345947530923,.348988934054,.352034941511,.355105612192,.358169762222,.361200953136,.36420798069,.367181171002,.370081303694,.37296136474,.375946473112,.379070635127,.38225083699,.385437951772,.388644687165,.391806775547,.394912899124,.398023732258,.401189225678,.40437738765,.40753399491,.41066118647,.413769752051,.416856569741,.419928375398,.423011688238,.426113673928,.429202840995,.432247581554,.435269097809,.438320205573,.441423089653,.444521471455,.44755780023,.450556342802,.45358149922,.45664803279,.459742607442,.462868813548,.466028335421,.469195953395,.472352862884,.475531499554,.47878056493,.48208713515,.485363351397,.48858691894,.491824446382,.495130114255,.498468340983,.501777107483,.50505840001,.508397188549,.511840110704,.515312142846,.51873849996,.522176040842,.525720612003,.529356285838,.532997521466,.536642367114,.540365200664,.544175285378,.548107328251,.552192349558,.556349227616,.560560482382,.565069214291,.569899347725,.574871037285,.580070468084,.585551663364,.591351930507,.597726675336,.604734853205,.612436678142,.62131659305,.631412155268,.642407361803,.705185166051,.768799223484,.832491771003,.896228587957,.959990352659,1.023765329935,1.087542056186,1.15131878244,1.215095508694,1.278872234948,1.342648961202])},out:{lut:new Float64Array([.049218249549,.050340760298,.051463271048,.052585781797,.053708292546,.054830803295,.055953314045,.057075824794,.058198335543,.059320846293,.060443357042,.061565867791,.063424602387,.065158719093,.066844337216,.06868420862,.070266797005,.071428317343,.072543802315,.073565478875,.074487180884,.075615127884,.077358107033,.079057203638,.080785142809,.082568609461,.087086590075,.093769852277,.100367927146,.106434856177,.113007625398,.122717469882,.132201743401,.140683305794,.14904599169,.160057857913,.172146745702,.184714602362,.197531016229,.212198748641,.227944458602,.24409291895,.26120282382,.279731408185,.299105025428,.319106165979,.33903479448,.359391749047,.380382823923,.399821157211,.418933430124,.438529485049,.457746216431,.477300192906,.497127504497,.516859464506,.536977578582,.556704529271,.576955897034,.59674764473,.6160860304,.63531604097,.653874499813,.672741331452,.691099597289,.70958844164,.727270882484,.745001904949,.761868035665,.778540245167,.794460294454,.809377586481,.823762555425,.83659649961,.84868629891,.859908326372,.87023896726,.879342623248,.887630917192,.894981327227,.901356587391,.907285193365,.912856265123,.917595172338,.918922145184,.918818251367,.918920088871,.918943684746,.919674534281,.92066124573,.921621755491,.922582009166,.923542024281,.924501817154,.925461402979,.926420795907,.927380009116,.928339054879,.929297944628,.93025668901,.931215297944,.932173780667,.933132145787,.934090401321,.935048554738,.936006612998,.936964582584,.937922469536,.938880279483,.939838017669,.940795688979,.941753297967,.942710848875,.943668345656,.944625791994,.945583191322,.946540546837,.947497861522,.948455138154,.949412379321,.950369587435,.951326764746,.952283913348,.953241035193,.954198132101,.955155205767,.956112257773,.957069289591,.958026302593])}})),this.gammaSub.push([this.subIdx("Nikon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.pqOOTF=new LUTGammaOOTFPQ("Display PQ OOTF (nits)",{Lw:1e4,scale:"nits"}),this.hlgOOTF=new LUTGammaOOTFHLG("Display HLG OOTF (nits)",{Lw:1e3,Lb:0,scale:"nits"}),this.pqNoOOTF=new LUTGammaOOTFNone("Scene Linear (nits)",{Lw:1e4}),this.pqOOTFNorm=new LUTGammaOOTFPQ("Display PQ OOTF (Normalised)",{Lw:1e4,scale:"normalised"}),this.hlgOOTFNorm=new LUTGammaOOTFHLG("Display HLG OOTF (Normalised)",{Lw:1e3,Lb:0,scale:"normalised"}),this.PQ=this.gammas.length,this.gammas.push(new LUTGammaPQ("Rec2100 PQ (PQ OOTF)",this.pqOOTF)),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaPQ("Rec2100 PQ (HLG OOTF)",this.hlgOOTF)),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.HLG=this.gammas.length,this.gammas.push(new LUTGammaHLG("Rec2100 HLG",{a:.17883277,b:.28466892,c:.55991073})),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.pqEOTFIdx=this.gammas.length,this.gammas.push(new LUTGammaPQ("PQ (EOTF Only)",this.pqNoOOTF)),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("HG3250G36 (HG1)",{clip:4.607,loggy:.00896,lut:new Float64Array([.08797654,.10544838,.130894073,.167872574,.194834348,.226358779,.266268941,.31582866,.377990009,.453504879,.541509091,.636928684,.731022684,.813771264,.877502171,.919831827,.936196343])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("HG4600G30 (HG2)",{clip:5.471,loggy:.00491,lut:new Float64Array([.08797654,.104192531,.126464534,.15295782,.176615948,.205826206,.243989699,.292906636,.356424356,.436709059,.533166639,.639815303,.74453493,.833365445,.8969974,.934175897,.946701781])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("HG3259G40 (HG3)",{clip:5.424,loggy:.00527,lut:new Float64Array([.08797654,.106966953,.136197387,.179217692,.211658973,.251242869,.302925063,.368355366,.451618812,.552562868,.666187509,.780975438,.881914932,.95753893,1.005027748,1.027378519,1.032819393])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("HG4609G33 (HG4)",{clip:4.987,loggy:.0129,lut:new Float64Array([.08797654,.116808731,.151974786,.180100256,.210030322,.24682835,.291407476,.346545743,.414273303,.495344317,.588468737,.688544076,.787019889,.874636069,.942887027,.991399694,1.011271456])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("HG8000G36 (HG5)",{clip:5.8,loggy:.033475,lut:new Float64Array([.086897445,.174053304,.226750469,.282647061,.346604743,.419397456,.499103345,.58154343,.661222354,.732765443,.792295168,.838670413,.872336124,.895357636,.910092389,.919082976,.922720436])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("HG8000G30 (HG6)",{clip:6.3,loggy:.0184378,lut:new Float64Array([.086897445,.158925131,.199263137,.241244264,.290010228,.348221239,.417126792,.496076175,.581700745,.667766242,.746717346,.812590251,.86214621,.895831084,.91668667,.927087485,.930959367])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("HG8009G40 (HG7)",{clip:6.324,loggy:.0072,lut:new Float64Array([.08797654,.128135647,.186195571,.226012647,.274212921,.335341074,.412483511,.505912502,.61090837,.717257525,.81246933,.887758829,.940377098,.973389141,.991844955,1.001278468,1.004289649])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("HG8009G33 (HG8)",{clip:5.568,loggy:.0114,lut:new Float64Array([.08797654,.122144207,.163936124,.193789797,.228638656,.271257909,.324762115,.391105031,.471722516,.564565892,.663932304,.76057611,.844909521,.911004616,.956498789,.986149734,.997564399])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("Cinegamma1",{clip:4.987,loggy:.0129,lut:new Float64Array([.08797654,.116808731,.151974786,.180100256,.210030322,.24682835,.291407476,.346545743,.414273303,.495344317,.588468737,.688544076,.787019889,.874636069,.942887027,.991399694,1.011271456])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("Cinegamma2",{clip:5.471,loggy:.00491,lut:new Float64Array([.08797654,.104192531,.126464534,.15295782,.176615948,.205826206,.243989699,.292906636,.356424356,.436709059,.533166639,.639815303,.74453493,.833365445,.8969974,.934175897,.946701781])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Cinegamma3",{clip:4.1,loggy:.01,lut:new Float64Array([.078131789,.09920475,.122162118,.151981053,.181906428,.220375167,.267387627,.325563795,.394207316,.484397908,.591913512,.681441253,.753396056,.817388645,.879105528,.936594209,.994314701])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("Cinegamma4",{clip:4.5,loggy:.01,lut:new Float64Array([.077769272,.095397854,.120450392,.156824535,.196163068,.242764534,.297417162,.357887286,.430140946,.515413669,.618592194,.705057939,.771271414,.832072263,.885754684,.936822309,.987590161])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.gammas.push(new LUTGammaLUTSimple("Sony STD1",{clip:4,loggy:.017629,lut:new Float64Array([.08797654,.102779743,.123103793,.15204128,.192300409,.24825427,.324632702,.399870573,.47660843,.556285815,.644181507,.735266384,.810806802,.866443347,.90467502,.941259156,.988794595])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Sony STD2 - x4.5",{clip:4,loggy:.008254,lut:new Float64Array([.08797654,.098622061,.114272152,.137276217,.171038737,.220119176,.274837007,.33335793,.399208497,.472934824,.558776425,.660553828,.764298918,.842427286,.893359663,.933816378,.985740801])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Sony STD3 - x3.5",{clip:4,loggy:.020241,lut:new Float64Array([.08797654,.10445177,.126912437,.158425349,.201870238,.255736464,.311556741,.372989109,.44362902,.523307566,.615503441,.718323954,.802280114,.862208212,.90256618,.937483433,.982351386])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Sony STD4 - SMPTE240M",{clip:4,loggy:.019905,lut:new Float64Array([.08797654,.109381233,.138901447,.176210165,.216932275,.263165877,.315600146,.375268835,.445421661,.524947756,.617187794,.719160107,.802696756,.862488014,.902446754,.93785016,.983542491])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Sony STD5 - Rec709",{clip:4,loggy:.0203,lut:new Float64Array([.08797654,.112246952,.145387857,.183126966,.224110408,.270392689,.323005008,.382133984,.451705404,.530572659,.621946987,.722476974,.804668815,.863536358,.903322935,.938810956,.984511672])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Sony STD6 - x5",{clip:4,loggy:.019855,lut:new Float64Array([.08797654,.115025696,.15175495,.201870505,.251515315,.301256018,.354820624,.413032596,.480142153,.554913856,.640879024,.733933755,.810921922,.866540067,.904779871,.940303144,.98630421])})),this.gammaSub.push([this.subIdx("Sony"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLUTSimple("Canon WideDR",{clip:6,loggy:.003936,lut:new Float64Array([.062561095,.083588769,.114009387,.15660632,.208062502,.270138527,.344705558,.433179626,.533196849,.625617722,.710704057,.787648239,.854327941,.909579605,.954325784,.993866446,1.028803])})),this.gammaSub.push([this.subIdx("Canon"),this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!0),this.rec709=this.gammas.length,this.gammas.push(new LUTGammaGam("Rec709",[1/.45,4.5,.099,.018,.081,1.9])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("Rec2020 12-bit",[1/.45,4.5,.0993,.0181,.08145,1.9])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("sRGB",[2.4,12.92,.055,.0031308,.04015966,2.2])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("sRGB"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("DCI",[2.6,1,0,1e-7,1e-7,2.6])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLin("Scene Linear IRE",.2)),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaLin("Scene Reflectance",.18)),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("CIE L*",[3,24389/2700,.16,216/24389,.08,2.45])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("sRGB"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaBBCGam("BBC 0.4",[.4,5,-.02262,.037703,Math.pow(.015083/.97738,.4),!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaBBCGam("BBC 0.5",[.5,5,-.01011,.020202,Math.pow(.010195072179737145,.5),!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaBBCGam("BBC 0.6",[.6,5,-.00334,.008857,Math.pow(.005517/.99666,.6),!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("Rec709"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("ProPhoto / ROMM",[1.8,16,0,Math.pow(16,-2.25),Math.pow(Math.pow(16,-2.25),1/1.8),1.8])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("ProPhoto RGB"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ1.5",[1.5,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ1.6",[1.6,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ1.7",[1.7,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ1.8",[1.8,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ1.9",[1.9,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.0",[2,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.1",[2.1,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.2",[2.2,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.3",[2.3,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.4",[2.4,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.5",[2.5,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaGam("γ2.6",[2.6,1,0,1e-7,1e-7,!1])),this.gammaSub.push([this.subIdx("Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.pqOOTFIdx=this.gammas.length,this.gammas.push(this.pqOOTF),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(this.pqOOTFNorm),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.hlgOOTFIdx=this.gammas.length,this.gammas.push(this.hlgOOTF),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(this.hlgOOTFNorm),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("Rec2020"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaITUProp("ITU Proposal (400%)",{m:.12314858})),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaITUProp("ITU Proposal (800%)",{m:.083822216783})),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaBBC283("BBC WHP283 (400%)",{m:.139401137752})),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaBBC283("BBC WHP283 (800%)",{m:.097401889128})),this.gammaSub.push([this.subIdx("HDR Display")]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.LA=this.gammas.length,this.gammas.push(new LUTGammaLA("LA",this.lutMaker)),this.gammaSub.push([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),this.gts.push("*"),this.gammaDat.push(!1),this.gammaExt.push(!1),this.gammas.push(new LUTGammaNull("Null")),this.gammaSub.push([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),this.gts.push("*"),this.gammaDat.push(!0),this.gammaExt.push(!1);for(var t=this.gammas.length,i=[],a=[],s=[],h=[],o=[],r=0;r<t;r++)switch(r===this.LA&&(this.inList.push({name:"Linear / γ",idx:9999}),this.outList.push({name:"Linear / γ",idx:9999})),this.catList[r]=this.gammas[r].cat,this.gammas[r].cat){case 0:i.push({name:this.gammas[r].name,idx:r}),this.inList.push({name:this.gammas[r].name,idx:r}),this.outList.push({name:this.gammas[r].name,idx:r});break;case 1:""!==this.gammas[r].gamma?this.linList.push({name:this.gammas[r].name+" - "+this.gammas[r].gamma,idx:r}):this.linList.push({name:this.gammas[r].name,idx:r}),-1!==this.gammas[r].name.indexOf("DCI")?(this.disList.push({name:"DCI-P3",idx:r}),this.disGts.push("P3 - DCI"),this.disList.push({name:"DCI-D60",idx:r}),this.disGts.push("P3 - D60"),this.disList.push({name:"DCI-D65",idx:r}),this.disGts.push("P3 - D65")):-1===this.gammas[r].name.indexOf("OOTF")&&(this.disList.push({name:this.gammas[r].name,idx:r}),this.disGts.push(this.gts[r])),this.dispInIdx=this.rec709,this.dispOutIdx=this.rec709;break;case 2:a.push({name:this.gammas[r].name,idx:r}),this.outList.push({name:this.gammas[r].name,idx:r});break;case 3:this.outList.push({name:this.gammas[r].name,idx:r});break;case 5:case 7:s.push({name:this.gammas[r].name,idx:r}),this.inList.push({name:this.gammas[r].name,idx:r}),this.outList.push({name:this.gammas[r].name,idx:r}),-1===this.gammas[r].name.indexOf("Rec2100")&&-1===this.gammas[r].name.indexOf("PQ")||o.push({name:this.gammas[r].name,idx:r});break;case 6:h.push({name:this.gammas[r].name,idx:r}),this.inList.push({name:this.gammas[r].name,idx:r}),this.outList.push({name:this.gammas[r].name,idx:r})}t=o.length;for(r=0;r<t;r++)this.disList.push(o[r]),this.disGts.push(this.gts[o[r].idx])},LUTGamma.prototype.displayCSMatrices=function(){this.disInM.push(new Float64Array([.6456794776099916,.25911454699971487,.09520597539029335,.08752999151186006,.7596995625540708,.1527704459340693,.03695741988752366,.12928090476633824,.8337616753461381])),this.disInM.push(new Float64Array([1.038144061903922,-.0954526919638479,.0573086300599257,.047948922098344345,.7938618492737212,.15818922862793428,.030132054285551286,.040885792893120027,.9289821528213285])),this.disInM.push(new Float64Array([.6456794776099916,.25911454699971487,.09520597539029335,.08752999151186006,.7596995625540708,.1527704459340693,.03695741988752366,.12928090476633824,.8337616753461381])),this.disInM.push(new Float64Array([.7284052217293149,.16972007915418877,.10187469911649552,.06583664487264183,.7683322228321781,.16583113229518043,.022366516069157787,.07128319107748499,.9063502928533571])),this.disInM.push(new Float64Array([.7946914170629898,.1026408043822886,.10266777855472128,.07452398482107307,.758588312905917,.16688770227300992,.024364185140024742,.06406449308408323,.9115713217758921])),this.disInM.push(new Float64Array([.7781515518174815,.1172862388356883,.10456220934682967,.07226831516524734,.7599479371836014,.16778374765115117,.023460426860374018,.0608411362976594,.9156984368419665])),this.disInM.push(new Float64Array([1.2555250198288999,-.17208107153730076,-.0834439482915996,.005084768090106999,.8440643991075522,.15085083280234088,.03723287615234582,.018430596881984247,.9443365269656698])),this.disOutM.push(new Float64Array([1.626947409729081,-.5401385388696355,-.08680887085944519,-.1785155271148767,1.4179409274640788,-.23942540034920257,-.04443611500929754,-.19591996617201543,1.240356081181313])),this.disOutM.push(new Float64Array([.960046343810585,.11953297884015643,-.07957932265074112,-.052239479550917664,1.2643057472387877,-.21206626768786963,-.028840506704261047,-.05952096816347168,1.088361474867733])),this.disOutM.push(new Float64Array([1.626947409729081,-.5401385388696355,-.08680887085944519,-.1785155271148767,1.4179409274640788,-.23942540034920257,-.04443611500929754,-.19591996617201543,1.240356081181313])),this.disOutM.push(new Float64Array([1.4031705894567847,-.30041923567015294,-.10275135378663051,-.11470806752635113,1.3485540776963754,-.23384601017002465,-.025605199914686478,-.09864828978558927,1.124253489700276])),this.disOutM.push(new Float64Array([1.2771466836937062,-.16317957410992093,-.11396710958378524,-.1198100995203766,1.3542477763440348,-.23443767682365865,-.02571500923777254,-.0908140240587726,1.116529033296545])),this.disOutM.push(new Float64Array([1.306409074362619,-.19250496531591546,-.11390410904670316,-.11858463137123738,1.3529440482926134,-.23435941692137607,-.025591493745000585,-.08496072664984984,1.1105522203948506])),this.disOutM.push(new Float64Array([.7945082685980932,.16100660920522486,.04448512219668231,.0008150912135569344,1.1890558318454256,-.18987092305898276,-.031341423040583696,-.029554874825018167,1.060896297865602]))},LUTGamma.prototype.mInverse=function(t){var i=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);return 0!==i&&new Float64Array([(t[4]*t[8]-t[5]*t[7])/i,(t[2]*t[7]-t[1]*t[8])/i,(t[1]*t[5]-t[2]*t[4])/i,(t[5]*t[6]-t[3]*t[8])/i,(t[0]*t[8]-t[2]*t[6])/i,(t[2]*t[3]-t[0]*t[5])/i,(t[3]*t[7]-t[4]*t[6])/i,(t[1]*t[6]-t[0]*t[7])/i,(t[0]*t[4]-t[1]*t[3])/i])},LUTGamma.prototype.mMult=function(t,i){if(9!==t.length)return!1;var a,s=i.length;return 3===s?((a=new Float64Array(3))[0]=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],a[1]=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],a[2]=t[6]*i[0]+t[7]*i[1]+t[8]*i[2],a):9===s&&((a=new Float64Array(9))[0]=t[0]*i[0]+t[1]*i[3]+t[2]*i[6],a[1]=t[0]*i[1]+t[1]*i[4]+t[2]*i[7],a[2]=t[0]*i[2]+t[1]*i[5]+t[2]*i[8],a[3]=t[3]*i[0]+t[4]*i[3]+t[5]*i[6],a[4]=t[3]*i[1]+t[4]*i[4]+t[5]*i[7],a[5]=t[3]*i[2]+t[4]*i[5]+t[5]*i[8],a[6]=t[6]*i[0]+t[7]*i[3]+t[8]*i[6],a[7]=t[6]*i[1]+t[7]*i[4]+t[8]*i[7],a[8]=t[6]*i[2]+t[7]*i[5]+t[8]*i[8],a)},LUTGamma.prototype.setASCCDL=function(t){var i={};if(this.doASCCDL=!1,this.changedASCCDL=!1,this.tweaks&&void 0!==t.twkASCCDL){var a=t.twkASCCDL;if("boolean"==typeof a.doASCCDL){var s=this.doASCCDL;this.doASCCDL=a.doASCCDL,s&&!this.doASCCDL&&(this.changedASCCDL=!0)}if(void 0!==a.cdl)for(var h=new Float64Array(a.cdl),o=0;o<10;o++)if(h[o]!==this.asc[o]){this.asc=h,o<9&&(this.changedASCCDL=!0);break}}return i.doASCCDL=this.doASCCDL,i},LUTGamma.prototype.setKnee=function(t){var i={};if(this.doKnee=!1,this.tweaks&&void 0!==t.twkKnee){var a=t.twkKnee;"boolean"==typeof a.doKnee&&(this.doKnee=a.doKnee);var s=!0;"boolean"==typeof a.legal&&(s=a.legal);for(var h=!1,o=8;o>0;o-=.1)if(this.f(o)<=.95){h=o;break}if(i.max=h,"number"==typeof a.smoothness&&(this.kSmooth=a.smoothness),"number"!=typeof a.kneeStart||"number"!=typeof a.kneeClip||"number"!=typeof a.clipSlope)this.doKnee=!1;else{if(this.kS=a.kneeStart,this.kS>h&&(this.kS=h,i.kneeStart=this.kS),this.kL=.2*Math.pow(2,this.kS),this.kC=a.kneeClip,this.doASCCDL){var r,n,m,e=.2*Math.pow(2,this.kC);r=.2126*((r=e*this.asc[0]+this.asc[3])<0?r:Math.pow(r,this.asc[6])),n=.7152*((n=e*this.asc[1]+this.asc[4])<0?n:Math.pow(n,this.asc[7])),m=.0722*((m=e*this.asc[2]+this.asc[5])<0?m:Math.pow(m,this.asc[8])),e=(isNaN(r)?0:r)+(isNaN(n)?0:n)+(isNaN(m)?0:m),this.kC=Math.log(e/.2)/Math.LN2}this.kR=this.kC-this.kS,this.kp0=this.f(this.kS),this.kp2=s?.99:959/876-.01,this.kd0=(this.f(this.kS+.001)-this.f(this.kS-.001))*this.kR/.002,this.kD2=a.clipSlope/100,this.kd2=this.kD2*this.kR;var p=2*this.kp0+this.kd0-2*this.kp2+this.kd2,l=-3*this.kp0-2*this.kd0+3*this.kp2-this.kd2,u=this.kd0,L=this.kp0;if(this.ks=.5,this.kp1=((p*this.ks+l)*this.ks+u)*this.ks+L,this.kd1=(((p*(this.ks+.001)+l)*(this.ks+.001)+u)*(this.ks+.001)-((p*(this.ks-.001)+l)*(this.ks-.001)+u)*(this.ks-.001))/.002,this.kd0/=2,this.kd1/=2,this.kd2/=2,this.kd0<0)this.doKnee=!1,i.doKnee=!1;else{var f,g,c,F,y,T,G,b,U,w,M,D;this.kp1,this.kd1;this.kp1=Math.min(this.kp1,.1*this.kp0+.9*this.kp2),this.kd1=Math.max(this.kd1,(this.kp2-this.kp1)/.9),U=this.kd0/(2*(1-this.ks)),w=this.kd1/(2*(1-this.ks)),M=this.kd1/(2*this.ks),D=this.kd2/(2*this.ks),f=2*this.kp0+U-2*this.kp1+w,c=(g=-3*this.kp0-2*U+3*this.kp1-w)*g-3*f*U,G=2*this.kp1+M-2*this.kp2+D,b=-3*this.kp1-2*M+3*this.kp2-D,(c>=0||b*b-3*G*M>=0)&&(y=(-g+(F=Math.pow(c,.5)))/(3*f),T=(-g-F)/(3*f),!isNaN(F)&&(y>0&&y<1||T>0&&T<1)&&(this.kp1=.1*this.kp0+.9*this.kp2,this.kd1=1.29*(this.kp1-this.kp0)/6.59,this.ks=10.89*this.kd1/(1.29*this.kd0)))}}}return i},LUTGamma.prototype.setBlkHi=function(t){var i={};if(this.al=1,this.bl=0,this.ad=1,this.bd=0,this.doBlkHi=!1,this.tweaks&&void 0!==t.twkBlkHi){var a=t.twkBlkHi,s=!1;"number"==typeof a.highRef?(this.highRef!==a.highRef&&(s=!0),this.highRef=a.highRef):this.highRef=.9;var h=new Float64Array([0,this.highRef/.9]);this.getLumVals(h.buffer);var o=h[0],r=h[1],n=!1;"boolean"==typeof a.blackLock&&(n=a.blackLock);var m,e,p=!1;"boolean"==typeof a.highLock&&(p=a.highLock),m="number"==typeof a.blackLevel&&(n||Math.abs(o-a.blackLevel)>1e-4&&!this.changedOut&&!this.changedASCCDL&&!this.changedHDR)?a.blackLevel:o,e="number"==typeof a.highMap&&(p||Math.abs(r-a.highMap)>1e-4&&!this.changedOut&&!s&&!this.changedASCCDL&&!this.changedHDR)?a.highMap:r,i.blackDef=o,i.blackLevel=m,i.highRef=this.highRef,i.highDef=r,i.high709=this.gammas[this.rec709].linToLegal(this.highRef/.9),i.highMap=e,i.hmmm=a,"boolean"==typeof a.doBlkHi&&a.doBlkHi&&(a.doBlack||(m=o),a.doHigh||(e=r),this.nul||!a.doBlack&&!a.doHigh||(this.al=(e-m)/(r-o),this.bl=m-o*this.al,this.ad=this.al,this.bd=(876*(m-this.al*o)+64*(1-this.al))/1023,this.doBlkHi=!0))}else{h=new Float64Array([0,this.highRef/.9]);this.getLumVals(h.buffer);o=h[0],r=h[1];i.blackDef=o,i.blackLevel=o,i.highRef=.9,i.highDef=r,i.high709=this.gammas[this.rec709].linToLegal(this.highRef/.9),i.highMap=r}return 3===this.gammas[this.curOut].cat&&(this.doBlkHi=!1),i.doBlkHi=this.doBlkHi,i},LUTGamma.prototype.setBlkGam=function(t){var i={};if(this.doBlkGam=!1,this.tweaks&&void 0!==t.twkBlkGam){var a=t.twkBlkGam;"boolean"==typeof a.doBlkGam&&(this.doBlkGam=a.doBlkGam),"number"==typeof a.upperLim&&(this.blkGamLStop=a.upperLim),"number"==typeof a.feather&&(this.blkGamFStop=a.feather),"number"==typeof a.power&&(this.blkGamP=a.power)}var s=new Float64Array([0,.2*Math.pow(2,this.blkGamLStop),.2*Math.pow(2,this.blkGamLStop-this.blkGamFStop)]);return this.getLumVals(s.buffer),this.doBlkHi?(this.blkLevel=s[0]*this.al+this.bl,this.blkGamUL=s[1]*this.al+this.bl,this.blkGamLL=s[2]*this.al+this.bl):(this.blkLevel=s[0],this.blkGamUL=s[1],this.blkGamLL=s[2]),this.blkGamF=this.blkGamUL-this.blkGamLL,this.blkGamR=this.blkGamUL-this.blkLevel,i.blkLevel=this.blkLevel,i},LUTGamma.prototype.setDisplay=function(t){if(this.doDisplay=!1,this.tweaks&&void 0!==t.twkDisplay){var i=t.twkDisplay;"boolean"==typeof i.doDisplay&&(this.doDisplay=i.doDisplay),"number"==typeof i.inIdx&&(this.dispInIdx=i.inIdx),"number"==typeof i.outIdx&&(this.dispOutIdx=i.outIdx),"number"==typeof i.inGt&&(this.dispInGt=i.inGt),"number"==typeof i.outGt&&(this.dispOutGt=i.outGt),this.doDisplay&&(this.disM=this.mMult(this.disOutM[this.dispOutGt],this.disInM[this.dispInGt]))}return{}},LUTGamma.prototype.f=function(t){if(t=Math.pow(2,t)/5,this.nul)return t;var i=t;return this.gammas[this.curOut].linToLegal(i)},LUTGamma.prototype.getLumVals=function(t,i){for(var a=new Float64Array(t),s=a.length,h=new Float64Array(3*s),o=h.buffer,r=0;r<s;r++)h[3*r]=a[r],h[3*r+1]=a[r],h[3*r+2]=a[r];i?(this.doASCCDL&&this.ASCCDLOut(o,i),this.doKnee?this.kneeOut(o,i):this.gammas[this.curOut].linToL(o,i)):(this.doASCCDL&&this.ASCCDLOut(o),this.doKnee?this.kneeOut(o):this.gammas[this.curOut].linToL(o));for(r=0;r<s;r++)a[r]=.2126*h[3*r]+.7152*h[3*r+1]+.0722*h[3*r+2]},LUTGamma.prototype.kneeVal=function(t){var i,a,s,h,o,r,n,m,e,p=t;(p=this.gammas[this.curOut].linToLegal(p),t>=this.kL)&&((i=Math.log(t/.2)/Math.LN2)<this.kC?((i=(i-this.kS)/(this.kC-this.kS))<this.ks?(s=this.kd0/(2*(1-this.ks)),h=this.kd1/(2*(1-this.ks)),a=i/this.ks,r=2*this.kp0+s-2*this.kp1+h,n=-3*this.kp0-2*s+3*this.kp1-h,m=s,e=this.kp0):(h=this.kd1/(2*this.ks),o=this.kd2/(2*this.ks),a=(i-this.ks)/(1-this.ks),r=2*this.kp1+h-2*this.kp2+o,n=-3*this.kp1-2*h+3*this.kp2-o,m=h,e=this.kp1),p=(((r*a+n)*a+m)*a+e)*this.kSmooth+(this.kp0*(1-i)+this.kp2*i)*(1-this.kSmooth)):p=this.kp2+(i-this.kC)*this.kD2);return p},LUTGamma.prototype.ASCCDLOut=function(t){for(var i,a=new Float64Array(t),s=a.length,h=0;h<s;h+=3)i=(i=(i=a[h])*this.asc[0]+this.asc[3])<0?i:Math.pow(i,this.asc[6]),a[h]=isNaN(i)?0:i,i=(i=(i=a[h+1])*this.asc[1]+this.asc[4])<0?i:Math.pow(i,this.asc[7]),a[h+1]=isNaN(i)?0:i,i=(i=(i=a[h+2])*this.asc[2]+this.asc[5])<0?i:Math.pow(i,this.asc[8]),a[h+2]=isNaN(i)?0:i},LUTGamma.prototype.kneeOut=function(t,i){var a=new Float64Array(t.slice(0)),s=new Float64Array(t);i?this.gammas[this.curOut].linToL(t,i):this.gammas[this.curOut].linToL(t);for(var h,o,r,n,m,e,p,l,u,L=s.length,f=0;f<L;f++)a[f]>=this.kL&&((h=Math.log(a[f]/.2)/Math.LN2)<this.kC?((h=(h-this.kS)/(this.kC-this.kS))<this.ks?(r=this.kd0/(2*(1-this.ks)),n=this.kd1/(2*(1-this.ks)),o=h/this.ks,e=2*this.kp0+r-2*this.kp1+n,p=-3*this.kp0-2*r+3*this.kp1-n,l=r,u=this.kp0):(n=this.kd1/(2*this.ks),m=this.kd2/(2*this.ks),o=(h-this.ks)/(1-this.ks),e=2*this.kp1+n-2*this.kp2+m,p=-3*this.kp1-2*n+3*this.kp2-m,l=n,u=this.kp1),s[f]=(((e*o+p)*o+l)*o+u)*this.kSmooth+(this.kp0*(1-h)+this.kp2*h)*(1-this.kSmooth)):s[f]=this.kp2+(h-this.kC)*this.kD2)},LUTGamma.prototype.blkHiOut=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=i[s]*this.al+this.bl},LUTGamma.prototype.blkGamOut=function(t){for(var i,a,s=new Float64Array(t),h=s.length,o=0;o<h;o++)s[o]>this.blkLevel&&s[o]<=this.blkGamUL&&(s[o]>this.blkGamLL?(a=Math.pow((s[o]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,s[o]<=a?s[o]=a:(i=(s[o]-this.blkGamLL)/this.blkGamF,i*=i,s[o]=i*s[o]+(1-i)*a)):s[o]=Math.pow((s[o]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel)},LUTGamma.prototype.gamutLimOut=function(t,i,a,s,h){var o,r,n,m,e=new Float64Array(t),p=e.length;if(void 0!==s)if(this.doKnee?this.kneeOut(s,{rgb:!0}):this.gammas[this.curOut].linToL(s,{rgb:!0}),this.doBlkHi&&this.blkHiOut(s),this.doBlkGam&&this.blkGamOut(s),this.doDisplay&&this.displayOut(s,{rgb:!0}),m=new Float64Array(s),h)for(var l=0;l<p;l+=3){var u,L;e[l]=Math.max(0,e[l]),e[l+1]=Math.max(0,e[l+1]),e[l+2]=Math.max(0,e[l+2]),o=Math.max(m[l],m[l+1],m[l+2]),r=Math.min(m[l],m[l+1],m[l+2]),u=Math.max(e[l],e[l+1],e[l+2]),L=Math.min(e[l],e[l+1],e[l+2]),(n=Math.max(o-r,u-L)/a)>1&&(Y=i[0]*e[l]+i[1]*e[l+1]+i[2]*e[l+2],e[l]=Y+(e[l]-Y)/n,e[l+1]=Y+(e[l+1]-Y)/n,e[l+2]=Y+(e[l+2]-Y)/n)}else for(l=0;l<p;l+=3)e[l]=Math.max(0,e[l]),e[l+1]=Math.max(0,e[l+1]),e[l+2]=Math.max(0,e[l+2]),(n=((o=Math.max(m[l],m[l+1],m[l+2]))-(r=Math.min(m[l],m[l+1],m[l+2])))/a)>1&&(Y=i[0]*e[l]+i[1]*e[l+1]+i[2]*e[l+2],e[l]=Y+(e[l]-Y)/n,e[l+1]=Y+(e[l+1]-Y)/n,e[l+2]=Y+(e[l+2]-Y)/n);else for(l=0;l<p;l+=3)e[l]=Math.max(0,e[l]),e[l+1]=Math.max(0,e[l+1]),e[l+2]=Math.max(0,e[l+2]),(o=Math.max(e[l],e[l+1],e[l+2]))>a&&(n=(o-(r=Math.min(e[l],e[l+1],e[l+2])))/a)>1&&(Y=i[0]*e[l]+i[1]*e[l+1]+i[2]*e[l+2],e[l]=Y+(e[l]-Y)/n,e[l+1]=Y+(e[l+1]-Y)/n,e[l+2]=Y+(e[l+2]-Y)/n)},LUTGamma.prototype.displayOut=function(t,i){if(i){if(i.out=!0,this.gammas[this.dispInIdx].linFromL(t,i),i.rgb&&this.dispInGt!==this.dispOutGt)for(var a,s,h,o=new Float64Array(t),r=o.length,n=this.disM,m=0;m<r;m+=3)a=o[m],s=o[m+1],h=o[m+2],o[m]=n[0]*a+n[1]*s+n[2]*h,o[m+1]=n[3]*a+n[4]*s+n[5]*h,o[m+2]=n[6]*a+n[7]*s+n[8]*h;this.gammas[this.dispOutIdx].linToL(t,i)}else this.gammas[this.dispInIdx].linFromL(t,{out:!0}),this.gammas[this.dispOutIdx].linToL(t)},LUTGamma.prototype.fcOut=function(t,i){for(var a=new Uint8Array(t),s=new Float64Array(i),h=s.length,o=0,r=0;r<h;r+=3){switch(a[o]){case 0:s[r]=.75,s[r+1]=0,s[r+2]=.75;break;case 1:s[r]=0,s[r+1]=0,s[r+2]=.75;break;case 3:s[r]=0,s[r+1]=.7,s[r+2]=0;break;case 5:s[r]=.75,s[r+1]=.35,s[r+2]=.35;break;case 7:s[r]=.9,s[r+1]=.45,s[r+2]=0;break;case 9:s[r]=.7,s[r+1]=.7,s[r+2]=0;break;case 10:s[r]=.75,s[r+1]=0,s[r+2]=0}o++}},LUTGamma.prototype.finalOut=function(t,i){var a,s,h=new Float64Array(t),o=h.length;if(this.outL?(a=i?0:(this.bClip-64)/876,s=(this.wClip-64)/876):(a=i?64/1023:this.bClip/1023,s=this.wClip/1023),this.clip&&(this.outL||!this.clipL?(this.clipB&&a<0&&(a=0),this.clipW&&s>1&&(s=1)):(this.clipB&&a<64/1023&&(a=64/1023),this.clipW&&s>959/1023&&(s=959/1023))),this.hdrOut&&!this.doDisplay){var r=this.gammas[this.curOut].mxO;this.outL?r<s&&(s=r):(r=.85630498533724*r+.06256109481916)<s&&(s=r)}for(var n=0;n<o;n++)this.outL||(h[n]=(876*h[n]+64)/1023),h[n]=Math.min(s,Math.max(a,h[n]))},LUTGammaLog.prototype.changeISO=function(t){this.iso=t},LUTGammaLog.prototype.changeContrast=function(t,i){},LUTGammaLog.prototype.changeRange=function(t,i){},LUTGammaLog.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[8]?i[s]=this.params[2]*Math.log(i[s]*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:0===this.params[0]?i[s]=this.params[2]*Math.log(1e-15*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:i[s]=(i[s]-this.params[1])/this.params[0]},LUTGammaLog.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLog.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[7]?i[s]=(Math.pow(this.params[4],(i[s]-this.params[5])/this.params[2])-this.params[6])/this.params[3]:i[s]=this.params[0]*i[s]+this.params[1]},LUTGammaLog.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaLog.prototype.linToData=function(t){return t>=this.params[8]?this.params[2]*Math.log(t*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:0===this.params[0]?this.params[2]*Math.log(1e-15*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:(t-this.params[1])/this.params[0]},LUTGammaLog.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLog.prototype.linFromData=function(t){return t>=this.params[7]?(Math.pow(this.params[4],(t-this.params[5])/this.params[2])-this.params[6])/this.params[3]:this.params[0]*t+this.params[1]},LUTGammaLog.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaLogClip.prototype.changeISO=function(t){this.iso=t},LUTGammaLogClip.prototype.changeContrast=function(t,i){},LUTGammaLogClip.prototype.changeRange=function(t,i){},LUTGammaLogClip.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[10]?i[s]=(Math.log(i[s]/.2)/Math.log(2)-this.params[12])/this.params[11]:i[s]>=this.params[8]?i[s]=this.params[2]*Math.log(i[s]*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:0===this.params[0]?i[s]=this.params[2]*Math.log(1e-15*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:i[s]=(i[s]-this.params[1])/this.params[0]},LUTGammaLogClip.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLogClip.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[9]?i[s]=.2*Math.pow(2,this.params[11]*i[s]+this.params[12]):i[s]>=this.params[7]?i[s]=(Math.pow(this.params[4],(i[s]-this.params[5])/this.params[2])-this.params[6])/this.params[3]:i[s]=this.params[0]*i[s]+this.params[1]},LUTGammaLogClip.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaLogClip.prototype.linToData=function(t){return t>=this.params[10]?(Math.log(t/.2)/Math.log(2)-this.params[12])/this.params[11]:t>=this.params[8]?this.params[2]*Math.log(t*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:0===this.params[0]?this.params[2]*Math.log(1e-15*this.params[3]+this.params[6])/Math.log(this.params[4])+this.params[5]:(t-this.params[1])/this.params[0]},LUTGammaLogClip.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLogClip.prototype.linFromData=function(t){return t>=this.params[9]?.2*Math.pow(2,this.params[11]*t+this.params[12]):t>=this.params[7]?(Math.pow(this.params[4],(t-this.params[5])/this.params[2])-this.params[6])/this.params[3]:this.params[0]*t+this.params[1]},LUTGammaLogClip.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaCineon.prototype.changeISO=function(t){this.iso=t},LUTGammaCineon.prototype.changeContrast=function(t,i){},LUTGammaCineon.prototype.changeRange=function(t,i){},LUTGammaCineon.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<this.p0?i[s]=(i[s]-this.p0)/this.d0:i[s]=(Math.log(i[s]*this.den+this.bl)/(Math.LN10*this.mul)+this.wp)/this.cv},LUTGammaCineon.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaCineon.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<0?i[s]=i[s]*this.d0+this.p0:i[s]=(Math.pow(10,(i[s]*this.cv-this.wp)*this.mul)-this.bl)/this.den},LUTGammaCineon.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaCineon.prototype.linToData=function(t){return t<this.p0?(t-this.p0)/this.d0:(Math.log(t*this.den+this.bl)/(Math.LN10*this.mul)+this.wp)/this.cv},LUTGammaCineon.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaCineon.prototype.linFromData=function(t){return t<0?t*this.d0+this.p0:(Math.pow(10,(t*this.cv-this.wp)*this.mul)-this.bl)/this.den},LUTGammaCineon.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaArri.prototype.getParams=function(t){var i=t/this.nominalEI,a=[];if(2===this.sup){var s=(Math.log(i)/Math.LN2*(.89-1)/3+1)*this.encodingGain,h=this.midGraySignal+this.blackOffset,o=Math.log(((this.blackSignal-this.blackSignal)*i+this.blackOffset)/h)/Math.LN10*s+this.encodingOffset,r=Math.log(((this.blackSignal+1/4095-this.blackSignal)*i+this.blackOffset)/h)/Math.LN10*s+this.encodingOffset;a[0]=this.blackSignal,a[4]=this.encodingOffset,a[3]=s,a[2]=this.blackOffset/h,a[1]=i/h/(i*(.18/this.midGraySignal)),a[6]=o,a[5]=4095*(r-o)/(i*(.18/this.midGraySignal)),a[7]=0,a[8]=0,a[9]=0,a[10]=0,a[11]=0,a[12]=0,a[13]=0}else{a[0]=1/9;for(var n=1/(a[0]*Math.LN10),m=Math.log(a[0])/Math.LN10-n*a[0],e=this.midGraySignal/i,p=(s=(Math.log(i)/Math.LN2*(.89-1)/3+1)*this.encodingGain,this.encodingOffset),l=0,u=0;u<3;u++)l=((95/1023-p)/s-m)/n,p=this.encodingOffset-Math.log(1+l)/Math.LN10*s;var L=Math.log((1-this.blackSignal)/e+l)/Math.LN10*s+p;a[1]=1/e,a[2]=l-this.blackSignal/e,a[5]=n*a[1]*s,a[6]=s*(n*a[2]+m)+p;var f=4/(.18*t),g=this.blackSignal;a[2]=a[2]+a[1]*g,a[1]*=f,a[6]=a[6]+a[5]*g,a[5]*=f,a[3]=s,a[4]=p,a[0]=(a[0]-a[2])/a[1],a[7]=L,a[8]=.8,a[9]=1,a[10]=.8,a[11]=L,a[12]=1,a[13]=(5*L-4)*(5*L-4)}return a},LUTGammaArri.prototype.setHighKnee=function(t,i,a,s,h,o){var r=[],n=i-t;n*=n*n,r[0]=2*a,r[0]+=-2*s,r[0]+=h*(i-t),r[0]+=o*(i-t),r[0]/=n,r[1]=-3*a*(t+i),r[1]+=3*s*(t+i),r[1]+=h*(t*t+t*i-2*i*i),r[1]+=o*(2*t*t-t*i-i*i),r[1]/=n,r[2]=6*a*t*i,r[2]+=-6*s*t*i,r[2]+=h*(-2*t*t*i+t*i*i+i*i*i),r[2]+=o*(2*t*i*i-t*t*i-t*t*t),r[2]/=n,r[3]=a*(i*i*i-3*t*i*i),r[3]+=s*(3*t*t*i-t*t*t),r[3]+=h*(t*t*i*i-t*i*i*i),r[3]+=o*(t*t*t*i-t*t*i*i),r[3]/=n;var m=1/(1.92*r[0]+1.6*r[1]+r[2]),e=1/(3*r[0]+2*r[1]+r[2]),p=this.xm-.8;this.tHK[0]=((m+e)*p-.4)/(p*p*p),this.tHK[2]=1,this.tHK[3]=.8,this.tHK[1]=e/(2*p)-1.5*p*this.tHK[0]-this.tHK[2]/(2*p),this.tHS=(.6*this.tHK[0]+.4)*this.tHK[1]+this.tHK[2],this.fHK[0]=r[0],this.fHK[1]=r[1],this.fHK[2]=r[2],this.fHK[3]=r[3],this.fHS=3*this.fHK[0]+2*this.fHK[1]+this.fHK[2],this.knee=!0},LUTGammaArri.prototype.changeISO=function(t){this.iso=t;var i=this.getParams(t);this.params[0]=1/i[5],this.params[1]=-i[6]/i[5],this.params[2]=i[3],this.params[3]=i[1],this.params[4]=10,this.params[5]=i[4],this.params[6]=i[2],this.params[7]=i[5]*i[0]+i[6],this.params[8]=i[0],this.params[9]=i[5],this.params[10]=1/this.params[2],this.params[11]=1/this.params[3],this.params[12]=this.params[2]/Math.log(this.params[4]),this.params[13]=this.params[12]*Math.log(1e-15*this.params[3]+this.params[6])+this.params[5],this.xm=i[7],this.xm>1?this.setHighKnee(i[8],i[9],i[10],i[11],i[12],i[13]):this.knee=!1},LUTGammaArri.prototype.changeContrast=function(t,i){},LUTGammaArri.prototype.changeRange=function(t,i){2!==this.sup&&(this.recleg=t,this.outleg=i)},LUTGammaArri.prototype.linToD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=.9*a[h],a[h]>=this.params[8]?a[h]=Math.log(a[h]*this.params[3]+this.params[6])*this.params[12]+this.params[5]:0===this.params[0]?a[h]=this.params[13]:a[h]=(a[h]-this.params[1])*this.params[9];if(this.knee)for(h=0;h<s;h++)a[h]>.8&&(a[h]>this.xm?a[h]=(a[h]-this.xm)*this.tHS+1:(a[h]-=.8,a[h]=((this.tHK[0]*a[h]+this.tHK[1])*a[h]+this.tHK[2])*a[h]+this.tHK[3]));var o=this.outleg;if(i&&i.rec&&(o=this.recleg),o)for(h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaArri.prototype.linToL=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToD(t,i):this.linToD(t);for(var h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724},LUTGammaArri.prototype.linFromD=function(t){var i=new Float64Array(t),a=i.length;if(this.recleg)for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;if(this.knee)for(s=0;s<a;s++)i[s]>.8&&(i[s]>1?i[s]=(i[s]-1)*this.fHS+1:i[s]=((this.fHK[0]*i[s]+this.fHK[1])*i[s]+this.fHK[2])*i[s]+this.fHK[3]);for(s=0;s<a;s++)i[s]>=this.params[7]?i[s]=(Math.pow(this.params[4],(i[s]-this.params[5])*this.params[10])-this.params[6])*this.params[11]/.9:i[s]=(i[s]*this.params[0]+this.params[1])/.9},LUTGammaArri.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaArri.prototype.linToData=function(t,i){var a;t*=.9;var s=this.outleg;return i&&i.rec&&(s=this.recleg),a=t>=this.params[8]?Math.log(t*this.params[3]+this.params[6])*this.params[12]+this.params[5]:0===this.params[0]?this.params[13]:(t-this.params[1])*this.params[9],this.knee&&t>.8&&(t>this.xm?a=(t-this.xm)*this.tHS+1:(t-=.8,a=((this.tHK[0]*t+this.tHK[1])*t+this.tHK[2])*t+this.tHK[3])),s&&(a=.85630498533724*a+.06256109481916),a},LUTGammaArri.prototype.linToLegal=function(t,i){return i?(this.linToData(t,i)-.06256109481916)/.85630498533724:(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaArri.prototype.linFromData=function(t){return this.recleg&&(t=(t-.06256109481916)/.85630498533724),this.knee&&t>.8&&(t=t>1?(t-1)*this.fHS+1:((this.fHK[0]*t+this.fHK[1])*t+this.fHK[2])*t+this.fHK[3]),t>=this.params[7]?(Math.pow(this.params[4],(t-this.params[5])*this.params[10])-this.params[6])*this.params[11]/.9:(t*this.params[0]+this.params[1])/.9},LUTGammaArri.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaLogC4.prototype.changeISO=function(t){this.iso=t},LUTGammaLogC4.prototype.changeContrast=function(t,i){},LUTGammaLogC4.prototype.changeRange=function(t,i){this.recleg=t,this.outleg=i},LUTGammaLogC4.prototype.linToD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=.9*a[h],a[h]>=this.t?a[h]=(Math.log2(this.a*a[h]+64)-6)*this.bdiv14+this.c:a[h]=(a[h]-this.t)*this.oneovers;var o=this.outleg;if(i&&i.rec&&(o=this.recleg),o)for(h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaLogC4.prototype.linToL=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToD(t,i):this.linToD(t);for(var h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724},LUTGammaLogC4.prototype.linFromD=function(t){var i=new Float64Array(t),a=i.length;if(this.recleg)for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;for(s=0;s<a;s++)i[s]>=0?i[s]=(Math.pow(2,this.bund14*(i[s]-this.c)+6)-64)*this.oneovera/.9:i[s]=(i[s]*this.s+this.t)/.9},LUTGammaLogC4.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaLogC4.prototype.linToData=function(t,i){t*=.9;var a=this.outleg;return i&&i.rec&&(a=this.recleg),a?.85630498533724*(t>=this.t?(Math.log2(this.a*t+64)-6)*this.bdiv14+this.c:(t-this.t)*this.oneovers)+.06256109481916:t>=this.t?(Math.log2(this.a*t+64)-6)*this.bdiv14+this.c:(t-this.t)*this.oneovers},LUTGammaLogC4.prototype.linToLegal=function(t,i){return i?(this.linToData(t,i)-.06256109481916)/.85630498533724:(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLogC4.prototype.linFromData=function(t){return this.recleg&&(t=(t-.06256109481916)/.85630498533724),t>=0?(Math.pow(2,this.bund14*(t-this.c)+6)-64)*this.oneovera/.9:(t*this.s+this.t)/.9},LUTGammaLogC4.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaCLog3.prototype.changeISO=function(t){this.iso=t},LUTGammaCLog3.prototype.changeContrast=function(t,i){},LUTGammaCLog3.prototype.changeRange=function(t,i){},LUTGammaCLog3.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaCLog3.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<-.014?i[s]=-.42889912*Math.log(14.98325*-i[s]+1)/Math.LN10+.07623209:i[s]<=.014?i[s]=2.3069815*i[s]+.073059361:i[s]=.42889912*Math.log(14.98325*i[s]+1)/Math.LN10+.069886632},LUTGammaCLog3.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaCLog3.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<.04076162?i[s]=-(Math.pow(10,(.07623209-i[s])/.42889912)-1)/14.98325:i[s]<=.105357102?i[s]=(i[s]-.073059361)/2.3069815:i[s]=(Math.pow(10,(i[s]-.069886632)/.42889912)-1)/14.98325},LUTGammaCLog3.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaCLog3.prototype.linToLegal=function(t){return t<-.014?-.42889912*Math.log(14.98325*-t+1)/Math.LN10+.07623209:t<=.014?2.3069815*t+.073059361:.42889912*Math.log(14.98325*t+1)/Math.LN10+.069886632},LUTGammaCLog3.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaCLog3.prototype.linFromLegal=function(t){return t<.04076162?-(Math.pow(10,(.07623209-t)/.42889912)-1)/14.98325:t<=.105357102?(t-.073059361)/2.3069815:(Math.pow(10,(t-.069886632)/.42889912)-1)/14.98325},LUTGammaNLog.prototype.changeISO=function(t){this.iso=t},LUTGammaNLog.prototype.changeContrast=function(t,i){},LUTGammaNLog.prototype.changeRange=function(t,i){},LUTGammaNLog.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]*=.9,i[s]>=.328?i[s]=(150*Math.log(i[s])+619)/1023:i[s]=650.1864339*Math.cbrt(i[s]+.0075)/1023},LUTGammaNLog.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaNLog.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.logCut?i[s]=Math.exp((1023*i[s]-619)/150):i[s]=Math.pow(1023*i[s]/650.1864339,3)-.0075,i[s]/=.9},LUTGammaNLog.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaNLog.prototype.linToData=function(t){return(t*=.9)>=.328?(150*Math.log(t)+619)/1023:650.1864339*Math.cbrt(t+.0075)/1023},LUTGammaNLog.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaNLog.prototype.linFromData=function(t){return t>=this.logCut?Math.exp((1023*t-619)/150)/.9:(Math.pow(1023*t/650.1864339,3)-.0075)/.9},LUTGammaNLog.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaLogLog.prototype.changeISO=function(t){this.iso=t},LUTGammaLogLog.prototype.changeContrast=function(t,i){},LUTGammaLogLog.prototype.changeRange=function(t,i){},LUTGammaLogLog.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaLogLog.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]*=.9,i[s]+=this.params[2],i[s]<0?i[s]=-this.params[0]*Math.log(-i[s]*this.params[1]+1)/Math.LN10:i[s]=this.params[0]*Math.log(i[s]*this.params[1]+1)/Math.LN10},LUTGammaLogLog.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaLogLog.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<0?i[s]=((Math.pow(10,-i[s]/this.params[0])-1)/-this.params[1]-this.params[2])/.9:i[s]=((Math.pow(10,i[s]/this.params[0])-1)/this.params[1]-this.params[2])/.9},LUTGammaLogLog.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaLogLog.prototype.linToLegal=function(t){return t*=.9,(t+=this.params[2])<0?-this.params[0]*Math.log(-t*this.params[1]+1)/Math.LN10:this.params[0]*Math.log(t*this.params[1]+1)/Math.LN10},LUTGammaLogLog.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaLogLog.prototype.linFromLegal=function(t){return t<0?((Math.pow(10,-t/this.params[0])-1)/-this.params[1]-this.params[2])/.9:((Math.pow(10,t/this.params[0])-1)/this.params[1]-this.params[2])/.9},LUTGammaDaVinci.prototype.changeISO=function(t){this.iso=t},LUTGammaDaVinci.prototype.changeContrast=function(t,i){},LUTGammaDaVinci.prototype.changeRange=function(t,i){},LUTGammaDaVinci.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaDaVinci.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]*=.9,i[s]>this.lin_cut?i[s]=(Math.log2(i[s]+this.a)+this.b)*this.c:i[s]=i[s]*this.m},LUTGammaDaVinci.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaDaVinci.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.log_cut?i[s]=Math.pow(2,i[s]/this.c-this.b)-this.a:i[s]=i[s]/this.m,i[s]*=this.rescale},LUTGammaDaVinci.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaDaVinci.prototype.linToLegal=function(t){return(t*=.9)>=this.lin_cut?(Math.log2(t+this.a)+this.b)*this.c:t*this.m},LUTGammaDaVinci.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaDaVinci.prototype.linFromLegal=function(t){return t>=this.log_cut?(Math.pow(2,t/this.c-this.b)-this.a)*this.rescale:t/this.m},LUTGammaAppleLog.prototype.changeISO=function(t){this.iso=t},LUTGammaAppleLog.prototype.changeContrast=function(t,i){},LUTGammaAppleLog.prototype.changeRange=function(t,i){},LUTGammaAppleLog.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]*=.9,i[s]<this.R0?i[s]=0:i[s]>this.Rt?i[s]=this.gamma*Math.log2(i[s]+this.beta)+this.delta:i[s]=this.cc*(i[s]-this.R0)*(i[s]-this.R0)},LUTGammaAppleLog.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaAppleLog.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<0?i[s]=this.R0:i[s]>=this.Pt?i[s]=Math.pow(2,(i[s]-this.delta)/this.gamma)-this.beta:i[s]=Math.sqrt(i[s]/this.cc)+this.R0,i[s]/=.9},LUTGammaAppleLog.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaAppleLog.prototype.linToData=function(t){return(t*=.9)<this.r0?0:t>this.rt?this.gamma*Math.log2(t+this.beta)+this.delta:this.cc*(t-this.r0)*(t-this.r0)},LUTGammaAppleLog.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaAppleLog.prototype.linFromData=function(t){return t<0?this.R0/.9:t>=this.Pt?(Math.pow(2,(t-this.delta)/this.gamma)-this.beta)/.9:(Math.sqrt(t/this.cc)+this.R0)/.9},LUTGammaAppleLog.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaLog2.prototype.changeISO=function(t){this.iso=t},LUTGammaLog2.prototype.changeContrast=function(t,i){},LUTGammaLog2.prototype.changeRange=function(t,i){},LUTGammaLog2.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]*=.9,i[s]<=this.linMin?(i[s]-=this.linMin,i[s]*=this.fLowSlope):(i[s]+=this.linOffset,i[s]=Math.log(i[s])/Math.LN2,i[s]-=this.cutLog,i[s]*=this.stopVert)},LUTGammaLog2.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLog2.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<=0?(i[s]*=this.rLowSlope,i[s]+=this.linMin):(i[s]*=this.stopMax,i[s]+=this.cutLog,i[s]=Math.pow(2,i[s]),i[s]-=this.linOffset),i[s]/=.9},LUTGammaLog2.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaLog2.prototype.linToData=function(t){return(t*=.9)<=this.linMin?(t-=this.linMin,t*=this.fLowSlope):(t+=this.linOffset,t=Math.log(t)/Math.LN2,t-=this.cutLog,t*=this.stopVert),t},LUTGammaLog2.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLog2.prototype.linFromData=function(t){return t<=0?(t*=this.rLowSlope,t+=this.linMin):(t*=this.stopMax,t+=this.cutLog,t=Math.pow(2,t),t-=this.linOffset),t/=.9},LUTGammaLog2.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaGam.prototype.changeISO=function(t){this.iso=t},LUTGammaGam.prototype.changeContrast=function(t,i){},LUTGammaGam.prototype.changeRange=function(t,i){},LUTGammaGam.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaGam.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[3]?i[s]=(1+this.params[2])*Math.pow(i[s],1/this.params[0])-this.params[2]:i[s]=this.params[1]*i[s]},LUTGammaGam.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaGam.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=this.params[4]?i[s]=Math.pow((i[s]+this.params[2])/(1+this.params[2]),this.params[0]):i[s]=i[s]/this.params[1]},LUTGammaGam.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaGam.prototype.linToLegal=function(t){return t>=this.params[3]?(1+this.params[2])*Math.pow(t,1/this.params[0])-this.params[2]:this.params[1]*t},LUTGammaGam.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaGam.prototype.linFromLegal=function(t){return t>=this.params[4]?Math.pow((t+this.params[2])/(1+this.params[2]),this.params[0]):t/this.params[1]},LUTGammaBBCGam.prototype.changeISO=function(t){this.iso=t},LUTGammaBBCGam.prototype.changeContrast=function(t,i){},LUTGammaBBCGam.prototype.changeRange=function(t,i){},LUTGammaBBCGam.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaBBCGam.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.params[3]?i[s]=Math.pow((i[s]+this.params[2])/(1+this.params[2]),this.params[0]):i[s]=i[s]*this.params[1]},LUTGammaBBCGam.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaBBCGam.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.params[4]?i[s]=(1+this.params[2])*Math.pow(i[s],1/this.params[0])-this.params[2]:i[s]=i[s]/this.params[1]},LUTGammaBBCGam.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaBBCGam.prototype.linToLegal=function(t){return t>this.params[3]?Math.pow((t+this.params[2])/(1+this.params[2]),this.params[0]):t*this.params[1]},LUTGammaBBCGam.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaBBCGam.prototype.linFromLegal=function(t){return t>=this.params[4]?(1+this.params[2])*Math.pow(t,1/this.params[0])-this.params[2]:t/this.params[1]},LUTGammaLin.prototype.changeISO=function(t){this.iso=t},LUTGammaLin.prototype.changeContrast=function(t,i){},LUTGammaLin.prototype.changeRange=function(t,i){},LUTGammaLin.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=i[s]*this.zero*.85630498533724+.06256109481916},LUTGammaLin.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=i[s]*this.zero},LUTGammaLin.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/(.85630498533724*this.zero)},LUTGammaLin.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=i[s]/this.zero},LUTGammaLin.prototype.linToData=function(t){return t*this.zero*.85630498533724+.06256109481916},LUTGammaLin.prototype.linToLegal=function(t){return t*this.zero},LUTGammaLin.prototype.linFromData=function(t){return(t-.06256109481916)/(.85630498533724*this.zero)},LUTGammaLin.prototype.linFromLegal=function(t){return t/this.zero},LUTGammaPQ.prototype.setLw=function(){var t=Math.pow(Math.max(0,this.ootf.LwI)/1e4,this.m1);this.mxI=Math.pow((this.c1+this.c2*t)/(1+this.c3*t),this.m2);t=Math.pow(Math.max(0,this.ootf.LwO)/1e4,this.m1);this.mxO=Math.pow((this.c1+this.c2*t)/(1+this.c3*t),this.m2)},LUTGammaPQ.prototype.changeISO=function(t){this.iso=t},LUTGammaPQ.prototype.changeContrast=function(t,i){},LUTGammaPQ.prototype.changeRange=function(t,i){},LUTGammaPQ.prototype.linToD=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToL(t,i):this.linToL(t);for(var h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaPQ.prototype.linToL=function(t,i){var a,s,h=new Float64Array(t),o=h.length,r=this.m1,n=this.m2,m=this.c1,e=this.c2,p=this.c3;i?(this.ootf.linToL(t,i),s=i.rec?this.mxI:this.mxO):(this.ootf.linToL(t),s=this.mxO);for(var l=0;l<o;l++)a=Math.pow(Math.max(0,h[l])/1e4,r),h[l]=Math.min(s,Math.pow((m+e*a)/(1+p*a),n))},LUTGammaPQ.prototype.linFromD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724;i?this.linFromL(t,i):this.linFromL(t)},LUTGammaPQ.prototype.linFromL=function(t,i){for(var a,s=new Float64Array(t),h=s.length,o=this.m1,r=this.m2,n=this.c1,m=this.c2,e=this.c3,p=this.linToLegal(0),l=0;l<h;l++)s[l]<=p?s[l]=0:(a=Math.pow(s[l],1/r),s[l]=1e4*Math.pow((a-n)/(m-e*a),1/o));i?this.ootf.linFromL(t,i):this.ootf.linFromL(t)},LUTGammaPQ.prototype.linToData=function(t,i){return i?.85630498533724*this.linToLegal(t,i)+.06256109481916:.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaPQ.prototype.linToLegal=function(t,i){var a;if(i){var s=Math.pow(Math.max(0,this.ootf.linToLegal(t,i))/1e4,this.m1);a=i.rec?this.mxI:this.mxO}else{s=Math.pow(Math.max(0,this.ootf.linToLegal(t))/1e4,this.m1);a=this.mxO}return Math.min(a,Math.pow((this.c1+this.c2*s)/(1+this.c3*s),this.m2))},LUTGammaPQ.prototype.linFromData=function(t,i){return i?this.linFromLegal((t-.06256109481916)/.85630498533724,i):this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaPQ.prototype.linFromLegal=function(t,i){var a=Math.pow(t,1/this.m2);return t=i?this.ootf.linFromLegal(1e4*Math.pow((a-this.c1)/(this.c2-this.c3*a),1/this.m1),i):this.ootf.linFromLegal(1e4*Math.pow((a-this.c1)/(this.c2-this.c3*a),1/this.m1)),isNaN(t)?0:t},LUTGammaHLG.prototype.changeISO=function(t){this.iso=t},LUTGammaHLG.prototype.changeContrast=function(t,i){},LUTGammaHLG.prototype.changeRange=function(t,i){},LUTGammaHLG.prototype.setBBC=function(t,i){this.nbI=t?2.821251498:1,this.nbO=i?2.821251498:1},LUTGammaHLG.prototype.linToD=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToL(t,i):this.linToL(t);for(var h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaHLG.prototype.linToL=function(t,i){var a,s=new Float64Array(t),h=s.length;a=i&&i.rec?this.nbI:this.nbO;for(var o=0;o<h;o++)s[o]<0?s[o]=0:s[o]<=1/a?s[o]=Math.pow(s[o]*a,.5)/2:s[o]=this.a*Math.log(s[o]*a-this.b)+this.c},LUTGammaHLG.prototype.linFromD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724;i?this.linFromL(t,i):this.linFromL(t)},LUTGammaHLG.prototype.linFromL=function(t,i){var a,s=new Float64Array(t),h=s.length;a=i&&i.out?this.nbO:this.nbI;for(var o=0;o<h;o++)s[o]<0?s[o]=0:s[o]<=.5?s[o]=Math.pow(2*s[o],2)/a:s[o]=(Math.exp((s[o]-this.c)/this.a)+this.b)/a},LUTGammaHLG.prototype.linToData=function(t,i){return i?.85630498533724*this.linToLegal(t)+.06256109481916:.85630498533724*this.linToLegal(t,i)+.06256109481916},LUTGammaHLG.prototype.linToLegal=function(t,i){var a;return a=i&&i.rec?this.nbI:this.nbO,t<0?0:t<=1/a?Math.pow(t*a,.5)/2:this.a*Math.log(t*a-this.b)+this.c},LUTGammaHLG.prototype.linFromData=function(t,i){return i?this.linFromLegal((t-.06256109481916)/.85630498533724,i):this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaHLG.prototype.linFromLegal=function(t,i){var a;return a=i&&i.out?this.nbO:this.nbI,t<0?0:t<=.5?Math.pow(2*t,2)/a:(Math.exp((t-this.c)/this.a)+this.b)/a},LUTGammaOOTFPQ.prototype.setLw=function(t,i){this.LwI=t;var a=!1;return i!==this.LwO&&(a=!0),this.LwO=i,this.eI=this.linToLegal(0,{rec:!0}),this.eO=this.linToLegal(0),a},LUTGammaOOTFPQ.prototype.changeISO=function(t){this.iso=t},LUTGammaOOTFPQ.prototype.changeContrast=function(t,i){},LUTGammaOOTFPQ.prototype.changeRange=function(t,i){},LUTGammaOOTFPQ.prototype.linToD=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToL(t,i):this.linToL(t);for(var h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaOOTFPQ.prototype.linToL=function(t,i){var a,s,h=new Float64Array(t),o=h.length;i&&i.rec?(a=this.eI,s=this.LwI/100):(a=this.eO,s=this.LwO/100);for(var r=this.s,n=0;n<o;n++)h[n]<0?h[n]=a:(h[n]/=100,h[n]>3024e-7?h[n]=1.099*Math.pow(59.5208*h[n],.45)-.099:h[n]=267.84*Math.max(h[n],0),h[n]=Math.min(s,Math.pow(h[n],2.4))*r)},LUTGammaOOTFPQ.prototype.linFromD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724;i?this.linFromL(t,i):this.linFromL(t)},LUTGammaOOTFPQ.prototype.linFromL=function(t,i){var a,s=new Float64Array(t),h=s.length,o=this.s;a=i&&i.out?this.eO:this.eI;for(var r=0;r<h;r++)s[r]<=a?s[r]=0:(s[r]=Math.pow(s[r]/o,1/2.4),s[r]>.080994816?s[r]=Math.pow((s[r]+.099)/1.099,1/.45)/59.5208:s[r]/=267.84,s[r]*=100)},LUTGammaOOTFPQ.prototype.linToData=function(t,i){return i?.85630498533724*this.linToLegal(t)+.06256109481916:.85630498533724*this.linToLegal(t,i)+.06256109481916},LUTGammaOOTFPQ.prototype.linToLegal=function(t,i){var a,s;return i&&i.rec?(a=this.eI,s=this.LwI/100):(a=this.eO,s=this.LwO/100),t<0?a:(t=(t/=100)>3024e-7?1.099*Math.pow(59.5208*t,.45)-.099:267.84*Math.max(t,0),Math.min(s,Math.pow(t,2.4))*this.s)},LUTGammaOOTFPQ.prototype.linFromData=function(t,i){return i?this.linFromLegal((t-.06256109481916)/.85630498533724,i):this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaOOTFPQ.prototype.linFromLegal=function(t,i){return i&&i.out?e=this.eO:e=this.eI,t<=e?0:((t=Math.pow(t/this.s,1/2.4))>.080994816?t=Math.pow((t+.099)/1.099,1/.45)/59.5208:t/=267.84,100*t)},LUTGammaOOTFHLG.prototype.setBBC=function(t,i){this.nbI=t?2.821251498:1;var a=!1;return this.nbO&&(a=this.nbO),this.nbO=i?2.821251498:1,!(!a||a===this.nbO)},LUTGammaOOTFHLG.prototype.setLw=function(t,i,a,s){this.LwI=t;var h=!1;return i!==this.LwO&&(h=!0),this.LwO=i,"number"==typeof a?(this.LbI=a,"number"==typeof s&&(s!==this.LbO&&(h=!0),this.LbO=s)):(this.LbI=0,this.LbO=0),this.gI=1.2+.42*Math.log(this.LwI/1e3)/Math.LN10,this.aI=(this.LwI-this.LbI)/Math.pow(12,this.gI),this.bI=this.LbI,this.gO=1.2+.42*Math.log(this.LwO/1e3)/Math.LN10,this.aO=(this.LwO-this.LbO)/Math.pow(12,this.gO),this.bO=this.LbO,h},LUTGammaOOTFHLG.prototype.changeISO=function(t){this.iso=t},LUTGammaOOTFHLG.prototype.changeContrast=function(t,i){},LUTGammaOOTFHLG.prototype.changeRange=function(t,i){},LUTGammaOOTFHLG.prototype.linToD=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToL(t,i):this.linToL(t);for(var h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaOOTFHLG.prototype.linToL=function(t,i){var a,s,h,o,r,n,m=new Float64Array(t),e=m.length;if(i&&i.rec?(a=this.gI,s=this.aI,h=this.bI,o=this.nbI,r=this.s,n=this.LwI*this.s):(a=this.gO,s=this.aO,h=this.bO,o=this.nbO,r=this.s,n=this.LwO*this.s),i&&i.rgb)for(var p,l=0;l<e;l+=3)m[l]=Math.max(0,m[l])*o,m[l+1]=Math.max(0,m[l+1])*o,m[l+2]=Math.max(0,m[l+2])*o,p=.2627*m[l]+.678*m[l+1]+.0593*m[l+2],m[l]=Math.min(n,(s*Math.pow(p,a-1)*m[l]+h)*r),m[l+1]=Math.min(n,(s*Math.pow(p,a-1)*m[l+1]+h)*r),m[l+2]=Math.min(n,(s*Math.pow(p,a-1)*m[l+2]+h)*r);else for(l=0;l<e;l++)m[l]=Math.min(n,(s*Math.pow(Math.max(0,m[l]*o),a)+h)*r)},LUTGammaOOTFHLG.prototype.linFromD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724;i?this.linFromL(t,i):this.linFromL(t)},LUTGammaOOTFHLG.prototype.linFromL=function(t,i){var h=new Float64Array(t),o=h.length;if(i&&i.out?(g=this.gO,a=this.aO,b=this.bO,nb=this.nbO,s=this.s):(g=this.gI,a=this.aI,b=this.bI,nb=this.nbI,s=this.s),i&&i.rgb)for(var r,n=0;n<o;n+=3)r=.2627*h[n]+.678*h[n+1]+.0593*h[n+2],r=Math.pow(Math.max(0,r/s-b)/a,(1-g)/g)/(a*nb),h[n]=r*(h[n]/s-b),h[n+1]=r*(h[n+1]/s-b),h[n+2]=r*(h[n+2]/s-b);else for(n=0;n<o;n++)h[n]=Math.pow(Math.max(0,h[n]/s-b)/a,1/g)/nb},LUTGammaOOTFHLG.prototype.linToData=function(t,i){return i?.85630498533724*this.linToLegal(t,i)+.06256109481916:.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaOOTFHLG.prototype.linToLegal=function(t,i){return i&&i.rec?Math.min(this.s*this.LwI,(this.aI*Math.pow(Math.max(0,t*this.nbI),this.gI)+this.bI)*this.s):Math.min(this.s*this.LwO,(this.aO*Math.pow(Math.max(0,t*this.nbO),this.gO)+this.bO)*this.s)},LUTGammaOOTFHLG.prototype.linFromData=function(t,i){return i?this.linFromLegal((t-.06256109481916)/.85630498533724,i):this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaOOTFHLG.prototype.linFromLegal=function(t,i){return i&&i.out?Math.pow(Math.max(0,t/this.s-this.bO)/this.aO,1/this.gO)/this.nbO:Math.pow(Math.max(0,t/this.s-this.bI)/this.aI,1/this.gI)/this.nbI},LUTGammaOOTFNone.prototype.setLw=function(t,i){this.LwI=t;var a=!1;return i!==this.LwO&&(a=!0),this.LwO=i,a},LUTGammaOOTFNone.prototype.changeISO=function(t){this.iso=t},LUTGammaOOTFNone.prototype.changeContrast=function(t,i){},LUTGammaOOTFNone.prototype.changeRange=function(t,i){},LUTGammaOOTFNone.prototype.linToD=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToL(t,i):this.linToL(t);for(var h=0;h<s;h++)a[h]=.85630498533724*a[h]+.06256109481916},LUTGammaOOTFNone.prototype.linToL=function(t,i){var a,s=new Float64Array(t),h=s.length;a=i&&i.rec?this.LwI:this.LwO;for(var o=0;o<h;o++)s[o]=Math.min(100*s[o],a)},LUTGammaOOTFNone.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]/100-.06256109481916)/.85630498533724},LUTGammaOOTFNone.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=i[s]/100},LUTGammaOOTFNone.prototype.linToData=function(t,i){return i?.85630498533724*this.linToLegal(t,i)+.06256109481916:.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaOOTFNone.prototype.linToLegal=function(t,i){return i&&i.rec?Math.min(100*t,this.LwI):Math.min(100*t,this.LwO)},LUTGammaOOTFNone.prototype.linFromData=function(t){return this.linFromLegal((t/100-.06256109481916)/.85630498533724)},LUTGammaOOTFNone.prototype.linFromLegal=function(t){return t/100},LUTGammaITUProp.prototype.setM=function(t){this.m=t,this.n=.494685*Math.pow(t,.45),this.r=1.0993*Math.pow(t,.45)*(1-.45*Math.log(t))-.0993,this.e=this.linToLegal(t)},LUTGammaITUProp.prototype.changeISO=function(t){this.iso=t},LUTGammaITUProp.prototype.changeContrast=function(t,i){},LUTGammaITUProp.prototype.changeRange=function(t,i){},LUTGammaITUProp.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaITUProp.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.m?i[s]=this.n*Math.log(i[s])+this.r:i[s]>=.0181?i[s]=1.0993*Math.pow(i[s],.45)-.0993:i[s]=4.5*i[s]},LUTGammaITUProp.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaITUProp.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.e?i[s]=Math.exp((i[s]-this.r)/this.n):i[s]>=.08145?i[s]=Math.pow((i[s]+.0993)/1.0993,1/.45):i[s]=i[s]/4.5},LUTGammaITUProp.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaITUProp.prototype.linToLegal=function(t){return t>this.m?this.n*Math.log(t)+this.r:t>=.0181?1.0993*Math.pow(t,.45)-.0993:4.5*t},LUTGammaITUProp.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaITUProp.prototype.linFromLegal=function(t){return t>this.e?Math.exp((t-this.r)/this.n):t>=.08145?Math.pow((t+.0993)/1.0993,1/.45):t/4.5},LUTGammaBBC283.prototype.setM=function(t){this.m=t,this.n=Math.sqrt(t)/2,this.r=Math.sqrt(t)*(1-Math.log(Math.sqrt(t))),this.e=this.linToLegal(t)},LUTGammaBBC283.prototype.setS=function(t){this.s=t},LUTGammaBBC283.prototype.changeISO=function(t){this.iso=t},LUTGammaBBC283.prototype.changeContrast=function(t,i){},LUTGammaBBC283.prototype.changeRange=function(t,i){},LUTGammaBBC283.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaBBC283.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.m?i[s]=this.n*Math.log(i[s])+this.r:i[s]>0?i[s]=Math.sqrt(i[s]):i[s]=0},LUTGammaBBC283.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaBBC283.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>this.e?i[s]=Math.exp(this.s*(i[s]-this.r)/this.n):i[s]=Math.pow(i[s],2*this.s)},LUTGammaBBC283.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaBBC283.prototype.linToLegal=function(t){return t>this.m?this.n*Math.log(t)+this.r:t>0?Math.sqrt(t):0},LUTGammaBBC283.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaBBC283.prototype.linFromLegal=function(t){return t>this.e?Math.exp(this.s*(t-this.r)/this.n):Math.pow(t,2*this.s)},LUTGammaACEScc.prototype.changeISO=function(t){this.iso=t},LUTGammaACEScc.prototype.changeContrast=function(t,i){},LUTGammaACEScc.prototype.changeRange=function(t,i){},LUTGammaACEScc.prototype.linToL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<0?i[s]=this.m:i[s]<this.low/.9?i[s]=(Math.log(Math.pow(2,-16)+.45*i[s])/Math.log(2)+9.72)/17.52:i[s]=(Math.log(.9*i[s])/Math.log(2)+9.72)/17.52},LUTGammaACEScc.prototype.linToD=function(t){var i=new Float64Array(t),a=i.length;this.linToL(t);for(var s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaACEScc.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724;this.linFromL(t)},LUTGammaACEScc.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<this.low2?i[s]=2*(Math.pow(2,17.52*i[s]-9.72)-Math.pow(2,-16))/.9:i[s]<this.mid?i[s]=Math.pow(2,17.52*i[s]-9.72)/.9:i[s]=65504/.9},LUTGammaACEScc.prototype.linToData=function(t){return.85630498533724*this.linToLegal(t)+.06256109481916},LUTGammaACEScc.prototype.linToLegal=function(t){return t<0?this.m:t<this.low/.9?(Math.log(Math.pow(2,-16)+.45*t)/Math.log(2)+9.72)/17.52:(Math.log(.9*t)/Math.log(2)+9.72)/17.52},LUTGammaACEScc.prototype.linFromData=function(t){return this.linFromLegal((t-.06256109481916)/.85630498533724)},LUTGammaACEScc.prototype.linFromLegal=function(t){return t<this.low2?2*(Math.pow(2,17.52*t-9.72)-Math.pow(2,-16))/.9:t<this.mid?Math.pow(2,17.52*t-9.72)/.9:65504/.9},LUTGammaACESProxy.prototype.changeISO=function(t){this.iso=t},LUTGammaACESProxy.prototype.changeContrast=function(t,i){},LUTGammaACESProxy.prototype.changeRange=function(t,i){},LUTGammaACESProxy.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]<=this.low?i[s]=this.blk/this.hi:i[s]=((Math.log(.9*i[s])/Math.log(2)+2.5)*this.mul+this.off)/this.hi},LUTGammaACESProxy.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaACESProxy.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=Math.pow(2,(i[s]*this.hi-this.off)/this.mul-2.5)/.9},LUTGammaACESProxy.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaACESProxy.prototype.linToData=function(t){return t<=this.low?this.blk/this.hi:((Math.log(.9*t)/Math.log(2)+2.5)*this.mul+this.off)/this.hi},LUTGammaACESProxy.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaACESProxy.prototype.linFromData=function(t){return Math.pow(2,(t*this.hi-this.off)/this.mul-2.5)/.9},LUTGammaACESProxy.prototype.linFromLegal=function(t){return.85630498533724*this.linFromData(t)+.06256109481916},LUTGammaGen.prototype.changeISO=function(t){this.iso=t},LUTGammaGen.prototype.changeContrast=function(t,i){},LUTGammaGen.prototype.changeRange=function(t,i){},LUTGammaGen.prototype.linToD=function(t){for(var i,a=new Float64Array(t),s=a.length,h=0;h<s;h++)i=-300,a[h]>0&&(i=Math.log(a[h]/.2)/Math.LN2),a[h]>this.params.top[6]?a[h]=this.params.top[1]+(this.params.top[0]-this.params.top[1])/Math.pow(1+this.params.top[4]*Math.exp(-this.params.top[2]*(i-this.params.top[5])),1/this.params.top[3]):a[h]>this.params.high[6]?a[h]=this.params.high[1]+(this.params.high[0]-this.params.high[1])/Math.pow(1+this.params.high[4]*Math.exp(-this.params.high[2]*(i-this.params.high[5])),1/this.params.high[3]):a[h]>this.params.mid[6]?a[h]=this.params.mid[1]+(this.params.mid[0]-this.params.mid[1])/Math.pow(1+this.params.mid[4]*Math.exp(-this.params.mid[2]*(i-this.params.mid[5])),1/this.params.mid[3]):a[h]>this.params.low[6]?a[h]=this.params.low[1]+(this.params.low[0]-this.params.low[1])/Math.pow(1+this.params.low[4]*Math.exp(-this.params.low[2]*(i-this.params.low[5])),1/this.params.low[3]):a[h]<=0?a[h]=this.params.blk[0]*a[h]+this.params.blk[1]:a[h]=this.params.bot[0]*a[h]+this.params.bot[1]},LUTGammaGen.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaGen.prototype.linToData=function(t){var i=-300;return t>0&&(i=Math.log(t/.2)/Math.LN2),t>this.params.top[6]?this.params.top[1]+(this.params.top[0]-this.params.top[1])/Math.pow(1+this.params.top[4]*Math.exp(-this.params.top[2]*(i-this.params.top[5])),1/this.params.top[3]):t>this.params.high[6]?this.params.high[1]+(this.params.high[0]-this.params.high[1])/Math.pow(1+this.params.high[4]*Math.exp(-this.params.high[2]*(i-this.params.high[5])),1/this.params.high[3]):t>this.params.mid[6]?this.params.mid[1]+(this.params.mid[0]-this.params.mid[1])/Math.pow(1+this.params.mid[4]*Math.exp(-this.params.mid[2]*(i-this.params.mid[5])),1/this.params.mid[3]):t>this.params.low[6]?this.params.low[1]+(this.params.low[0]-this.params.low[1])/Math.pow(1+this.params.low[4]*Math.exp(-this.params.low[2]*(i-this.params.low[5])),1/this.params.low[3]):t<=0?this.params.blk[0]*t+this.params.blk[1]:this.params.bot[0]*t+this.params.bot[1]},LUTGammaGen.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLUTSL3.prototype.changeISO=function(t){this.iso=t},LUTGammaLUTSL3.prototype.changeContrast=function(t,i){},LUTGammaLUTSL3.prototype.changeRange=function(t,i){},LUTGammaLUTSL3.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=.0125?i[s]=.255620723*Math.log(4.736842106*i[s]+.052631579)/Math.LN10+.410557185:i[s]=(i[s]+.015581884)/.167792292;this.lut.FCub(t)},LUTGammaLUTSL3.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLUTSL3.prototype.linToData=function(t){return t>=.0125?this.lut.fCub(.255620723*Math.log(4.736842106*t+.052631579)/Math.LN10+.410557185):this.lut.fCub((t+.015581884)/.167792292)},LUTGammaLUTSL3.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLUTSimple.prototype.changeISO=function(t){this.iso=t},LUTGammaLUTSimple.prototype.changeContrast=function(t,i){},LUTGammaLUTSimple.prototype.changeRange=function(t,i){},LUTGammaLUTSimple.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=this.log,h=0;h<a;h++)i[h]>=0?i[h]=(Math.log(i[h]*s[0]+s[1])/Math.LN10-s[3])/s[2]:i[h]=i[h]*s[4];this.spline.FCub(t)},LUTGammaLUTSimple.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLUTSimple.prototype.linToData=function(t){return t>=0?t=(Math.log(t*this.log[0]+this.log[1])/Math.LN10-this.log[3])/this.log[2]:t*=this.log[4],this.spline.f(t)},LUTGammaLUTSimple.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaIOLUT.prototype.changeISO=function(t){this.iso=t},LUTGammaIOLUT.prototype.changeContrast=function(t,i){},LUTGammaIOLUT.prototype.changeRange=function(t,i){},LUTGammaIOLUT.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=.0125?i[s]=.255620723*Math.log(4.736842106*i[s]+.052631579)/Math.LN10+.410557185:i[s]=(i[s]+.015581884)/.167792292;this.out.FCub(t)},LUTGammaIOLUT.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaIOLUT.prototype.linFromD=function(t){var i=new Float64Array(t),a=i.length;this.rec.FCub(t);for(var s=0;s<a;s++)i[s]>=.167360992?i[s]=(Math.pow(10,(i[s]-.410557185)/.255620723)-.052631579)/4.736842106:i[s]=.167792292*i[s]-.015581884},LUTGammaIOLUT.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaIOLUT.prototype.linToData=function(t){return t>=.0125?this.out.f(.255620723*Math.log(4.736842106*t+.052631579)/Math.LN10+.410557185):this.out.f((t+.015581884)/.167792292)},LUTGammaIOLUT.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaIOLUT.prototype.linFromData=function(t){var i=this.rec.f(t);return i>=.167360992?(Math.pow(10,(i-.410557185)/.255620723)-.052631579)/4.736842106:.167792292*i-.015581884},LUTGammaIOLUT.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaDLog.prototype.loadLUTs=function(){this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.027013881,.059898339,.090088157,.118437528,.145610746,.172169533,.198613763,.227521773,.262056586,.302175407,.34492969,.385399436,.424651585,.467275042,.510407243,.552759914,.592749573,.629826127,.664057729,.695758476,.725291386,.752991781,.779146345,.803993306,.827729079,.850515908,.872488687,.893760574,.914427454]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.12885289,.15885059,.19144138,.226199875,.262466189,.299384828,.334847065,.364688823,.390416782,.413838603,.436630643,.46037471,.486584362,.509543387,.532318837,.554970585,.57771412,.601166982,.625811624,.652038025,.680152405,.710384832,.742896012,.777783434,.815087031,.854794442,.896845964,.941139238,.987533704,1.035854869,1.085898383,1.137433963]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.031210281,.068285973,.101551761,.132158936,.160893656,.188302321,.215465805,.245787053,.279449722,.315427111,.351812097,.386609889,.423110071,.460310688,.49840922,.53710835,.575293346,.61215979,.647304693,.680626751,.712198291,.742171033,.770721576,.798024375,.824240266,.849512889,.873968764,.897718877,.920860756]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.125031422,.151121007,.179907158,.21124056,.244837237,.280317645,.316069712,.347826102,.376601031,.403745563,.430511022,.458076706,.487569716,.512232259,.538212324,.563787753,.589013066,.614435086,.640476557,.667481773,.695724061,.725412299,.756696709,.789674087,.824392599,.860856239,.899029,.938838816,.980181311,1.022923372,1.066906563,1.111950408]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.031210281,.083971133,.121494403,.154287516,.183562707,.210419428,.238243695,.267538992,.297983064,.32913085,.360463177,.391461448,.421734685,.453519587,.485544904,.518128718,.551268321,.584699085,.61821976,.651668307,.684925468,.717912965,.750588498,.78293948,.814976874,.846729853,.878241601,.909566273,.940767026]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.119702232,.140380917,.163951817,.190659752,.220743195,.254458113,.290796984,.325213901,.357945224,.389621678,.420821249,.452083233,.483918385,.515547815,.546123016,.576458327,.606169418,.635519362,.664689059,.693824954,.723042483,.752429059,.782046706,.811934418,.842110312,.872573607,.903306472,.934275751,.965434601,.996724043,1.028074436,1.059406888]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.050605212,.101847391,.141801367,.174553642,.202322185,.22874131,.255482461,.28250488,.309772209,.337252216,.364916477,.392740043,.420701103,.44878065,.476962175,.505497001,.534850524,.564998669,.59599196,.62788934,.660759718,.694683955,.729757441,.766093505,.803827992,.843125543,.884188395,.927269068,.972689245]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.115301511,.13149171,.150709282,.173520311,.200596729,.232736113,.269479213,.306121311,.342305347,.378112298,.41360763,.448844624,.483866883,.518710261,.553404354,.587806017,.621210936,.653692164,.685268931,.715957019,.745769397,.77471673,.802807792,.830049806,.856448717,.882009423,.906735956,.930631637,.9536992,.975940896,.997358579,1.017953772]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.065301918,.122898589,.163791157,.195392233,.222619063,.249062283,.274879392,.300175737,.325037946,.349539312,.373743447,.39770684,.419269569,.442890208,.46719661,.492246446,.5186057,.546354484,.575623809,.606564753,.639352843,.67419386,.711331721,.751059159,.793733115,.839797302,.889816948,.944534957,1.004968521]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.111565815,.123773786,.138880449,.157644772,.181032868,.210267605,.245497324,.282372766,.320314165,.359178573,.398828899,.439131472,.47995439,.524196873,.564466885,.603106531,.639442649,.673698044,.706021768,.736548095,.765398416,.792682782,.818501185,.84294462,.866095988,.888030858,.908818132,.928520624,.947195571,.964895085,.981666562,.997553059]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.087126998,.14748523,.186008431,.215075483,.241476046,.266270946,.289822865,.312379852,.334121161,.355181885,.375667304,.395661748,.417935416,.437180913,.457332473,.478483044,.500910514,.525100922,.551252839,.579695788,.610846553,.645240993,.683580724,.726803064,.776188158,.83352692,.901392061,.983599666,1.086113055]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.108032367,.116457848,.127644377,.14254077,.162414978,.188948062,.222967563,.260543566,.300956216,.343919729,.389172406,.436469467,.485577963,.531756384,.579562028,.623777205,.663826544,.700184042,.733216025,.763252327,.790590503,.815499305,.838221588,.858976768,.87796295,.895358767,.911325024,.926006149,.939531523,.952016681,.963564429,.974265872]).buffer)),this.rec.push(new LUTQSpline(new Float64Array([-.25407191,-.175972281,-.097872652,-.019773024,.116722074,.172097954,.205648193,.232954536,.257670154,.280585291,.302163456,.322705091,.342418861,.361457313,.379936505,.397947655,.417231908,.434077046,.451785726,.470466477,.490260298,.511730454,.535127682,.560854029,.589456615,.621707867,.658750465,.702381845,.755678207,.824596336,.923217546,1.100371354,1.772368213]).buffer)),this.out.push(new LUTQSpline(new Float64Array([.101661779,.104692578,.10957075,.11711386,.12845072,.145121036,.169194945,.20204223,.240018043,.282187099,.328050167,.377151866,.429068134,.483397275,.537416608,.590950346,.639494073,.682513621,.720644883,.754394462,.784219764,.81053462,.83371391,.854097428,.871993164,.887680123,.901410791,.91341331,.923893425,.933036256,.941007907,.947956957,.954015838]).buffer)),this.log[0]=5/Math.pow(2,this.clip),this.log[1]=this.loggy/this.clip,this.log[2]=(Math.log(1+this.log[1])-Math.log(this.log[1]))/Math.LN10,this.log[3]=Math.log(this.log[1])/Math.LN10,this.log[4]=this.log[0]/(this.log[1]*this.log[2]*Math.LN10),this.log[5]=this.out[this.reccon].f(0)},LUTGammaDLog.prototype.changeISO=function(t){this.iso=t},LUTGammaDLog.prototype.changeContrast=function(t,i){this.reccon=t+3,this.outcon=i+3},LUTGammaDLog.prototype.changeRange=function(t,i){},LUTGammaDLog.prototype.linToD=function(t,i){for(var a=new Float64Array(t),s=a.length,h=this.log,o=0;o<s;o++)a[o]>=0?a[o]=(Math.log(a[o]*h[0]+h[1])/Math.LN10-h[3])/h[2]:a[o]=a[o]*h[4];i&&i.rec?this.out[this.reccon].FCub(t):this.out[this.outcon].FCub(t)},LUTGammaDLog.prototype.linToL=function(t,i){var a=new Float64Array(t),s=a.length;i?this.linToD(t,i):this.linToD(t);for(var h=0;h<s;h++)a[h]=(a[h]-.06256109481916)/.85630498533724},LUTGammaDLog.prototype.linFromD=function(t){var i=new Float64Array(t),a=i.length,s=this.log;this.rec[this.reccon].FCub(t);for(var h=0;h<a;h++)i[h]>=s[5]?i[h]=(Math.pow(10,i[h]*s[2]+s[3])-s[1])/s[0]:i[h]=i[h]/s[4]},LUTGammaDLog.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaDLog.prototype.linToData=function(t,i){return i&&i.rec?t>=0?this.out[this.reccon].f((Math.log(t*this.log[0]+this.log[1])/Math.LN10-this.log[3])/this.log[2]):this.out[this.reccon].f(t*this.log[4]):t>=0?this.out[this.outcon].f((Math.log(t*this.log[0]+this.log[1])/Math.LN10-this.log[3])/this.log[2]):this.out[this.outcon].f(t*this.log[4])},LUTGammaDLog.prototype.linToLegal=function(t,i){return i?(this.linToData(t,i)-.06256109481916)/.85630498533724:(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaDLog.prototype.linFromData=function(t){var i=this.rec[this.reccon].f(t);return i>=this.log[5]?(Math.pow(10,i*this.log[2]+this.log[3])-this.log[1])/this.log[0]:i/this.log[4]},LUTGammaDLog.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaLA.prototype.setLUT=function(t){this.lut=this.lutMaker.newLUT({title:t.title,format:t.format,dims:t.dims,s:t.s,min:[t.min[0],t.min[1],t.min[2]],max:[t.max[0],t.max[1],t.max[2]],C:t.C}),this.rev=this.lutMaker.newLUT({title:t.title,format:t.format,dims:t.dims,s:t.sr,min:[t.minR[0],t.minR[1],t.minR[2]],max:[t.maxR[0],t.maxR[1],t.maxR[2]],C:t.R})},LUTGammaLA.prototype.setTitle=function(t){this.name=t},LUTGammaLA.prototype.changeISO=function(t){this.iso=t},LUTGammaLA.prototype.changeContrast=function(t,i){},LUTGammaLA.prototype.changeRange=function(t,i){},LUTGammaLA.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]>=.0125?i[s]=.255620723*Math.log(4.736842106*i[s]+.052631579)/Math.LN10+.410557185:i[s]=(i[s]+.015581884)/.167792292;this.lut.FCub(t)},LUTGammaLA.prototype.linToL=function(t){var i=new Float64Array(t),a=i.length;this.linToD(t);for(var s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaLA.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=this.rev.fCub(i[s]),i[s]>=.167360992?i[s]=(Math.pow(10,(i[s]-.410557185)/.255620723)-.052631579)/4.736842106:i[s]=.167792292*i[s]-.015581884},LUTGammaLA.prototype.linFromL=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916;this.linFromD(t)},LUTGammaLA.prototype.linToData=function(t){return t>=.0125?this.lut.fCub(.255620723*Math.log(4.736842106*t+.052631579)/Math.LN10+.410557185):this.lut.fCub((t+.015581884)/.167792292)},LUTGammaLA.prototype.linToLegal=function(t){return(this.linToData(t)-.06256109481916)/.85630498533724},LUTGammaLA.prototype.linFromData=function(t){return(t=this.rev.fCub(t))>=.167360992?(Math.pow(10,(t-.410557185)/.255620723)-.052631579)/4.736842106:.167792292*t-.015581884},LUTGammaLA.prototype.linFromLegal=function(t){return this.linFromData(.85630498533724*t+.06256109481916)},LUTGammaNull.prototype.changeISO=function(t){this.iso=t},LUTGammaNull.prototype.changeContrast=function(t,i){},LUTGammaNull.prototype.changeRange=function(t,i){},LUTGammaNull.prototype.linToD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=.85630498533724*i[s]+.06256109481916},LUTGammaNull.prototype.linToL=function(t){},LUTGammaNull.prototype.linFromD=function(t){for(var i=new Float64Array(t),a=i.length,s=0;s<a;s++)i[s]=(i[s]-.06256109481916)/.85630498533724},LUTGammaNull.prototype.linFromL=function(t){},LUTGammaNull.prototype.linToData=function(t){return.85630498533724*t+.06256109481916},LUTGammaNull.prototype.linToLegal=function(t){return t},LUTGammaNull.prototype.linFromData=function(t){return(t-.06256109481916)/.85630498533724},LUTGammaNull.prototype.linFromLegal=function(t){return t},LUTGamma.prototype.setParams=function(t){var i={t:20,v:this.ver,changedGamma:!1};if("number"!=typeof t.v)return i.err=!0,i.details="Missing version no.",i;if("number"==typeof t.inGamma&&(9999!==t.inGamma?(t.inGamma!==this.curIn&&(i.changedGamma=!0),this.curIn=t.inGamma,i.inGamma=this.curIn):"number"==typeof t.inLinGamma&&(t.inLinGamma!==this.curIn&&(i.changedGamma=!0),this.curIn=t.inLinGamma,i.inLinGamma=this.curIn)),this.changedOut=!1,"number"==typeof t.outGamma&&(9999!==t.outGamma?(t.outGamma!==this.curOut&&(i.changedGamma=!0,this.changedOut=!0),this.curOut=t.outGamma,i.outGamma=this.curOut,3===this.gammas[this.curOut].cat?this.nul=!0:this.nul=!1):"number"==typeof t.outLinGamma&&(t.outLinGamma!==this.curOut&&(i.changedGamma=!0,this.changedOut=!0),this.curOut=t.outLinGamma,i.outLinGamma=this.curOut,this.nul=!1)),"number"==typeof t.defGamma){for(var a=this.gammas.length,s=0;s<a;s++)if(defGamma==this.gammas[s].name){this.curIn=s;break}this.eiMult=Math.pow(2,this.stopShift)}if(void 0!==t.contrast&&"number"==typeof t.contrast.rec&&"number"==typeof t.contrast.out&&this.gammas[this.DLogM].changeContrast(t.contrast.rec,t.contrast.out),"boolean"==typeof t.arriLegalIn&&"boolean"==typeof t.arriLegalOut)for(a=this.arriIdxList.length,s=0;s<a;s++)this.gammas[this.arriIdxList[s]].changeRange(t.arriLegalIn,t.arriLegalOut);if("number"==typeof t.newISO){for(a=this.gammas.length,s=0;s<a;s++)this.gammas[s].changeISO(t.newISO);"number"==typeof t.natISO&&"number"==typeof t.camType&&0===t.camType&&(this.eiMult=t.newISO/t.natISO)}if("number"==typeof t.stopShift&&(this.eiMult=Math.pow(2,t.stopShift)),i.eiMult=this.eiMult,"number"==typeof t.camClip&&(this.camClip=t.camClip),"boolean"==typeof t.inL&&(this.inL=t.inL),"boolean"==typeof t.outL&&(this.outL=t.outL),"boolean"==typeof t.scaleCheck&&t.scaleCheck&&"number"==typeof t.scaleMin&&"number"==typeof t.scaleMax?(this.sMin=t.scaleMin,this.sMax=t.scaleMax,0!==this.sMin||1!==this.sMax?this.sIn=!0:this.sIn=!1):(this.sMin=0,this.sMax=1,this.sIn=!1),this.curOut===this.PQ||this.curOut===this.PQ+1||this.curOut===this.pqEOTFIdx?this.hdrOut=!0:this.hdrOut=!1,this.changedHDR=!1,"boolean"==typeof t.hlgBBCIn&&"boolean"==typeof t.hlgBBCOut&&(this.gammas[this.HLG].setBBC(t.hlgBBCIn,t.hlgBBCOut),this.hlgOOTF.setBBC(t.hlgBBCIn,t.hlgBBCOut)&&(this.changedHDR=!0),this.hlgOOTFNorm.setBBC(t.hlgBBCIn,t.hlgBBCOut),this.gammas[this.PQ+1].setLw()),"number"==typeof t.pqLwIn&&"number"==typeof t.pqLwOut&&(this.pqOOTF.setLw(t.pqLwIn,t.pqLwOut)&&(this.changedHDR=!0),this.pqOOTFNorm.setLw(t.pqLwIn,t.pqLwOut),this.gammas[this.PQ].setLw()),"number"==typeof t.pqEOTFLwIn&&"number"==typeof t.pqEOTFLwOut&&(this.pqNoOOTF.setLw(t.pqEOTFLwIn,t.pqEOTFLwOut)&&(this.changedHDR=!0),this.gammas[this.pqEOTFIdx].setLw()),"number"==typeof t.hlgLwIn&&"number"==typeof t.hlgLwOut&&(this.hlgOOTF.setLw(t.hlgLwIn,t.hlgLwOut)&&(this.changedHDR=!0),this.hlgOOTFNorm.setLw(t.hlgLwIn,t.hlgLwOut),this.gammas[this.PQ+1].setLw()),"number"==typeof t.clipSelect){switch(t.clipSelect){case 0:this.clipB=!1,this.clipW=!1,this.clip=!1;break;case 1:this.clipB=!0,this.clipW=!0,this.clip=!0;break;case 2:this.clipB=!0,this.clipW=!1,this.clip=!0;break;case 3:this.clipB=!1,this.clipW=!0,this.clip=!0}i.clipSelect=t.clipSelect}return"boolean"==typeof t.clipLegal&&(this.clipL=t.clipLegal,i.clipLegal=this.clipL),"number"==typeof t.bClip&&(this.bClip=t.bClip,this.wClip=t.wClip),"boolean"==typeof t.tweaks?this.tweaks=t.tweaks:this.tweaks=!1,i.twkASCCDL=this.setASCCDL(t),i.twkKnee=this.setKnee(t),i.twkBlkHi=this.setBlkHi(t),i.twkBlkGam=this.setBlkGam(t),i.twkDisplay=this.setDisplay(t),"boolean"==typeof t.isTrans&&(this.isTrans=t.isTrans),this.ver=t.v,i.v=this.ver,i},LUTGamma.prototype.oneDCalc=function(t,i,a){var s={p:t,t:i+20,v:this.ver,start:a.start,vals:a.vals,dim:a.dim},h=this.eiMult;"number"==typeof a.eiMult&&(h=a.eiMult);var o,r=a.start,n=a.vals,m=new Float64Array(3*n),e=m.buffer,p=a.dim-1;if(this.nul)for(var l=0;l<n;l++)o=(r+l)/p,this.sIn&&(o=o*(this.sMax-this.sMin)+this.sMin),this.inL?m[3*l]=o:m[3*l]=(1023*o-64)/876,m[3*l+1]=m[3*l],m[3*l+2]=m[3*l];else{for(l=0;l<n;l++)o=(r+l)/p,this.sIn&&(o=o*(this.sMax-this.sMin)+this.sMin),this.inL?m[3*l]=this.gammas[this.curIn].linFromLegal(o)*h:m[3*l]=this.gammas[this.curIn].linFromData(o)*h,m[3*l+1]=m[3*l],m[3*l+2]=m[3*l];this.doASCCDL&&this.ASCCDLOut(e),this.doKnee?this.kneeOut(e):this.gammas[this.curOut].linToL(e),this.doBlkHi&&this.blkHiOut(e),this.doBlkGam&&this.blkGamOut(e),this.doDisplay&&this.displayOut(e)}return this.finalOut(e,!1),s.o=m.buffer,s.to=["o"],s},LUTGamma.prototype.laCalcRGB=function(t,i,a){for(var s,h=a.dim,o=h-1,r=new Float64Array(h*h*h*3),n=r.buffer,m=0,e=0;e<h;e++)for(var p=0;p<h;p++)for(var l=0;l<h;l++)r[m]=l/o,r[m+1]=p/o,r[m+2]=e/o,m+=3;switch(this.gammas[a.gamma].name){case"S-Log3":s=0;break;case"S-Log2":s=1;break;case"S-Log":s=2;break;case"C-Log":s=3;break;case"Canon C-Log2":s=4;break;case"Panasonic V-Log":s=5;break;case"REDLogFilm":s=6;break;case"Cineon":s=7;break;case"LogC (Sup 3.x & 4.x)":s=8;break;case"LogC (Sup 2.x)":s=9;break;default:a.legIn?(this.gammas[this.SL3Idx].linFromL(n,{rgb:!0}),this.gammas[a.gamma].linToL(n,{rgb:!0,rec:!0})):(this.gammas[this.SL3Idx].linFromD(n,{rgb:!0}),this.gammas[a.gamma].linToD(n,{rgb:!0,rec:!0})),s=0}var u={p:t,t:i+20,v:this.ver};return u.dim=a.dim,u.legIn=a.legIn,u.gamma=a.gamma,u.gamut=a.gamut,u.natTF=s,u.o=n,u.to=["o"],u},LUTGamma.prototype.inCalcRGB=function(t,i,a){var s=this.eiMult;"number"==typeof a.eiMult&&(s=a.eiMult);var h={p:t,t:i+20,v:this.ver,R:a.R,G:a.G,B:a.B,vals:a.vals,dim:a.dim,eiMult:s},o=a.B,r=a.dim,n=new Float64Array(3*a.vals),m=a.dim-1;if(this.nul)if(this.inL)if(this.outL)for(var e=0;e<r;e++)for(var p=0;p<r;p++){var l=3*(p+e*r);this.sIn?(n[3*l]=p/m*(this.sMax-this.sMin)+this.sMin,n[3*l+1]=e/m*(this.sMax-this.sMin)+this.sMin,n[3*l+2]=o/m*(this.sMax-this.sMin)+this.sMin):(n[3*l]=p/m,n[3*l+1]=e/m,n[3*l+2]=o/m)}else for(e=0;e<r;e++)for(p=0;p<r;p++){l=3*(p+e*r);this.sIn?(n[l]=(876*(p/m*(this.sMax-this.sMin)+this.sMin)+64)/1023,n[l+1]=(876*(e/m*(this.sMax-this.sMin)+this.sMin)+64)/1023,n[l+2]=(876*(o/m*(this.sMax-this.sMin)+this.sMin)+64)/1023):(n[l]=(p/m*876+64)/1023,n[l+1]=(e/m*876+64)/1023,n[l+2]=(o/m*876+64)/1023)}else if(this.outL)for(e=0;e<r;e++)for(p=0;p<r;p++){l=3*(p+e*r);this.sIn?(n[l]=(1023*(p/m*(this.sMax-this.sMin)+this.sMin)-64)/876,n[l+1]=(1023*(e/m*(this.sMax-this.sMin)+this.sMin)-64)/876,n[l+2]=(1023*(o/m*(this.sMax-this.sMin)+this.sMin)-64)/876):(n[l]=(1023*p/m-64)/876,n[l+1]=(1023*e/m-64)/876,n[l+2]=(1023*o/m-64)/876)}else for(e=0;e<r;e++)for(p=0;p<r;p++){l=3*(p+e*r);this.sIn?(n[l]=p/m*(this.sMax-this.sMin)+this.sMin,n[l+1]=e/m*(this.sMax-this.sMin)+this.sMin,n[l+2]=o/m*(this.sMax-this.sMin)+this.sMin):(n[l]=p/m,n[l+1]=e/m,n[l+2]=o/m)}else if(this.inL){for(e=0;e<r;e++)for(p=0;p<r;p++){l=3*(p+e*r);this.sIn?(n[l]=p/m*(this.sMax-this.sMin)+this.sMin,n[l+1]=e/m*(this.sMax-this.sMin)+this.sMin,n[l+2]=o/m*(this.sMax-this.sMin)+this.sMin):(n[l]=p/m,n[l+1]=e/m,n[l+2]=o/m)}this.gammas[this.curIn].linFromL(n.buffer,{rgb:!0})}else{for(e=0;e<r;e++)for(p=0;p<r;p++){l=3*(p+e*r);this.sIn?(n[l]=p/m*(this.sMax-this.sMin)+this.sMin,n[l+1]=e/m*(this.sMax-this.sMin)+this.sMin,n[l+2]=o/m*(this.sMax-this.sMin)+this.sMin):(n[l]=p/m,n[l+1]=e/m,n[l+2]=o/m)}this.gammas[this.curIn].linFromD(n.buffer,{rgb:!0})}return h.o=n.buffer,h.to=["o"],h},LUTGamma.prototype.outCalcRGB=function(t,i,a){var s={p:t,t:i+20,v:this.ver,R:a.R,G:a.G,B:a.B,vals:a.vals,dim:a.dim},h=new Float64Array(a.o);h.length;return this.nul||(this.doKnee?this.kneeOut(a.o):this.gammas[this.curOut].linToL(a.o,{rgb:!0}),this.doBlkHi&&this.blkHiOut(a.o),this.doBlkGam&&this.blkGamOut(a.o),this.doDisplay&&this.displayOut(a.o,{rgb:!0}),a.doGamutLim&&this.gamutLimOut(a.o,a.gLimY,a.gLimL,a.og,a.gLimB),a.doFC&&this.fcOut(a.fc,a.o)),"boolean"==typeof a.cb?this.finalOut(a.o,a.cb):this.finalOut(a.o,!1),s.o=h.buffer,s.to=["o"],s},LUTGamma.prototype.getLists=function(t,i){return{p:t,t:i+20,v:this.ver,inList:this.inList,outList:this.outList,linList:this.linList,disList:this.disList,catList:this.catList,baseGamuts:this.gts,baseDisGamuts:this.disGts,subNames:this.subNames,subList:this.gammaSub,gammaDat:this.gammaDat,gammaExt:this.gammaExt,rec709:this.rec709,PQ:this.PQ,HLG:this.HLG,PQOOTF:this.pqOOTFIdx,PQEOTF:this.pqEOTFIdx,HLGOOTF:this.hlgOOTFIdx,ARRIList:this.arriIdxList,DLogM:this.DLogM,LA:this.LA}},LUTGamma.prototype.setLA=function(t,i,a){return this.gammas[this.LA].setLUT(a),{p:t,t:i+20,v:this.ver,i:a.title}},LUTGamma.prototype.setLATitle=function(t,i,a){return this.gammas[this.LA].setTitle(a),{p:t,t:i+20,v:this.ver,i:a}},LUTGamma.prototype.SL3Val=function(t,i,a){for(var s=a.dim,h=s-1,o=new Float64Array(s),r=o.buffer,n=0;n<s;n++)o[n]=n/h;this.gammas[this.SL3Idx].linFromD(r),a.legIn?this.gammas[a.gamma].linToL(r,{rgb:!1,rec:!0}):this.gammas[a.gamma].linToD(r,{rgb:!1,rec:!0});var m={p:t,t:i+20,v:this.ver,o:r};return m.dim=a.dim,m.legIn=a.legIn,m.gamma=a.gamma,m.to=["o"],m},LUTGamma.prototype.ioNames=function(t,i){var a={};return a.inName=this.gammas[this.curIn].name,a.outName=this.gammas[this.curOut].name,1===this.gammas[this.curIn].cat&&(a.inG=this.gammas[this.curIn].gamma),1===this.gammas[this.curOut].cat&&(a.outG=this.gammas[this.curOut].gamma),{p:t,t:i+20,v:this.ver,o:a}},LUTGamma.prototype.chartVals=function(t,i,a){var s,h,o,r,n,m={p:t,t:i+20,v:this.ver},e=129,p=new Float64Array(e),l=new Float64Array(e),u=new Float64Array(e),L=new Float64Array(e),f=new Float64Array(e),g=new Float64Array(e),c=new Float64Array(e);if(r=(this.bClip-64)/876,n=(this.wClip-64)/876,this.clip&&(this.outL||this.clipL)&&(this.clipB&&r<0&&(r=0),this.clipW&&n>1&&(n=1)),this.hdrOut&&!this.doDisplay){var F=this.gammas[this.curOut].mxO;F<n&&(n=F)}for(var y=0;y<e;y++)s=y/128,p[y]=14*s,l[y]=p[y]/.9,u[y]=18*s-9,L[y]=Math.pow(2,u[y])/5,f[y]=s,g[y]=(1023*s-64)/876,c[y]=s;var T=new Float64Array(17),G=new Float64Array(17);for(y=0;y<17;y++)T[y]=Math.pow(2,y-8)/5,G[y]=Math.pow(2,y-8)/5;var b=new Float64Array(l);m.curIn=this.curIn,m.curOut=this.curOut,this.gammas[this.curIn].linToL(l.buffer,{rec:!0});var U=new Float64Array(L);if(this.gammas[this.curIn].linToL(L.buffer,{rec:!0}),this.gammas[this.curIn].linFromL(c.buffer,{rec:!0}),this.nul)b=new Float64Array(l),U=new Float64Array(L),this.gammas[this.curIn].linToL(T.buffer,{rec:!0}),this.gammas[this.curIn].linToL(G.buffer,{rec:!0});else{this.gammas[this.curIn].linFromL(g.buffer);for(y=0;y<e;y++)b[y]*=this.eiMult,U[y]*=this.eiMult,g[y]*=this.eiMult;for(y=0;y<17;y++)T[y]/=this.eiMult;if(this.getLumVals(b.buffer),this.getLumVals(U.buffer),this.getLumVals(g.buffer),this.gammas[this.curIn].linToL(T.buffer,{rec:!0}),this.getLumVals(G.buffer),this.doBlkHi){for(y=0;y<e;y++)b[y]=b[y]*this.al+this.bl,U[y]=U[y]*this.al+this.bl,g[y]=g[y]*this.al+this.bl;for(y=0;y<17;y++)G[y]=G[y]*this.al+this.bl}if(this.doBlkGam){for(y=0;y<e;y++)b[y]>this.blkLevel&&b[y]<=this.blkGamUL&&(b[y]>this.blkGamLL?(o=Math.pow((b[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,b[y]<=o?b[y]=o:(h=(b[y]-this.blkGamLL)/this.blkGamF,h*=h,b[y]=h*b[y]+(1-h)*o)):b[y]=Math.pow((b[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel),U[y]>this.blkLevel&&U[y]<=this.blkGamUL&&(U[y]>this.blkGamLL?(o=Math.pow((U[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,U[y]<=o?U[y]=o:(h=(U[y]-this.blkGamLL)/this.blkGamF,h*=h,U[y]=h*U[y]+(1-h)*o)):U[y]=Math.pow((U[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel),g[y]>this.blkLevel&&g[y]<=this.blkGamUL&&(g[y]>this.blkGamLL?(o=Math.pow((g[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,g[y]<=o?g[y]=o:(h=(g[y]-this.blkGamLL)/this.blkGamF,h*=h,g[y]=h*g[y]+(1-h)*o)):g[y]=Math.pow((g[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel);for(y=0;y<17;y++)G[y]>this.blkLevel&&G[y]<=this.blkGamUL&&(G[y]>this.blkGamLL?(o=Math.pow((G[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,G[y]<=o?G[y]=o:(h=(G[y]-this.blkGamLL)/this.blkGamF,h*=h,G[y]=h*G[y]+(1-h)*o)):G[y]=Math.pow((G[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel)}this.doDisplay&&(this.displayOut(b.buffer),this.displayOut(U.buffer),this.displayOut(g.buffer),this.displayOut(G.buffer));for(y=0;y<e;y++)b[y]=Math.min(n,Math.max(r,b[y])),U[y]=Math.min(n,Math.max(r,U[y])),g[y]=Math.min(n,Math.max(r,g[y]));for(y=0;y<17;y++)G[y]=Math.min(n,Math.max(r,G[y]))}var w=new Float64Array([0,.18,.38,.44,.9,7.2,this.camClip]);for(y=0;y<7;y++)w[y]/=.9;if(this.nul)this.gammas[this.curIn].linToL(w.buffer,{rec:!0});else{if(this.getLumVals(w.buffer),this.doBlkHi)for(y=0;y<7;y++)w[y]=w[y]*this.al+this.bl;if(this.doBlkGam)for(y=0;y<7;y++)w[y]>this.blkLevel&&w[y]<=this.blkGamUL&&(w[y]>this.blkGamLL?(o=Math.pow((w[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,w[y]<=o?w[y]=o:(h=(w[y]-this.blkGamLL)/this.blkGamF,h*=h,w[y]=h*w[y]+(1-h)*o)):w[y]=Math.pow((w[y]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel);this.doDisplay&&this.displayOut(w.buffer)}return m.m=e,m.refX=p.buffer,m.refIn=l.buffer,m.refOut=b.buffer,m.stopX=u.buffer,m.stopIn=L.buffer,m.stopOut=U.buffer,m.stopPreVals=T.buffer,m.stopVals=G.buffer,m.lutIn=f.buffer,m.lutOut=g.buffer,m.colIn=c.buffer,m.colOut=c.buffer.slice(0),m.table=w.buffer,m.eiMult=this.eiMult,m.to=["refX","refIn","refOut","stopX","stopIn","stopOut","stopPreVals","stopVals","lutIn","lutOut","colIn","table"],m},LUTGamma.prototype.preview=function(t,i,a){var s={p:t,t:i+20,v:this.ver,leg:a.leg,line:a.line,upd:a.upd},h=1;"number"==typeof a.eiMult&&(h=a.eiMult);var o,r,n,m,e=new Float64Array(a.o),p=e.length,l=new Uint8Array(Math.round(4*p/3));if(r="boolean"==typeof a.cb&&a.cb?0:(this.bClip-64)/876,r=Math.max(r,-.073),n=(this.wClip-64)/876,n=Math.min(n,1.095),this.clip&&(this.outL||this.clipL)&&(this.clipB&&r<0&&(r=0),this.clipW&&n>1&&(n=1)),this.hdrOut&&!this.doDisplay&&(n=Math.min(n,this.gammas[this.curOut].mxO)),m=a.leg?255:255*n/1.095,this.nul){o=0;var u=239;a.leg&&(u=255),this.gammas[this.SL3Idx].linToL(a.o);for(var L=0;L<p;L+=3)e[L]=Math.min(n,Math.max(r,e[L])),e[L+1]=Math.min(n,Math.max(r,e[L+1])),e[L+2]=Math.min(n,Math.max(r,e[L+2])),l[o]=Math.min(255,Math.max(0,Math.round(e[L]*u))),l[o+1]=Math.min(255,Math.max(0,Math.round(e[L+1]*u))),l[o+2]=Math.min(255,Math.max(0,Math.round(e[L+2]*u))),l[o+3]=255,o+=4}else{for(p=e.length,L=0;L<p;L+=3)e[L]*=h,e[L+1]*=h,e[L+2]*=h;if(this.doASCCDL&&!a.threeD){for(L=0;L<p;L+=3)e[L]=e[L]*this.asc[0]+this.asc[3],e[L]=e[L]<0?e[L]:Math.pow(e[L],this.asc[6]),e[L]=isNaN(e[L])?0:e[L],e[L+1]=e[L+1]*this.asc[1]+this.asc[4],e[L+1]=e[L+1]<0?e[L+1]:Math.pow(e[L+1],this.asc[7]),e[L+1]=isNaN(e[L+1])?0:e[L+1],e[L+2]=e[L+2]*this.asc[2]+this.asc[5],e[L+2]=e[L+2]<0?e[L+2]:Math.pow(e[L+2],this.asc[8]),e[L+2]=isNaN(e[L+2])?0:e[L+2];if(doOG)for(L=0;L<p;L+=3)f[L]=f[L]*this.asc[0]+this.asc[3],f[L]=f[L]<0?f[L]:Math.pow(f[L],this.asc[6]),f[L]=isNaN(f[L])?0:f[L],f[L+1]=f[L+1]*this.asc[1]+this.asc[4],f[L+1]=f[L+1]<0?f[L+1]:Math.pow(f[L+1],this.asc[7]),f[L+1]=isNaN(f[L+1])?0:f[L+1],f[L+2]=f[L+2]*this.asc[2]+this.asc[5],f[L+2]=f[L+2]<0?f[L+2]:Math.pow(f[L+2],this.asc[8]),f[L+2]=isNaN(f[L+2])?0:f[L+2]}if(this.doKnee?this.kneeOut(a.o,{rgb:!0}):this.gammas[this.curOut].linToL(a.o,{rgb:!0}),this.doBlkHi&&this.blkHiOut(a.o),this.doBlkGam&&this.blkGamOut(a.o),this.doDisplay&&this.displayOut(a.o,{rgb:!0}),a.doGamutLim){if(void 0!==a.og){var f=new Float64Array(a.og);for(L=0;L<p;L++)f[L]*=h}this.gamutLimOut(a.o,a.gLimY,a.gLimL,a.og,a.gLimB)}for(L=0;L<p;L++)e[L]=Math.min(n,Math.max(r,e[L]));if(a.doFC&&this.fcOut(a.fc,a.o),o=0,a.leg)for(L=0;L<p;L+=3)l[o]=Math.min(m,Math.max(0,Math.round(255*e[L]))),l[o+1]=Math.min(m,Math.max(0,Math.round(255*e[L+1]))),l[o+2]=Math.min(m,Math.max(0,Math.round(255*e[L+2]))),l[o+3]=255,o+=4;else for(L=0;L<p;L+=3)l[o]=Math.min(m,Math.max(0,Math.round(239*e[L]))),l[o+1]=Math.min(m,Math.max(0,Math.round(239*e[L+1]))),l[o+2]=Math.min(m,Math.max(0,Math.round(239*e[L+2]))),l[o+3]=255,o+=4}return s.o=l.buffer,s.f=e.buffer,s.to=["o","f"],s},LUTGamma.prototype.previewLin=function(t,i,a){var s={p:t,t:i+20,v:this.ver,gamma:a.gamma,gamut:a.gamut,legal:a.legal,i:a.i},h=a.i.slice(0);return a.legal?this.gammas[a.gamma].linFromL(h,{rgb:!0}):this.gammas[a.gamma].linFromD(h,{rgb:!0}),s.o=h,s.to=["i","o"],s},LUTGamma.prototype.getPrimaries=function(t,i,a){var s={p:t,t:i+20,v:this.ver},h=a.o.slice(0);if(this.gammas[this.curOut].linToL(h,{rgb:!0}),"boolean"==typeof a.cb&&a.cb)for(var o=new Float64Array(h),r=o.length,n=0;n<r;n++)o[n]=Math.max(0,o[n]);return s.o=h,s},LUTGamma.prototype.psstColours=function(t,i,a){var s={p:t,t:i+20,v:this.ver},h=new Float64Array(a.b),o=new Float64Array(a.a),r=o.length,n=new Uint8Array(r),m=new Uint8Array(r);if(this.gammas[this.curOut].linToL(a.b,{rgb:!0}),this.gammas[this.curOut].linToL(a.a,{rgb:!0}),this.doDisplay&&(this.displayOut(a.b,{rgb:!0}),this.displayOut(a.a,{rgb:!0})),this.doBlkHi)for(var e=0;e<r;e++)n[e]=Math.min(255,Math.max(0,Math.round(255*(h[e]*this.al+this.bl)))),m[e]=Math.min(255,Math.max(0,Math.round(255*(o[e]*this.al+this.bl))));else for(e=0;e<r;e++)n[e]=Math.min(255,Math.max(0,Math.round(255*h[e]))),m[e]=Math.min(255,Math.max(0,Math.round(255*o[e])));return s.b=n.buffer,s.a=m.buffer,s.to=["b","a"],s},LUTGamma.prototype.multiColours=function(t,i,a){var s={p:t,t:i+20,v:this.ver},h=new Float64Array(a.o),o=h.length,r=new Uint8Array(o);this.nul||(this.doKnee?this.kneeOut(a.o,{rgb:!0}):this.gammas[this.curOut].linToL(a.o,{rgb:!0}),this.doBlkHi&&this.blkHiOut(a.o),this.doBlkGam&&this.blkGamOut(a.o),this.doDisplay&&this.displayOut(a.o,{rgb:!0}),a.doGamutLim&&this.gamutLimOut(a.o,a.gLimY,a.gLimL,a.og,a.gLimB));for(var n=0;n<o;n++)r[n]=Math.max(0,Math.min(255,255*h[n]/1.09475));return s.o=r.buffer,s.hs=a.hs,s.to=["o","hs"],s},LUTGamma.prototype.chartRGB=function(t,i,a){var s={p:t,t:i+20,v:this.ver,colIn:a.colIn,rIn:a.rIn,gIn:a.gIn,bIn:a.bIn,rOut:a.rOut,gOut:a.gOut,bOut:a.bOut,to:["rIn","gIn","bIn","rOut","gOut","bOut"]};this.gammas[this.curIn].linToD(a.rIn,{rec:!0}),this.gammas[this.curIn].linToD(a.gIn,{rec:!0}),this.gammas[this.curIn].linToD(a.bIn,{rec:!0}),this.gammas[this.curOut].linToL(a.rOut),this.gammas[this.curOut].linToL(a.gOut),this.gammas[this.curOut].linToL(a.bOut);var h,o,r=new Float64Array(a.rOut),n=new Float64Array(a.gOut),e=new Float64Array(a.bOut);if(this.doBlkHi)for(var p=0;p<m;p++)r[p]=r[p]*this.al+this.bl,n[p]=n[p]*this.al+this.bl,e[p]=e[p]*this.al+this.bl;if(this.doBlkGam)for(p=0;p<m;p++)r[p]>this.blkLevel&&r[p]<=this.blkGamUL&&(r[p]>this.blkGamLL?(o=Math.pow((r[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,r[p]<=o?r[p]=o:(h=(r[p]-this.blkGamLL)/this.blkGamF,h*=h,r[p]=h*r[p]+(1-h)*o)):r[p]=Math.pow((r[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel),n[p]>this.blkLevel&&n[p]<=this.blkGamUL&&(n[p]>this.blkGamLL?(o=Math.pow((n[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,n[p]<=o?n[p]=o:(h=(n[p]-this.blkGamLL)/this.blkGamF,h*=h,n[p]=h*n[p]+(1-h)*o)):n[p]=Math.pow((n[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel),e[p]>this.blkLevel&&e[p]<=this.blkGamUL&&(e[p]>this.blkGamLL?(o=Math.pow((e[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel,e[p]<=o?e[p]=o:(h=(e[p]-this.blkGamLL)/this.blkGamF,h*=h,e[p]=h*e[p]+(1-h)*o)):e[p]=Math.pow((e[p]-this.blkLevel)/this.blkGamR,this.blkGamP)*this.blkGamR+this.blkLevel);if("boolean"==typeof a.cb&&a.cb)for(p=0;p<m;p++)r[p]=Math.max(0,r[p]),n[p]=Math.max(0,n[p]),e[p]=Math.max(0,e[p]);return s},LUTGamma.prototype.changePQ=function(t,i,a){var s={p:t,t:i+20,v:this.ver,ok:!0};return s},LUTGamma.prototype.setHDRDisplayIntent=function(t,i,a){var s={p:t,t:i+20,v:this.ver};return"number"==typeof a.Lw&&("number"==typeof a.Lw?(this.pqOOTF.setLw(a.Lw,a.Lb),this.pqOOTFNorm.setLw(a.Lw,a.Lb)):(this.pqOOTF.setLw(a.Lw,0),this.pqOOTFNorm.setLw(a.Lw,0))),s.ok=!0,s},LUTGammaWorker.prototype.sendGammaMessage=function(t){if(this.gammas.isTrans&&void 0!==t.to){for(var i=t.to.length,a=[],s=0;s<i;s++)a.push(t[t.to[s]]);postMessage(t,a)}else postMessage(t)};var workerGammaString=getGammaWorkerString();function LUTs(){}function LUTSpline(t){"string"==typeof t.title?this.title=t.title:this.title="","string"==typeof t.format?this.format=t.format:this.format="",void 0!==t.meta?this.meta=t.meta:this.meta={},this.FD=new Float64Array(t.buff);var i=this.FD.length,a=this.FD[i-1]-this.FD[0];a>=0?a=1:a<0&&(a=-1),this.FA=new Float64Array(i),this.FB=new Float64Array(i),this.FC=new Float64Array(i);for(var s=new Float64Array(i),h=new Float64Array(i),o=0;o<i;o++)0===o?(s[0]=this.FD[1],this.FC[0]=-.5*this.FD[2]+2*this.FD[1]-1.5*this.FD[0],this.FC[0]*a<=0&&(this.FC[0]=.0075*a/(i-1)),h[0]=(this.FD[2]-this.FD[0])/2):o<i-1?(s[o]=this.FD[o+1],this.FC[o]=(this.FD[o+1]-this.FD[o-1])/2,o===i-2?(h[o]=.5*this.FD[o-1]-2*this.FD[o]+1.5*this.FD[o+1],h[o]*a<=0&&(h[o]=.0075*a/(i-1))):h[o]=(this.FD[o+2]-this.FD[o])/2):(s[o]=this.FD[o],this.FC[o]=h[o-1],h[o]=h[o-1]),this.FA[o]=2*this.FD[o]+this.FC[o]-2*s[o]+h[o],this.FB[o]=-3*this.FD[o]-2*this.FC[o]+3*s[o]-h[o];this.FM=i-1,this.fS=!1,void 0===t.fL&&void 0!==t.min&&0!==t.min[0]&&(t.fL=t.min[0]),void 0===t.fH&&void 0!==t.max&&1!==t.max[0]&&(t.fH=t.max[0]),"number"==typeof t.fH?(this.fH=t.fH,"number"==typeof t.fL?this.fL=t.fL:this.fL=0):(this.fH=1,this.fL=0),this.fLH=this.fH-this.fL,0===this.fL&&1===this.fH||(this.fS=!0),void 0!==t.inSpline?(this.sin=!0,this.ins=new LUTQSpline(t.inSpline)):this.sin=!1}function LUTRSpline(t){this.method=0,"string"==typeof t.title?this.title=t.title:this.title="","string"==typeof t.format?this.format=t.format:this.format="",void 0!==t.meta?this.meta=t.meta:this.meta={},this.FD=new Float64Array(t.buff);var i=this.FD.length,a=this.FD[i-1]-this.FD[0];a>=0?a=1:a<0&&(a=-1),this.FA=new Float64Array(i),this.FB=new Float64Array(i),this.FC=new Float64Array(i);for(var s,h=new Float64Array(i),o=new Float64Array(i),r=0;r<i;r++)0===r?(h[0]=this.FD[1],this.FC[0]=-.5*this.FD[2]+2*this.FD[1]-1.5*this.FD[0],this.FC[0]*a<=0&&(this.FC[0]=.0075*a/(i-1)),o[0]=(this.FD[2]-this.FD[0])/2):r<i-1?(h[r]=this.FD[r+1],this.FC[r]=(this.FD[r+1]-this.FD[r-1])/2,r===i-2?(o[r]=.5*this.FD[r-1]-2*this.FD[r]+1.5*this.FD[r+1],o[r]*a<=0&&(o[r]=.0075*a/(i-1))):o[r]=(this.FD[r+2]-this.FD[r])/2):(h[r]=this.FD[r],this.FC[r]=o[r-1],o[r]=o[r-1]),this.FA[r]=2*this.FD[r]+this.FC[r]-2*h[r]+o[r],this.FB[r]=-3*this.FD[r]-2*this.FC[r]+3*h[r]-o[r];this.FM=i-1,void 0!==t.inSpline?(this.sin=!0,this.ins=new LUTQSpline(t.inSpline)):this.sin=!1,this.fS=!1,void 0===t.fL&&void 0!==t.min&&0!==t.min[0]&&(t.fL=t.min[0]),void 0===t.fH&&void 0!==t.max&&1!==t.max[0]&&(t.fH=t.max[0]),"number"==typeof t.fH?(this.fH=t.fH,"number"==typeof t.fL?this.fL=t.fL:this.fL=0):(this.fH=1,this.fL=0),this.fLH=this.fH-this.fL,0===this.fL&&1===this.fH||(this.fS=!0),void 0===t.rL&&void 0!==t.rmin&&0!==t.rmin[0]&&(t.rL=t.rmin[0]),void 0===t.rH&&void 0!==t.rmax&&1!==t.rmax[0]&&(t.rH=t.rmax[0]),"number"==typeof t.rH?(this.rH=rH,"number"==typeof t.rL?this.rL=rL:this.rL=this.fL):(this.rH=this.FD[i-1],this.rL=this.FD[0]),this.rLH=this.rH-this.rL,s="number"==typeof t.minRM?Math.max(i,minRM):Math.max(i,1024),this.RM=s-1,this.brent=new Brent(this),this.buildReverse()}function LUTQSpline(t){this.meta={},this.FD=new Float64Array(t);var i=this.FD.length,a=this.FD[i-1]-this.FD[0];a>=0?a=1:a<0&&(a=-1),this.FA=new Float64Array(i),this.FB=new Float64Array(i),this.FC=new Float64Array(i);for(var s=new Float64Array(i),h=new Float64Array(i),o=0;o<i;o++)0===o?(s[0]=this.FD[1],this.FC[0]=-.5*this.FD[2]+2*this.FD[1]-1.5*this.FD[0],this.FC[0]*a<=0&&(this.FC[0]=.0075*a/(i-1)),h[0]=(this.FD[2]-this.FD[0])/2):o<i-1?(s[o]=this.FD[o+1],this.FC[o]=(this.FD[o+1]-this.FD[o-1])/2,o===i-2?(h[o]=.5*this.FD[o-1]-2*this.FD[o]+1.5*this.FD[o+1],h[o]*a<=0&&(h[o]=.0075*a/(i-1))):h[o]=(this.FD[o+2]-this.FD[o])/2):(s[o]=this.FD[o],this.FC[o]=h[o-1],h[o]=h[o-1]),this.FA[o]=2*this.FD[o]+this.FC[o]-2*s[o]+h[o],this.FB[o]=-3*this.FD[o]-2*this.FC[o]+3*s[o]-h[o];this.FM=i-1}function LUTRGBSpline(t){var i;"string"==typeof t.title?this.title=t.title:this.title="","string"==typeof t.format?this.format=t.format:this.format="",void 0!==t.meta?this.meta=t.meta:this.meta={},this.Y=new Float64Array([.2126,.7152,.0722]),this.fL=new Float64Array(4),this.fH=new Float64Array(4),this.fS=!1,void 0===t.min||0===t.min[0]&&0===t.min[1]&&0===t.min[2]||(t.fL=t.min[0],t.fLR=t.min[0],t.fLG=t.min[1],t.fLB=t.min[2]),void 0===t.max||1===t.max[0]&&1===t.max[1]&&1===t.max[2]||(t.fH=t.max[0],t.fHR=t.max[0],t.fHG=t.max[1],t.fHB=t.max[2]),"number"==typeof t.fH?(this.fH[0]=t.fH,this.fH[1]=t.fH,this.fH[2]=t.fH):(this.fH[0]=1,this.fH[1]=1,this.fH[2]=1),"number"==typeof t.fL?(this.fL[0]=t.fL,this.fL[1]=t.fL,this.fL[2]=t.fL):(this.fL[0]=0,this.fL[1]=0,this.fL[2]=0),"number"==typeof t.fLR&&"number"==typeof t.fHR&&"number"==typeof t.fLG&&"number"==typeof t.fHG&&"number"==typeof t.fLB&&"number"==typeof t.fHB&&(this.fL[0]=t.fLR,this.fH[0]=t.fHR,this.fL[1]=t.fLG,this.fH[1]=t.fHG,this.fL[2]=t.fLB,this.fH[2]=t.fHB),this.fLH=new Float64Array([this.fH[0]-this.fL[0],this.fH[1]-this.fL[1],this.fH[2]-this.fL[2],0]),0===this.fL[0]&&0===this.fL[1]&&0===this.fL[2]&&1===this.fH[0]&&1===this.fH[1]&&1===this.fH[2]||(this.fS=!0),void 0!==t.inSpline?(this.sin=!0,this.ins=new LUTQSpline(t.inSpline)):this.sin=!1,this.FA=[],this.FB=[],this.FC=[],this.FD=[],this.FM=[],this.FD[0]=new Float64Array(t.buffR),this.FD[1]=new Float64Array(t.buffG),this.FD[2]=new Float64Array(t.buffB);for(var a=0;a<3;a++)i=this.FD[a].length,this.FA[a]=new Float64Array(i),this.FB[a]=new Float64Array(i),this.FC[a]=new Float64Array(i),this.FM[a]=i-1;this.buildMesh(),this.buildL()}function LUTVolume(t){"string"==typeof t.title?this.title=t.title:this.title="","string"==typeof t.format?this.format=t.format:this.format="",void 0!==t.meta?this.meta=t.meta:this.meta={},this.Y=new Float64Array([.2126,.7152,.0722]),this.fL=new Float64Array(4),this.fH=new Float64Array(4),this.fS=!1,void 0===t.min||0===t.min[0]&&0===t.min[1]&&0===t.min[2]||(t.fL=t.min[0],t.fLR=t.min[0],t.fLG=t.min[1],t.fLB=t.min[2]),void 0===t.max||1===t.max[0]&&1===t.max[1]&&1===t.max[2]||(t.fH=t.max[0],t.fHR=t.max[0],t.fHG=t.max[1],t.fHB=t.max[2]),"number"==typeof t.fH?(this.fH[0]=t.fH,this.fH[1]=t.fH,this.fH[2]=t.fH):(this.fH[0]=1,this.fH[1]=1,this.fH[2]=1),"number"==typeof t.fL?(this.fL[0]=t.fL,this.fL[1]=t.fL,this.fL[2]=t.fL):(this.fL[0]=0,this.fL[1]=0,this.fL[2]=0),"number"==typeof t.fLR&&"number"==typeof t.fHR&&"number"==typeof t.fLG&&"number"==typeof t.fHG&&"number"==typeof t.fLB&&"number"==typeof t.fHB&&(this.fL[0]=t.fLR,this.fH[0]=t.fHR,this.fL[1]=t.fLG,this.fH[1]=t.fHG,this.fL[2]=t.fLB,this.fH[2]=t.fHB),this.fL[3]=Math.min(this.fL[0],this.fL[1],this.fL[2]),this.fH[3]=Math.max(this.fH[0],this.fH[1],this.fH[2]),this.fLH=new Float64Array([this.fH[0]-this.fL[0],this.fH[1]-this.fL[1],this.fH[2]-this.fL[2],0]),0===this.fL[0]&&0===this.fL[1]&&0===this.fL[2]&&1===this.fH[0]&&1===this.fH[1]&&1===this.fH[2]||(this.fS=!0),void 0!==t.inSpline?(this.sin=!0,this.ins=new LUTQSpline(t.inSpline)):this.sin=!1,this.pR=new Float64Array(4),this.pG=new Float64Array(4),this.pB=new Float64Array(4),this.buildMesh(t.buffR,t.buffG,t.buffB),this.buildL(),this.extVars={dc:new Float64Array(this.d),r:new Float64Array(this.d),J:new Float64Array(3*this.d),JtJ:new Float64Array(9),JtJI:new Float64Array(9),Jtr:new Float64Array(3),del:new Float64Array(3)},this.ABab=new Float64Array([1,0,1,0])}function getLUTString(){var t="";for(var i in t+=LUTs.toString()+"\n",LUTs.prototype)t+="LUTs.prototype."+i+"="+LUTs.prototype[i].toString()+"\n";for(var i in t+=LUTSpline.toString()+"\n",LUTSpline.prototype)t+="LUTSpline.prototype."+i+"="+LUTSpline.prototype[i].toString()+"\n";for(var i in t+=LUTRGBSpline.toString()+"\n",LUTRGBSpline.prototype)t+="LUTRGBSpline.prototype."+i+"="+LUTRGBSpline.prototype[i].toString()+"\n";for(var i in t+=LUTRSpline.toString()+"\n",LUTRSpline.prototype)t+="LUTRSpline.prototype."+i+"="+LUTRSpline.prototype[i].toString()+"\n";for(var i in t+=LUTQSpline.toString()+"\n",LUTQSpline.prototype)t+="LUTQSpline.prototype."+i+"="+LUTQSpline.prototype[i].toString()+"\n";for(var i in t+=LUTVolume.toString()+"\n",LUTVolume.prototype)t+="LUTVolume.prototype."+i+"="+LUTVolume.prototype[i].toString()+"\n";return t}LUTs.prototype.newLUT=function(t){var i={};return"string"==typeof t.title&&(i.title=t.title),"string"==typeof t.format&&(i.format=t.format),"number"==typeof t.dims?this.dims=t.dims:dims=1,void 0===t.min||0===t.min[0]&&0===t.min[1]&&0===t.min[2]||(i.fL=t.min[0],i.fLR=t.min[0],i.fLG=t.min[1],i.fLB=t.min[2]),void 0===t.max||1===t.max[0]&&1===t.max[1]&&1===t.max[2]||(i.fH=t.max[0],i.fHR=t.max[0],i.fHG=t.max[1],i.fHB=t.max[2]),"number"==typeof t.fL&&(i.fL=t.fL),"number"==typeof t.fH&&(i.fH=t.fH),"number"==typeof t.fLR&&(i.fLR=t.fLR),"number"==typeof t.fLG&&(i.fLG=t.fLG),"number"==typeof t.fLB&&(i.fLB=t.fLB),"number"==typeof t.fHR&&(i.fHR=t.fHR),"number"==typeof t.fHG&&(i.fHG=t.fHG),"number"==typeof t.fHB&&(i.fHB=t.fHB),void 0!==t.spline&&(i.inSpline=t.spline),void 0!==t.meta&&(i.meta=t.meta),3===t.C.length?(i.buffR=t.C[0].slice(0),i.buffG=t.C[1].slice(0),i.buffB=t.C[2].slice(0),3===this.dims?new LUTVolume(i):new LUTRGBSpline(i)):(i.buff=t.C[0].slice(0),new LUTSpline(i))},LUTSpline.prototype.buildL=function(){var t=this.FD.length,i=this.FD[t-1]-this.FD[0];i>=0?i=1:i<0&&(i=-1);for(var a=new Float64Array(t),s=new Float64Array(t),h=0;h<t;h++)0===h?(a[0]=this.FD[1],this.FC[0]=-.5*this.FD[2]+2*this.FD[1]-1.5*this.FD[0],this.FC[0]*i<=0&&(this.FC[0]=.0075*i/(t-1)),s[0]=(this.FD[2]-this.FD[0])/2):h<t-1?(a[h]=this.FD[h+1],this.FC[h]=(this.FD[h+1]-this.FD[h-1])/2,h===t-2?(s[h]=.5*this.FD[h-1]-2*this.FD[h]+1.5*this.FD[h+1],s[h]*i<=0&&(s[h]=.0075*i/(t-1))):s[h]=(this.FD[h+2]-this.FD[h])/2):(a[h]=this.FD[h],this.FC[h]=s[h-1],s[h]=s[h-1]),this.FA[h]=2*this.FD[h]+this.FC[h]-2*a[h]+s[h],this.FB[h]=-3*this.FD[h]-2*this.FC[h]+3*a[h]-s[h];this.FM=t-1},LUTSpline.prototype.f=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTSpline.prototype.df=function(t){var i,a,s,h=this.FM;(this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=h)<=0?i=h*this.FC[0]:t>=h?i=h*this.FC[h]:(a=t-(s=Math.floor(t)),i=h*((3*this.FA[s]*a+2*this.FB[s])*a+this.FC[s])),this.sin)&&(i*=this.ins.df(t));return this.fS&&(i/=this.fLH),i},LUTSpline.prototype.fCub=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTSpline.prototype.fTet=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTSpline.prototype.fLin=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTSpline.prototype.FCub=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTSpline.prototype.FTet=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTSpline.prototype.FLin=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTSpline.prototype.fRGBCub=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t=t*this.FC[0]+this.FD[0]:t>=s?t=(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),t=((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a]),new Float64Array([t,t,t])},LUTSpline.prototype.fRGBTet=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),t=(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1],new Float64Array([t,t,t])},LUTSpline.prototype.fRGBLin=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),t=(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1],new Float64Array([t,t,t])},LUTSpline.prototype.rgbCub=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FCub(i.buffer),i},LUTSpline.prototype.rgbTet=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FTet(i.buffer),i},LUTSpline.prototype.rgbLin=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FLin(i.buffer),i},LUTSpline.prototype.RGBCub=function(t){this.FCub(out)},LUTSpline.prototype.RGBLin=function(t){this.FTet(out)},LUTSpline.prototype.RGBLin=function(t){this.FLin(out)},LUTSpline.prototype.J=function(t){if(3===t.length){var i,a,s=new Float64Array(t.buffer.slice(0)),h=new Float64Array(9),o=this.FM;return this.fS&&(s[0]=(s[0]-this.fL)/this.fLH,s[1]=(s[1]-this.fL)/this.fLH,s[2]=(s[2]-this.fL)/this.fLH),this.sin&&(s[0]=this.ins.f(s[0]),s[1]=this.ins.f(s[1]),s[2]=this.ins.f(s[2])),s[0]*=o,s[1]*=o,s[2]*=o,s[0]<=0?h[0]=this.FC[0]:s[0]>=o?h[0]=this.FC[o]:(a=Math.floor(s[0]),i=s[0]-a,h[0]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[1]<=0?h[4]=this.FC[0]:s[1]>=o?h[4]=this.FC[o]:(a=Math.floor(s[1]),i=s[1]-a,h[4]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[2]<=0?h[8]=this.FC[0]:s[2]>=o?h[8]=this.FC[o]:(a=Math.floor(s[2]),i=s[2]-a,h[8]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),h}return!1},LUTSpline.prototype.JInv=function(t){var i=this.J(t);return 0!==i[0]&&0!==i[4]&&0!==i[8]&&new Float64Array([1/i[0],0,0,0,1/i[4],0,0,0,1/i[8]])},LUTSpline.prototype.getDetails=function(){return{title:this.title,format:this.format,dims:1,s:this.FM+1,min:new Float64Array([this.fL,this.fL,this.fL]),max:new Float64Array([this.fH,this.fH,this.fH]),C:[this.FD.buffer],meta:this.meta}},LUTSpline.prototype.getL=function(){return this.FD.buffer},LUTSpline.prototype.getRGB=function(){return[this.FD.buffer]},LUTSpline.prototype.getSize=function(){return this.FM+1},LUTSpline.prototype.is1D=function(){return!0},LUTSpline.prototype.is3D=function(){return!1},LUTSpline.prototype.getTitle=function(){return this.title},LUTSpline.prototype.getMetadata=function(){return this.meta},LUTSpline.prototype.isClamped=function(){if(void 0===this.clamped){var t=this.minMax();0===t[0]&&t[1]<=1||t[0]>=0&&1===t[1]?this.clamped=!0:this.clamped=!1}return this.clamped},LUTSpline.prototype.deClamp=function(){if(this.isClamped()){for(var t,i=this.FD,a=!1,s=0,h=(t=i.length)-1,o=0;o<t;o++)o>0&&0===i[o]&&(a=!0,s=o+1);for(o=t-2;o>=0;o--)1===i[o]&&(a=!0,h=o-1);if(a){if(s>h){var r=h;h=Math.min(s-2,t-1),s=Math.max(r+2,0)}var n=h-s,m=new LUTQSpline(new Float64Array(undefined.subarray(s,n+1)).buffer),e=this.fL;for(this.fH,o=0;o<t;o++)o===s&&(o=h),i[o]=m.fCub((o-s)/n)}this.buildL(),this.clamped=!1}},LUTSpline.prototype.minMax=function(){for(var t=new Float64Array([9999,-9999]),i=this.FD,a=i.length,s=0;s<a;s++)i[s]<t[0]&&(t[0]=i[s]),i[s]>t[1]&&(t[1]=i[s]);return t},LUTRSpline.prototype.f=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),0===this.method?((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a]:(1-i)*this.FD[a]+i*this.FD[a+1])},LUTRSpline.prototype.df=function(t){var i,a,s,h=this.FM;if(this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=h)<=0)i=h*this.FC[0];else if(t>=h)i=h*this.FC[h];else{if(a=t-(s=Math.floor(t)),0!==this.method)return h*(this.FD[s+1]-this.FD[s]);i=h*((3*this.FA[s]*a+2*this.FB[s])*a+this.FC[s])}this.sin&&(i*=this.ins.df(t));return this.fS&&(i/=this.fLH),i},LUTRSpline.prototype.fCub=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTRSpline.prototype.fTet=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTRSpline.prototype.fLin=function(t){var i,a,s=this.FM;return this.fS&&(t=(t-this.fL)/this.fLH),this.sin&&(t=this.ins.f(t)),(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTRSpline.prototype.FCub=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTRSpline.prototype.FTet=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTRSpline.prototype.FLin=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM;if(this.fS)for(var r=0;r<h;r++)s[r]=(s[r]-this.fL)/this.fLH;this.sin&&this.ins.FCub(t);for(r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTRSpline.prototype.fRGBCub=function(t){return t=this.f(t),new Float64Array([t,t,t])},LUTRSpline.prototype.fRGBTet=function(t){return t=this.fLin(t),new Float64Array([t,t,t])},LUTRSpline.prototype.fRGBLin=function(t){return t=this.fLin(t),new Float64Array([t,t,t])},LUTRSpline.prototype.rgbCub=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FCub(i.buffer),i},LUTRSpline.prototype.rgbTet=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FLin(i.buffer),i},LUTRSpline.prototype.rgbLin=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FLin(i.buffer),i},LUTRSpline.prototype.RGBCub=function(t){this.FCub(out)},LUTRSpline.prototype.RGBTet=function(t){this.FLin(out)},LUTRSpline.prototype.RGBLin=function(t){this.FLin(out)},LUTRSpline.prototype.J=function(t){if(3===t.length){var i,a,s=new Float64Array(t.buffer.slice(0)),h=new Float64Array(9),o=this.FM;return this.fS&&(s[0]=(s[0]-this.fL)/this.fLH,s[1]=(s[1]-this.fL)/this.fLH,s[2]=(s[2]-this.fL)/this.fLH),this.sin&&(s[0]=this.ins.f(s[0]),s[1]=this.ins.f(s[1]),s[2]=this.ins.f(s[2])),s[0]*=o,s[1]*=o,s[2]*=o,s[0]<=0?h[0]=this.FC[0]:s[0]>=o?h[0]=this.FC[o]:(a=Math.floor(s[0]),i=s[0]-a,h[0]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[1]<=0?h[4]=this.FC[0]:s[1]>=o?h[4]=this.FC[o]:(a=Math.floor(s[1]),i=s[1]-a,h[4]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[2]<=0?h[8]=this.FC[0]:s[2]>=o?h[8]=this.FC[o]:(a=Math.floor(s[2]),i=s[2]-a,h[8]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),h}return!1},LUTRSpline.prototype.JInv=function(t){var i=this.J(t);return 0!==i[0]&&0!==i[4]&&0!==i[8]&&new Float64Array([1/i[0],0,0,0,1/i[4],0,0,0,1/i[8]])},LUTRSpline.prototype.getDetails=function(){return{title:this.title,format:this.format,dims:1,s:this.FM+1,min:new Float64Array([this.fL,this.fL,this.fL]),max:new Float64Array([this.fH,this.fH,this.fH]),C:[this.FD.buffer],meta:this.meta}},LUTRSpline.prototype.getL=function(){return this.FD.buffer},LUTRSpline.prototype.getRGB=function(){return[this.FD.buffer]},LUTRSpline.prototype.getSize=function(){return this.FM+1},LUTRSpline.prototype.is1D=function(){return!0},LUTRSpline.prototype.is3D=function(){return!1},LUTRSpline.prototype.getTitle=function(){return this.title},LUTRSpline.prototype.getMetadata=function(){return this.meta},LUTRSpline.prototype.r=function(t){var i,a,s=this.RM;return(t=s*(t-this.rL)/this.rLH)<=0?t*this.RC[0]+this.RD[0]:t>=s?(t-s)*this.RC[s]+this.RD[s]:(i=t-(a=Math.floor(t)),0===this.method?((this.RA[a]*i+this.RB[a])*i+this.RC[a])*i+this.RD[a]:(1-i)*this.RD[a]+i*this.RD[a+1])},LUTRSpline.prototype.R=function(t){for(var i,a,s=new Float64Array(t),h=s.length,o=this.RM,r=0;r<h;r++)s[r]=o*(s[r]-this.rL)/this.rLH,s[r]<=0?s[r]=s[r]*this.RC[0]+this.RD[0]:s[r]>=o?s[r]=(s[r]-o)*this.RC[o]+this.RD[o]:(a=Math.floor(s[r]),i=s[r]-a,0===this.method?s[r]=((this.RA[a]*i+this.RB[a])*i+this.RC[a])*i+this.RD[a]:s[r]=(1-i)*this.RD[a]+i*this.RD[a+1])},LUTRSpline.prototype.buildReverse=function(){var t,i=this.RM+1;this.RD=new Float64Array(i);for(var a=0;a<i;a++)t=a/(i-1)*this.rLH+this.rL,0===a||t<=0||isNaN(this.RD[a-1])||this.RD[a-1]<=-65534||this.RD[a-1]>=65534?this.RD[a]=this.brent.findRoot(t,t):this.RD[a]=this.brent.findRoot(this.RD[a-1],t),this.RD[a]<-65534?this.RD[a]=-65534:this.RD[a]>65534&&(this.RD[a]=65534);if(isNaN(this.RD[0]))for(a=0;a<i;a++)if(!isNaN(this.RD[a])){this.RD[0]=this.RD[a];break}for(a=1;a<i;a++)isNaN(this.RD[a])&&(this.RD[a]=this.RD[a-1]);for(a=1;a<i;a++)this.RD[a]=this.RD[a]*this.fLH+this.fL;mono=this.RD[i-1]-this.RD[0],mono>=0?mono=1:mono<0&&(mono=-1),this.RA=new Float64Array(i),this.RB=new Float64Array(i),this.RC=new Float64Array(i);var s=new Float64Array(i),h=new Float64Array(i);for(a=0;a<i;a++)0===a?(s[0]=this.RD[1],this.RC[0]=-.5*this.RD[2]+2*this.RD[1]-1.5*this.RD[0],this.RC[0]*mono<=0&&(this.RC[0]=.0075*mono/(i-1)),h[0]=(this.RD[2]-this.RD[0])/2):a<i-1?(s[a]=this.RD[a+1],this.RC[a]=(this.RD[a+1]-this.RD[a-1])/2,a===i-2?(h[a]=.5*this.RD[a-1]-2*this.RD[a]+1.5*this.RD[a+1],h[a]*mono<=0&&(h[a]=.0075*mono/(i-1))):h[a]=(this.RD[a+2]-this.RD[a])/2):(s[a]=this.RD[a],this.RC[a]=h[a-1],h[a]=h[a-1]),this.RA[a]=2*this.RD[a]+this.RC[a]-2*s[a]+h[a],this.RB[a]=-3*this.RD[a]-2*this.RC[a]+3*s[a]-h[a]},LUTRSpline.prototype.setMethod=function(t){return"number"==typeof t&&(this.method=t,this.buildReverse(),!0)},LUTRSpline.prototype.getMethod=function(){return this.method},LUTRSpline.prototype.getReverse=function(){return this.RD.buffer},LUTRSpline.prototype.getMinMax=function(){for(var t=0,i=1,a=this.RD.length,s=0;s<a;s++)this.RD[s]>i?i=this.RD[s]:this.RD[s]<t&&(t=this.RD[s]);return{a:t,b:i}},LUTRSpline.prototype.getHighLow=function(){return{forH:this.fH,forL:this.fL,revH:this.rH,revL:this.rL}},LUTRSpline.prototype.getRM=function(){return this.RM+1},LUTRSpline.prototype.getR=function(){return this.RD.buffer},LUTQSpline.prototype.f=function(t){var i,a,s=this.FM;return(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTQSpline.prototype.df=function(t){var i,a,s=this.FM;return(t*=s)<=0?s*this.FC[0]:t>=s?s*this.FC[s]:(i=t-(a=Math.floor(t)),s*((3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]))},LUTQSpline.prototype.fCub=function(t){var i,a,s=this.FM;return(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(i=t-(a=Math.floor(t)),((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTQSpline.prototype.fTet=function(t){var i,a,s=this.FM;return(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTQSpline.prototype.fLin=function(t){var i,a,s=this.FM;return(t*=s)<=0?t*this.FC[0]+this.FD[0]:t>=s?(t-s)*this.FC[s]+this.FD[s]:(1-(i=t-(a=Math.floor(t))))*this.FD[a]+i*this.FD[a+1]},LUTQSpline.prototype.FCub=function(t){for(var i,a,s=new Float64Array(t),h=s.length,o=this.FM,r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=((this.FA[a]*i+this.FB[a])*i+this.FC[a])*i+this.FD[a])},LUTQSpline.prototype.FTet=function(t){for(var i,a,s=new Float64Array(t),h=s.length,o=this.FM,r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTQSpline.prototype.FLin=function(t){for(var i,a,s=new Float64Array(t),h=s.length,o=this.FM,r=0;r<h;r++)s[r]*=o,s[r]<=0?s[r]=s[r]*this.FC[0]+this.FD[0]:s[r]>=o?s[r]=(s[r]-o)*this.FC[o]+this.FD[o]:(a=Math.floor(s[r]),i=s[r]-a,s[r]=(1-i)*this.FD[a]+i*this.FD[a+1])},LUTQSpline.prototype.fRGBCub=function(t){return t=this.f(t),new Float64Array([t,t,t])},LUTQSpline.prototype.fRGBTet=function(t){return t=this.fLin(t),new Float64Array([t,t,t])},LUTQSpline.prototype.fRGBLin=function(t){return t=this.fLin(t),new Float64Array([t,t,t])},LUTQSpline.prototype.rgbCub=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FCub(i.buffer),i},LUTQSpline.prototype.rgbTet=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FLin(i.buffer),i},LUTQSpline.prototype.rgbLin=function(t){var i=new Float64Array(t.buffer.slice(0));return this.FLin(i.buffer),i},LUTQSpline.prototype.RGBCub=function(t){this.FCub(out)},LUTQSpline.prototype.RGBTet=function(t){this.FLin(out)},LUTQSpline.prototype.RGBLin=function(t){this.FLin(out)},LUTQSpline.prototype.J=function(t){if(3===t.length){var i,a,s=new Float64Array(t.buffer.slice(0)),h=new Float64Array(9),o=this.FM;return s[0]*=o,s[1]*=o,s[2]*=o,s[0]<=0?h[0]=this.FC[0]:s[0]>=o?h[0]=this.FC[o]:(a=Math.floor(s[0]),i=s[0]-a,h[0]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[1]<=0?h[4]=this.FC[0]:s[1]>=o?h[4]=this.FC[o]:(a=Math.floor(s[1]),i=s[1]-a,h[4]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[2]<=0?h[8]=this.FC[0]:s[2]>=o?h[8]=this.FC[o]:(a=Math.floor(s[2]),i=s[2]-a,h[8]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),h[0]*=o,h[4]*=o,h[8]*=o,h}return!1},LUTQSpline.prototype.JInv=function(t){var i=this.J(t);return 0!==i[0]&&0!==i[4]&&0!==i[8]&&new Float64Array([1/i[0],0,0,0,1/i[4],0,0,0,1/i[8]])},LUTQSpline.prototype.getDetails=function(){return{title:"",format:"",dims:1,s:this.FM+1,min:new Float64Array([0,0,0]),max:new Float64Array([1,1,1]),C:[this.FD.buffer],meta:this.meta}},LUTQSpline.prototype.getL=function(){return this.FD.buffer},LUTQSpline.prototype.getRGB=function(){return[this.FD.buffer]},LUTQSpline.prototype.getSize=function(){return this.FM+1},LUTQSpline.prototype.is1D=function(){return!0},LUTQSpline.prototype.is3D=function(){return!1},LUTQSpline.prototype.getTitle=function(){return""},LUTQSpline.prototype.getMetadata=function(){return this.meta},LUTQSpline.prototype.dRGB=function(t){if(3===t.length){var i,a,s=new Float64Array(t.buffer.slice(0)),h=new Float64Array(3),o=this.FM;return s[0]*=o,s[1]*=o,s[2]*=o,s[0]<=0?h[0]=this.FC[0]:s[0]>=o?h[0]=this.FC[o]:(a=Math.floor(s[0]),i=s[0]-a,h[0]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[1]<=0?h[1]=this.FC[0]:s[1]>=o?h[1]=this.FC[o]:(a=Math.floor(s[1]),i=s[1]-a,h[1]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),s[2]<=0?h[2]=this.FC[0]:s[2]>=o?h[2]=this.FC[o]:(a=Math.floor(s[2]),i=s[2]-a,h[2]=(3*this.FA[a]*i+2*this.FB[a])*i+this.FC[a]),h[0]*=o,h[1]*=o,h[2]*=o,h}return!1},LUTRGBSpline.prototype.buildMesh=function(){for(var t,i,a,s,h=0;h<3;h++){t=this.FD[h].length,(i=this.FD[h][t-1]-this.FD[h][0])>=0?i=1:i<0&&(i=-1),a=new Float64Array(t),s=new Float64Array(t);for(var o=0;o<t;o++)0===o?(a[0]=this.FD[h][1],this.FC[h][0]=-.5*this.FD[h][2]+2*this.FD[h][1]-1.5*this.FD[h][0],this.FC[h][0]*i<=0&&(this.FC[h][0]=.0075*i/(t-1)),s[0]=(this.FD[h][2]-this.FD[h][0])/2):o<t-1?(a[o]=this.FD[h][o+1],this.FC[h][o]=(this.FD[h][o+1]-this.FD[h][o-1])/2,o===t-2?(s[o]=.5*this.FD[h][o-1]-2*this.FD[h][o]+1.5*this.FD[h][o+1],s[o]*i<=0&&(s[o]=.0075*i/(t-1))):s[o]=(this.FD[h][o+2]-this.FD[h][o])/2):(a[o]=this.FD[h][o],this.FC[h][o]=s[o-1],s[o]=s[o-1]),this.FA[h][o]=2*this.FD[h][o]+this.FC[h][o]-2*a[o]+s[o],this.FB[h][o]=-3*this.FD[h][o]-2*this.FC[h][o]+3*a[o]-s[o]}},LUTRGBSpline.prototype.buildL=function(){this.fL[3]=Math.min(this.fL[0],this.fL[1],this.fL[2]),this.fH[3]=Math.max(this.fH[0],this.fH[1],this.fH[2]),this.fLH[3]=this.fH[3]-this.fL[3],this.FM[3]=Math.max(this.FM[0],this.FM[1],this.FM[2]),this.FM[3]<64&&(this.FM[3]=64);var t,i,a,s,h,o,r=this.FM[3]+1;this.FD[3]=new Float64Array(r);for(var n=0;n<r;n++){t=n*this.fLH[3]/(r-1)+this.fL[3];for(var m=0;m<3;m++)a=this.FM[m],i=(t-this.fL[m])/this.fLH[m],this.sin&&(i=this.ins.f(i)),(i*=a)<=0?i=i*this.FC[m][0]+this.FD[m][0]:i>=a?i=(i-a)*this.FC[m][a]+this.FD[m][a]:(s=i-(h=Math.floor(i)),i=((this.FA[m][h]*s+this.FB[m][h])*s+this.FC[m][h])*s+this.FD[m][h]),this.FD[3][n]+=i*this.Y[m]}this.FA[3]=new Float64Array(r),this.FB[3]=new Float64Array(r),this.FC[3]=new Float64Array(r);var e=new Float64Array(r),p=new Float64Array(r);(o=this.FD[3][r-1]-this.FD[3][0])>=0?o=1:o<0&&(o=-1);for(n=0;n<r;n++)0===n?(e[0]=this.FD[3][1],this.FC[3][0]=-.5*this.FD[3][2]+2*this.FD[3][1]-1.5*this.FD[3][0],this.FC[3][0]*o<=0&&(this.FC[3][0]=.0075*o/(r-1)),p[0]=(this.FD[3][2]-this.FD[3][0])/2):n<r-1?(e[n]=this.FD[3][n+1],this.FC[3][n]=(this.FD[3][n+1]-this.FD[3][n-1])/2,n===r-2?(p[n]=.5*this.FD[3][n-1]-2*this.FD[3][n]+1.5*this.FD[3][n+1],p[n]*o<=0&&(p[n]=.0075*o/(r-1))):p[n]=(this.FD[3][n+2]-this.FD[3][n])/2):(e[n]=this.FD[3][n],this.FC[3][n]=p[n-1],p[n]=p[n-1]),this.FA[3][n]=2*this.FD[3][n]+this.FC[3][n]-2*e[n]+p[n],this.FB[3][n]=-3*this.FD[3][n]-2*this.FC[3][n]+3*e[n]-p[n]},LUTRGBSpline.prototype.f=function(t){var i,a,s=this.FM[3];return this.fS?t=s*(t-this.fL[3])/this.fLH[3]:t*=s,t<=0?t*this.FC[3][0]+this.FD[3][0]:t>=s?(t-s)*this.FC[3][s]+this.FD[3][s]:(i=t-(a=Math.floor(t)),((this.FA[3][a]*i+this.FB[3][a])*i+this.FC[3][a])*i+this.FD[3][a])},LUTRGBSpline.prototype.df=function(t){var i,a,s,h=this.FM[3];return this.fS?t=h*(t-this.fL[3])/this.fLH[3]:t*=h,t<=0?i=h*this.FC[3][0]:t>=h?i=h*this.FC[3][h]:(a=t-(s=Math.floor(t)),i=h*((3*this.FA[3][s]*a+2*this.FB[3][s])*a+this.FC[3][s])),this.fS&&(i/=this.fLH[3]),i},LUTRGBSpline.prototype.fCub=function(t){var i,a,s=this.FM[3];return this.fS?t=s*(t-this.fL[3])/this.fLH[3]:t*=s,t<=0?t*this.FC[3][0]+this.FD[3][0]:t>=s?(t-s)*this.FC[3][s]+this.FD[3][s]:(i=t-(a=Math.floor(t)),((this.FA[3][a]*i+this.FB[3][a])*i+this.FC[3][a])*i+this.FD[3][a])},LUTRGBSpline.prototype.fTet=function(t){var i,a,s=this.FM[3];return this.fS?t=s*(t-this.fL[3])/this.fLH[3]:t*=s,t<=0?t*this.FC[3][0]+this.FD[3][0]:t>=s?(t-s)*this.FC[3][s]+this.FD[3][s]:(1-(i=t-(a=Math.floor(t))))*this.FD[3][a]+i*this.FD[3][a+1]},LUTRGBSpline.prototype.fLin=function(t){var i,a,s=this.FM[3];return this.fS?t=s*(t-this.fL[3])/this.fLH[3]:t*=s,t<=0?t*this.FC[3][0]+this.FD[3][0]:t>=s?(t-s)*this.FC[3][s]+this.FD[3][s]:(1-(i=t-(a=Math.floor(t))))*this.FD[3][a]+i*this.FD[3][a+1]},LUTRGBSpline.prototype.FCub=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM[3],r=this.fL[3],n=this.fLH[3];if(this.fS)for(var m=0;m<h;m++)s[m]=(s[m]-r)/n;for(m=0;m<h;m++)s[m]*=o,s[m]<=0?s[m]=s[m]*this.FC[3][0]+this.FD[3][0]:s[m]>=o?s[m]=(s[m]-o)*this.FC[3][o]+this.FD[3][o]:(a=Math.floor(s[m]),i=s[m]-a,s[m]=((this.FA[3][a]*i+this.FB[3][a])*i+this.FC[3][a])*i+this.FD[3][a])},LUTRGBSpline.prototype.FTet=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM[3],r=this.fL[3],n=this.fLH[3];if(this.fS)for(var m=0;m<h;m++)s[m]=o*(s[m]-r)/n;for(m=0;m<h;m++)s[m]*=o,s[m]<=0?s[m]=s[m]*this.FC[3][0]+this.FD[3][0]:s[m]>=o?s[m]=(s[m]-o)*this.FC[3][o]+this.FD[3][o]:(a=Math.floor(s[m]),i=s[m]-a,s[m]=(1-i)*this.FD[3][a]+i*this.FD[3][a+1])},LUTRGBSpline.prototype.FLin=function(t){var i,a,s=new Float64Array(t),h=s.length,o=this.FM[3],r=this.fL[3],n=this.fLH[3];if(this.fS)for(var m=0;m<h;m++)s[m]=o*(s[m]-r)/n;for(m=0;m<h;m++)s[m]*=o,s[m]<=0?s[m]=s[m]*this.FC[3][0]+this.FD[3][0]:s[m]>=o?s[m]=(s[m]-o)*this.FC[3][o]+this.FD[3][o]:(a=Math.floor(s[m]),i=s[m]-a,s[m]=(1-i)*this.FD[3][a]+i*this.FD[3][a+1])},LUTRGBSpline.prototype.fRGBCub=function(t){var i,a,s,h=new Float64Array(3);this.fS&&(h[0]=(t-this.fL[0])/this.fLH[0],h[1]=(t-this.fL[1])/this.fLH[1],h[2]=(t-this.fL[2])/this.fLH[2]),this.sin&&this.ins.FCub(h.buffer);for(var o=0;o<3;o++)i=this.FM[o],h[o]*=i,h[o]<=0?h[o]=h[o]*this.FC[o][0]+this.FD[o][0]:h[o]>=i?h[o]=(h[o]-i)*this.FC[o][i]+this.FD[o][i]:(s=Math.floor(h[o]),a=h[o]-s,h[o]=((this.FA[o][s]*a+this.FB[o][s])*a+this.FC[o][s])*a+this.FD[o][s]);return h},LUTRGBSpline.prototype.fRGBTet=function(t){var i,a,s,h=new Float64Array(3);this.fS&&(h[0]=(t-this.fL[0])/this.fLH[0],h[1]=(t-this.fL[1])/this.fLH[1],h[2]=(t-this.fL[2])/this.fLH[2]),this.sin&&this.ins.FCub(h.buffer);for(var o=0;o<3;o++)i=this.FM[o],h[o]*=i,h[o]<=0?h[o]=h[o]*this.FC[o][0]+this.FD[o][0]:h[o]>=i?h[o]=(h[o]-i)*this.FC[o][i]+this.FD[o][i]:(s=Math.floor(h[o]),a=h[o]-s,h[j]=(1-a)*this.FD[o][s]+a*this.FD[o][s+1]);return h},LUTRGBSpline.prototype.fRGBLin=function(t){var i,a,s,h=new Float64Array(3);this.fS&&(h[0]=(t-this.fL[0])/this.fLH[0],h[1]=(t-this.fL[1])/this.fLH[1],h[2]=(t-this.fL[2])/this.fLH[2]),this.sin&&this.ins.FCub(h.buffer);for(var o=0;o<3;o++)i=this.FM[o],h[o]*=i,h[o]<=0?h[o]=h[o]*this.FC[o][0]+this.FD[o][0]:h[o]>=i?h[o]=(h[o]-i)*this.FC[o][i]+this.FD[o][i]:(s=Math.floor(h[o]),a=h[o]-s,h[j]=(1-a)*this.FD[o][s]+a*this.FD[o][s+1]);return h},LUTRGBSpline.prototype.rgbCub=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBCub(i.buffer),i},LUTRGBSpline.prototype.rgbTet=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBLin(i.buffer),i},LUTRGBSpline.prototype.rgbLin=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBLin(i.buffer),i},LUTRGBSpline.prototype.RGBCub=function(t){var i,a,s,h,o=new Float64Array(t),r=o.length,n=this.fL,m=this.fLH;if(this.fS)for(var e=0;e<r;e+=3)o[e]=(o[e]-n[0])/m[0],o[e+1]=(o[e+1]-n[1])/m[1],o[e+2]=(o[e+2]-n[2])/m[2];this.sin&&this.ins.FCub(t);for(var p=0;p<3;p++){i=this.FM[p];for(e=0;e<r;e+=3)o[a=e+p]*=i,o[a]<=0?o[a]=o[a]*this.FC[p][0]+this.FD[p][0]:o[a]>=i?o[a]=(o[a]-i)*this.FC[p][i]+this.FD[p][i]:(s=Math.floor(o[a]),h=o[a]-s,o[a]=((this.FA[p][s]*h+this.FB[p][s])*h+this.FC[p][s])*h+this.FD[p][s])}},LUTRGBSpline.prototype.RGBTet=function(t){var i,a,s,h,o=new Float64Array(t),r=o.length,n=this.fL,m=this.fLH;if(this.fS)for(var e=0;e<r;e+=3)o[e]=(o[e]-n[0])/m[0],o[e+1]=(o[e+1]-n[1])/m[1],o[e+2]=(o[e+2]-n[2])/m[2];this.sin&&this.ins.FCub(t);for(var p=0;p<3;p++){i=this.FM[p];for(e=0;e<r;e+=3)o[a=e+p]*=i,o[a]<=0?o[a]=o[a]*this.FC[p][0]+this.FD[p][0]:o[a]>=i?o[a]=(o[a]-i)*this.FC[p][i]+this.FD[p][i]:(s=Math.floor(o[a]),h=o[a]-s,o[e]=(1-h)*this.FD[p][s]+h*this.FD[p][s+1])}},LUTRGBSpline.prototype.RGBLin=function(t){var i,a,s,h,o=new Float64Array(t),r=o.length,n=this.fL,m=this.fLH;if(this.fS)for(var e=0;e<r;e+=3)o[e]=(o[e]-n[0])/m[0],o[e+1]=(o[e+1]-n[1])/m[1],o[e+2]=(o[e+2]-n[2])/m[2];this.sin&&this.ins.FCub(t);for(var p=0;p<3;p++){i=this.FM[p];for(e=0;e<r;e+=3)o[a=e+p]*=i,o[a]<=0?o[a]=o[a]*this.FC[p][0]+this.FD[p][0]:o[a]>=i?o[a]=(o[a]-i)*this.FC[p][i]+this.FD[p][i]:(s=Math.floor(o[a]),h=o[a]-s,o[e]=(1-h)*this.FD[p][s]+h*this.FD[p][s+1])}},LUTRGBSpline.prototype.J=function(t){if(3===t.length){var i,a,s,h=new Float64Array(t.buffer.slice(0)),o=new Float64Array(9);if(this.fS&&(h[0]=(h[0]-this.fL[0])/this.fLH[0],h[1]=(h[1]-this.fL[1])/this.fLH[1],h[2]=(h[2]-this.fL[2])/this.fLH[2]),this.sin&&(h[0]=this.ins.f(h[0]),h[1]=this.ins.f(h[1]),h[2]=this.ins.f(h[2])),i=this.FM[0],h[0]*=i,h[0]<=0?o[0]=this.FC[0][0]:h[0]>=i?o[0]=this.FC[0][i]:(s=Math.floor(h[0]),a=h[0]-s,o[0]=(3*this.FA[0][s]*a+2*this.FB[0][s])*a+this.FC[0][s]),i=this.FM[1],h[1]*=i,h[1]<=0?o[4]=this.FC[1][0]:h[1]>=i?o[4]=this.FC[1][i]:(s=Math.floor(h[1]),a=h[1]-s,o[4]=(3*this.FA[1][s]*a+2*this.FB[1][s])*a+this.FC[1][s]),i=this.FM[2],h[2]*=i,h[2]<=0?o[8]=this.FC[2][0]:h[2]>=i?o[8]=this.FC[2][i]:(s=Math.floor(h[2]),a=h[2]-s,o[8]=(3*this.FA[2][s]*a+2*this.FB[2][s])*a+this.FC[2][s]),o[0]*=i,o[1]*=i,o[2]*=i,o[3]*=i,o[4]*=i,o[5]*=i,o[6]*=i,o[7]*=i,o[8]*=i,this.sin){var r=this.ins.dRGB(t.buffer);o[0]*=r[0],o[1]*=r[1],o[2]*=r[2],o[3]*=r[0],o[4]*=r[1],o[5]*=r[2],o[6]*=r[0],o[7]*=r[1],o[8]*=r[2]}return this.fS&&(o[0]/=fLH[0],o[1]/=fLH[1],o[2]/=fLH[2],o[3]/=fLH[0],o[4]/=fLH[1],o[5]/=fLH[2],o[6]/=fLH[0],o[7]/=fLH[1],o[8]/=fLH[2]),o}return!1},LUTRGBSpline.prototype.JInv=function(t){var i=this.J(t);return 0!==i[0]&&0!==i[4]&&0!==i[8]&&new Float64Array([1/i[0],0,0,0,1/i[4],0,0,0,1/i[8]])},LUTRGBSpline.prototype.getDetails=function(t){return void 0!==t&&t?{title:this.title,format:this.format,dims:1,s:this.FM[3]+1,min:new Float64Array([this.fL[3],this.fL[3],this.fL[3]]),max:new Float64Array([this.fH[3],this.fH[3],this.fH[3]]),C:[this.FD[3].buffer],meta:this.meta}:{title:this.title,format:this.format,dims:1,s:this.FM[3]+1,min:new Float64Array([this.fL[0],this.fL[1],this.fL[2]]),max:new Float64Array([this.fH[0],this.fH[1],this.fH[2]]),C:[this.FD[0].buffer,this.FD[1].buffer,this.FD[2].buffer],meta:this.meta}},LUTRGBSpline.prototype.getL=function(){return this.FD[3].buffer},LUTRGBSpline.prototype.getRGB=function(){return[this.FD[0].buffer,this.FD[1].buffer,this.FD[2].buffer]},LUTRGBSpline.prototype.getSize=function(){return this.FM[3]+1},LUTRGBSpline.prototype.is1D=function(){return!0},LUTRGBSpline.prototype.is3D=function(){return!1},LUTRGBSpline.prototype.getTitle=function(){return this.title},LUTRGBSpline.prototype.getMetadata=function(){return this.meta},LUTRGBSpline.prototype.isClamped=function(){if(void 0===this.clamped){var t=this.minMax(),i=Math.min(t[0],t[1],t[2]),a=Math.max(t[3],t[4],t[5]);this.clamped=0===i&&a<=1||i>=0&&1===a}return this.clamped},LUTRGBSpline.prototype.deClamp=function(){if(this.isClamped()){for(var t,i,a,s,h,o,r,n,m=0;m<3;m++){a=!1,s=0,h=(t=(i=this.FD[m]).length)-1;for(var e=0;e<t;e++)e>0&&0===i[e]&&(a=!0,s=e+1);for(e=t-2;e>=0;e--)1===i[e]&&(a=!0,h=e-1);if(a){if(s>h){var p=h;h=Math.min(s-2,t-1),s=Math.max(p+2,0)}o=h-s,r=new LUTQSpline(new Float64Array(i.subarray(s,o+1)).buffer),n=this.fL[m],this.fH[m]-n;for(e=0;e<t;e++)e===s&&(e=h),i[e]=r.fCub((e-s)/o)}}this.buildMesh(),this.buildL(),this.clamped=!1}},LUTRGBSpline.prototype.getColourSpace=function(){this.d;var t=this.fL,i=this.fH,a=(this.fLH,{title:this.title+"CS",format:this.format,fLR:t[0],fLG:t[1],fLB:t[2],fHR:i[0],fHG:i[1],fHB:i[2]}),s=new LUTRSpline({buff:this.L.getL(),fH:i[3],fL:t[3]}),h=this.getRGB();return s.R(h[0]),s.R(h[1]),s.R(h[2]),a.buffR=h[0],a.buffG=h[1],a.buffB=h[2],new LUTRGBSpline(a)},LUTRGBSpline.prototype.compare=function(t,i,a){var s=new Float64Array(t.slice(0)),h=new Float64Array(i.slice(0)),o=s.length;if(o!==h.length)return!1;void 0!==a?"1"===(a=a.toString().toLowerCase())||"tet"===a?this.RGBTet(h.buffer):"2"===a||"lin"===a?this.RGBLin(h.buffer):this.RGBCub(h.buffer):this.RGBCub(h.buffer);for(var r=new Float64Array(3),n=0;n<o;n+=3)r[0]+=Math.pow(h[n]-s[n],2),r[1]+=Math.pow(h[n+1]-s[n+1],2),r[2]+=Math.pow(h[n+2]-s[n+2],2);return r[0]=Math.pow(3*r[0]/o,.5),r[1]=Math.pow(3*r[1]/o,.5),r[2]=Math.pow(3*r[2]/o,.5),r},LUTRGBSpline.prototype.minMax=function(){for(var t,i,a=new Float64Array([9999,9999,9999,-9999,-9999,-9999]),s=0;s<3;s++){i=(t=this.FD[s]).length;for(var h=0;h<i;h++)t[h]<a[s]&&(a[s]=t[h]),t[h]>a[s+3]&&(a[s+3]=t[h])}return a},LUTVolume.prototype.buildMesh=function(t,i,a){var s=new Float64Array(t),h=new Float64Array(i),o=new Float64Array(a);new Float64Array([.2126,.7152,.0722]);this.d=Math.round(Math.pow(s.length,1/3));var r=this.d;this.s=r-1;s.length;var n=r+2;this.nd=n;var m=n*n,e=m*n,p=e,l=2*p;this.mesh=new Float64Array(3*e);var u=m+n+1,L=0;this.off=new Float64Array(64);for(var f=0;f<4;f++)for(var g=0;g<4;g++)for(var c=0;c<4;c++)this.off[c+4*g+16*f]=c+g*n+f*m;for(f=0;f<r;f++){for(g=0;g<r;g++){for(c=0;c<r;c++)this.mesh[u]=s[L],this.mesh[u+p]=h[L],this.mesh[u+l]=o[L],L++,u++;u+=2}u+=2*n}this.fillEdges(),this.rgb=new Float64Array(18),this.R=new Float64Array(8),this.G=new Float64Array(8),this.B=new Float64Array(8)},LUTVolume.prototype.buildL=function(){var t=this.fL[3],i=this.fH[3],a=i-t,s=this.getSize();s<65&&(s=65);for(var h,o=new Float64Array(s),r=new Float64Array(3*s),n=r.length,m=0;m<s;m++)r[h=3*m]=m*a/(s-1)+t,r[h+1]=r[h],r[h+2]=r[h];if(this.fS)for(m=0;m<n;m+=3)r[m]=(r[m]-this.fL[0])/this.fLH[0],r[m+1]=(r[m+1]-this.fL[1])/this.fLH[1],r[m+2]=(r[m+2]-this.fL[2])/this.fLH[2];this.sin&&this.ins.FCub(r.buffer),this.RGBCub(r.buffer);for(m=0;m<s;m++)h=3*m,o[m]=r[h]*this.Y[0]+r[h+1]*this.Y[1]+r[h+2]*this.Y[2];this.L=new LUTSpline({buff:o.buffer,fH:i,fL:t})},LUTVolume.prototype.f=function(t){return this.L.f(t)},LUTVolume.prototype.df=function(t){return this.L.df(t)},LUTVolume.prototype.fCub=function(t){return this.L.fCub(t)},LUTVolume.prototype.fTet=function(t){return this.L.fLin(t)},LUTVolume.prototype.fLin=function(t){return this.L.fLin(t)},LUTVolume.prototype.FCub=function(t){this.L.FCub(t)},LUTVolume.prototype.FTet=function(t){this.L.FLin(t)},LUTVolume.prototype.FLin=function(t){this.L.FLin(t)},LUTVolume.prototype.fRGBCub=function(t){var i=new Float64Array([t,t,t]);return this.RGBCub(i.buffer),i},LUTVolume.prototype.fRGBTet=function(t){var i=new Float64Array([t,t,t]);return this.RGBTet(i.buffer),i},LUTVolume.prototype.fRGBLin=function(t){var i=new Float64Array([t,t,t]);return this.RGBLin(i.buffer),i},LUTVolume.prototype.rgbCub=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBCub(i.buffer),i},LUTVolume.prototype.rgbTet=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBTet(i.buffer),i},LUTVolume.prototype.rgbLin=function(t){var i=new Float64Array(t.buffer.slice(0));return this.RGBLin(i.buffer),i},LUTVolume.prototype.RGBCub=function(t){var i,a,s=new Float64Array(t),h=this.mesh,o=this.off,r=this.rgb,n=s.length,m=Math.round(this.mesh.length/3),e=this.s,p=e+2+1,l=this.R,u=this.G,L=this.B,f=!1,g=!1,c=!1,F=!1;if(this.fS)for(var y=this.fL,T=this.fLH,G=0;G<n;G+=3)s[G]=(s[G]-y[0])/T[0],s[G+1]=(s[G+1]-y[1])/T[1],s[G+2]=(s[G+2]-y[2])/T[2];this.sin&&this.ins.FCub(t);for(G=0;G<n;G+=3)s[G]*=e,s[G+1]*=e,s[G+2]*=e,r[9]=Math.max(0,Math.min(e-1,Math.floor(s[G]))),r[10]=Math.max(0,Math.min(e-1,Math.floor(s[G+1]))),r[11]=Math.max(0,Math.min(e-1,Math.floor(s[G+2]))),s[G]-=r[9],s[G+1]-=r[10],s[G+2]-=r[11],r[0]=Math.max(0,Math.min(1,s[G])),r[1]=Math.max(0,Math.min(1,s[G+1])),r[2]=Math.max(0,Math.min(1,s[G+2])),r[0]!==s[G]&&(g=!0,f=!0),r[1]!==s[G+1]&&(c=!0,f=!0),r[2]!==s[G+2]&&(F=!0,f=!0),r[3]=r[0]*r[0],r[4]=r[1]*r[1],r[5]=r[2]*r[2],r[6]=r[3]*r[0],r[7]=r[4]*r[1],r[8]=r[5]*r[2],l[0]=-.5*r[6]+r[3]-.5*r[0],l[1]=1.5*r[6]-2.5*r[3]+1,l[2]=-1.5*r[6]+2*r[3]+.5*r[0],l[3]=.5*r[6]-.5*r[3],u[0]=-.5*r[7]+r[4]-.5*r[1],u[1]=1.5*r[7]-2.5*r[4]+1,u[2]=-1.5*r[7]+2*r[4]+.5*r[1],u[3]=.5*r[7]-.5*r[4],L[0]=-.5*r[8]+r[5]-.5*r[2],L[1]=1.5*r[8]-2.5*r[5]+1,L[2]=-1.5*r[8]+2*r[5]+.5*r[2],L[3]=.5*r[8]-.5*r[5],g&&(r[12]=s[G]-r[0]),c&&(r[13]=s[G+1]-r[1]),F&&(r[14]=s[G+2]-r[2]),i=a=r[9]+(r[10]+r[11]*p)*p,s[G]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[3],i+=m,s[G+1]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[3],i+=m,s[G+2]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[3],f&&(g&&(l[4]=-1.5*r[3]+2*r[0]-.5,l[5]=4.5*r[3]-5*r[0],l[6]=-4.5*r[3]+4*r[0]+.5,l[7]=1.5*r[3]-r[0],i=a,r[15]=((l[4]*h[i+o[0]]+l[5]*h[i+o[1]]+l[6]*h[i+o[2]]+l[7]*h[i+o[3]])*u[0]+(l[4]*h[i+o[4]]+l[5]*h[i+o[5]]+l[6]*h[i+o[6]]+l[7]*h[i+o[7]])*u[1]+(l[4]*h[i+o[8]]+l[5]*h[i+o[9]]+l[6]*h[i+o[10]]+l[7]*h[i+o[11]])*u[2]+(l[4]*h[i+o[12]]+l[5]*h[i+o[13]]+l[6]*h[i+o[14]]+l[7]*h[i+o[15]])*u[3])*L[0]+((l[4]*h[i+o[16]]+l[5]*h[i+o[17]]+l[6]*h[i+o[18]]+l[7]*h[i+o[19]])*u[0]+(l[4]*h[i+o[20]]+l[5]*h[i+o[21]]+l[6]*h[i+o[22]]+l[7]*h[i+o[23]])*u[1]+(l[4]*h[i+o[24]]+l[5]*h[i+o[25]]+l[6]*h[i+o[26]]+l[7]*h[i+o[27]])*u[2]+(l[4]*h[i+o[28]]+l[5]*h[i+o[29]]+l[6]*h[i+o[30]]+l[7]*h[i+o[31]])*u[3])*L[1]+((l[4]*h[i+o[32]]+l[5]*h[i+o[33]]+l[6]*h[i+o[34]]+l[7]*h[i+o[35]])*u[0]+(l[4]*h[i+o[36]]+l[5]*h[i+o[37]]+l[6]*h[i+o[38]]+l[7]*h[i+o[39]])*u[1]+(l[4]*h[i+o[40]]+l[5]*h[i+o[41]]+l[6]*h[i+o[42]]+l[7]*h[i+o[43]])*u[2]+(l[4]*h[i+o[44]]+l[5]*h[i+o[45]]+l[6]*h[i+o[46]]+l[7]*h[i+o[47]])*u[3])*L[2]+((l[4]*h[i+o[48]]+l[5]*h[i+o[49]]+l[6]*h[i+o[50]]+l[7]*h[i+o[51]])*u[0]+(l[4]*h[i+o[52]]+l[5]*h[i+o[53]]+l[6]*h[i+o[54]]+l[7]*h[i+o[55]])*u[1]+(l[4]*h[i+o[56]]+l[5]*h[i+o[57]]+l[6]*h[i+o[58]]+l[7]*h[i+o[59]])*u[2]+(l[4]*h[i+o[60]]+l[5]*h[i+o[61]]+l[6]*h[i+o[62]]+l[7]*h[i+o[63]])*u[3])*L[3],i+=m,r[16]=((l[4]*h[i+o[0]]+l[5]*h[i+o[1]]+l[6]*h[i+o[2]]+l[7]*h[i+o[3]])*u[0]+(l[4]*h[i+o[4]]+l[5]*h[i+o[5]]+l[6]*h[i+o[6]]+l[7]*h[i+o[7]])*u[1]+(l[4]*h[i+o[8]]+l[5]*h[i+o[9]]+l[6]*h[i+o[10]]+l[7]*h[i+o[11]])*u[2]+(l[4]*h[i+o[12]]+l[5]*h[i+o[13]]+l[6]*h[i+o[14]]+l[7]*h[i+o[15]])*u[3])*L[0]+((l[4]*h[i+o[16]]+l[5]*h[i+o[17]]+l[6]*h[i+o[18]]+l[7]*h[i+o[19]])*u[0]+(l[4]*h[i+o[20]]+l[5]*h[i+o[21]]+l[6]*h[i+o[22]]+l[7]*h[i+o[23]])*u[1]+(l[4]*h[i+o[24]]+l[5]*h[i+o[25]]+l[6]*h[i+o[26]]+l[7]*h[i+o[27]])*u[2]+(l[4]*h[i+o[28]]+l[5]*h[i+o[29]]+l[6]*h[i+o[30]]+l[7]*h[i+o[31]])*u[3])*L[1]+((l[4]*h[i+o[32]]+l[5]*h[i+o[33]]+l[6]*h[i+o[34]]+l[7]*h[i+o[35]])*u[0]+(l[4]*h[i+o[36]]+l[5]*h[i+o[37]]+l[6]*h[i+o[38]]+l[7]*h[i+o[39]])*u[1]+(l[4]*h[i+o[40]]+l[5]*h[i+o[41]]+l[6]*h[i+o[42]]+l[7]*h[i+o[43]])*u[2]+(l[4]*h[i+o[44]]+l[5]*h[i+o[45]]+l[6]*h[i+o[46]]+l[7]*h[i+o[47]])*u[3])*L[2]+((l[4]*h[i+o[48]]+l[5]*h[i+o[49]]+l[6]*h[i+o[50]]+l[7]*h[i+o[51]])*u[0]+(l[4]*h[i+o[52]]+l[5]*h[i+o[53]]+l[6]*h[i+o[54]]+l[7]*h[i+o[55]])*u[1]+(l[4]*h[i+o[56]]+l[5]*h[i+o[57]]+l[6]*h[i+o[58]]+l[7]*h[i+o[59]])*u[2]+(l[4]*h[i+o[60]]+l[5]*h[i+o[61]]+l[6]*h[i+o[62]]+l[7]*h[i+o[63]])*u[3])*L[3],i+=m,r[27]=((l[4]*h[i+o[0]]+l[5]*h[i+o[1]]+l[6]*h[i+o[2]]+l[7]*h[i+o[3]])*u[0]+(l[4]*h[i+o[4]]+l[5]*h[i+o[5]]+l[6]*h[i+o[6]]+l[7]*h[i+o[7]])*u[1]+(l[4]*h[i+o[8]]+l[5]*h[i+o[9]]+l[6]*h[i+o[10]]+l[7]*h[i+o[11]])*u[2]+(l[4]*h[i+o[12]]+l[5]*h[i+o[13]]+l[6]*h[i+o[14]]+l[7]*h[i+o[15]])*u[3])*L[0]+((l[4]*h[i+o[16]]+l[5]*h[i+o[17]]+l[6]*h[i+o[18]]+l[7]*h[i+o[19]])*u[0]+(l[4]*h[i+o[20]]+l[5]*h[i+o[21]]+l[6]*h[i+o[22]]+l[7]*h[i+o[23]])*u[1]+(l[4]*h[i+o[24]]+l[5]*h[i+o[25]]+l[6]*h[i+o[26]]+l[7]*h[i+o[27]])*u[2]+(l[4]*h[i+o[28]]+l[5]*h[i+o[29]]+l[6]*h[i+o[30]]+l[7]*h[i+o[31]])*u[3])*L[1]+((l[4]*h[i+o[32]]+l[5]*h[i+o[33]]+l[6]*h[i+o[34]]+l[7]*h[i+o[35]])*u[0]+(l[4]*h[i+o[36]]+l[5]*h[i+o[37]]+l[6]*h[i+o[38]]+l[7]*h[i+o[39]])*u[1]+(l[4]*h[i+o[40]]+l[5]*h[i+o[41]]+l[6]*h[i+o[42]]+l[7]*h[i+o[43]])*u[2]+(l[4]*h[i+o[44]]+l[5]*h[i+o[45]]+l[6]*h[i+o[46]]+l[7]*h[i+o[47]])*u[3])*L[2]+((l[4]*h[i+o[48]]+l[5]*h[i+o[49]]+l[6]*h[i+o[50]]+l[7]*h[i+o[51]])*u[0]+(l[4]*h[i+o[52]]+l[5]*h[i+o[53]]+l[6]*h[i+o[54]]+l[7]*h[i+o[55]])*u[1]+(l[4]*h[i+o[56]]+l[5]*h[i+o[57]]+l[6]*h[i+o[58]]+l[7]*h[i+o[59]])*u[2]+(l[4]*h[i+o[60]]+l[5]*h[i+o[61]]+l[6]*h[i+o[62]]+l[7]*h[i+o[63]])*u[3])*L[3],s[G]+=r[12]*r[15],s[G+1]+=r[12]*r[16],s[G+2]+=r[12]*r[17]),c&&(u[4]=-1.5*r[4]+2*r[1]-.5,u[5]=4.5*r[4]-5*r[1],u[6]=-4.5*r[4]+4*r[1]+.5,u[7]=1.5*r[4]-r[1],i=a,r[15]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[4]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[5]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[6]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[7])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[4]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[5]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[6]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[7])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[4]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[5]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[6]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[7])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[4]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[5]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[6]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[7])*L[3],i+=m,r[16]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[4]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[5]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[6]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[7])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[4]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[5]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[6]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[7])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[4]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[5]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[6]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[7])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[4]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[5]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[6]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[7])*L[3],i+=m,r[17]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[4]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[5]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[6]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[7])*L[0]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[4]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[5]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[6]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[7])*L[1]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[4]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[5]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[6]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[7])*L[2]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[4]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[5]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[6]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[7])*L[3],s[G]+=r[13]*r[15],s[G+1]+=r[13]*r[16],s[G+2]+=r[13]*r[17]),F&&(L[4]=-1.5*r[5]+2*r[2]-.5,L[5]=4.5*r[5]-5*r[2],L[6]=-4.5*r[5]+4*r[2]+.5,L[7]=1.5*r[5]-r[2],i=a,r[15]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[4]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[5]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[6]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[7],i+=m,r[16]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[4]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[5]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[6]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[7],i+=m,r[17]=((l[0]*h[i+o[0]]+l[1]*h[i+o[1]]+l[2]*h[i+o[2]]+l[3]*h[i+o[3]])*u[0]+(l[0]*h[i+o[4]]+l[1]*h[i+o[5]]+l[2]*h[i+o[6]]+l[3]*h[i+o[7]])*u[1]+(l[0]*h[i+o[8]]+l[1]*h[i+o[9]]+l[2]*h[i+o[10]]+l[3]*h[i+o[11]])*u[2]+(l[0]*h[i+o[12]]+l[1]*h[i+o[13]]+l[2]*h[i+o[14]]+l[3]*h[i+o[15]])*u[3])*L[4]+((l[0]*h[i+o[16]]+l[1]*h[i+o[17]]+l[2]*h[i+o[18]]+l[3]*h[i+o[19]])*u[0]+(l[0]*h[i+o[20]]+l[1]*h[i+o[21]]+l[2]*h[i+o[22]]+l[3]*h[i+o[23]])*u[1]+(l[0]*h[i+o[24]]+l[1]*h[i+o[25]]+l[2]*h[i+o[26]]+l[3]*h[i+o[27]])*u[2]+(l[0]*h[i+o[28]]+l[1]*h[i+o[29]]+l[2]*h[i+o[30]]+l[3]*h[i+o[31]])*u[3])*L[5]+((l[0]*h[i+o[32]]+l[1]*h[i+o[33]]+l[2]*h[i+o[34]]+l[3]*h[i+o[35]])*u[0]+(l[0]*h[i+o[36]]+l[1]*h[i+o[37]]+l[2]*h[i+o[38]]+l[3]*h[i+o[39]])*u[1]+(l[0]*h[i+o[40]]+l[1]*h[i+o[41]]+l[2]*h[i+o[42]]+l[3]*h[i+o[43]])*u[2]+(l[0]*h[i+o[44]]+l[1]*h[i+o[45]]+l[2]*h[i+o[46]]+l[3]*h[i+o[47]])*u[3])*L[6]+((l[0]*h[i+o[48]]+l[1]*h[i+o[49]]+l[2]*h[i+o[50]]+l[3]*h[i+o[51]])*u[0]+(l[0]*h[i+o[52]]+l[1]*h[i+o[53]]+l[2]*h[i+o[54]]+l[3]*h[i+o[55]])*u[1]+(l[0]*h[i+o[56]]+l[1]*h[i+o[57]]+l[2]*h[i+o[58]]+l[3]*h[i+o[59]])*u[2]+(l[0]*h[i+o[60]]+l[1]*h[i+o[61]]+l[2]*h[i+o[62]]+l[3]*h[i+o[63]])*u[3])*L[7],s[G]+=r[14]*r[15],s[G+1]+=r[14]*r[16],s[G+2]+=r[14]*r[17]),f=!1,g=!1,c=!1,F=!1)},LUTVolume.prototype.RGBTet=function(t){var i,a,s=new Float64Array(t),h=this.mesh,o=this.off,r=this.rgb,n=s.length,m=Math.round(this.mesh.length/3),e=this.s,p=e+2+1,l=this.R,u=this.G,L=this.B,f=!1,g=!1,c=!1,F=!1;if(this.fS)for(var y=this.fL,T=this.fLH,G=0;G<n;G+=3)s[G]=(s[G]-y[0])/T[0],s[G+1]=(s[G+1]-y[1])/T[1],s[G+2]=(s[G+2]-y[2])/T[2];this.sin&&this.ins.FCub(t);for(G=0;G<n;G+=3){switch(s[G]*=e,s[G+1]*=e,s[G+2]*=e,r[9]=Math.max(0,Math.min(e-1,Math.floor(s[G]))),r[10]=Math.max(0,Math.min(e-1,Math.floor(s[G+1]))),r[11]=Math.max(0,Math.min(e-1,Math.floor(s[G+2]))),s[G]-=r[9],s[G+1]-=r[10],s[G+2]-=r[11],r[0]=Math.max(0,Math.min(1,s[G])),r[1]=Math.max(0,Math.min(1,s[G+1])),r[2]=Math.max(0,Math.min(1,s[G+2])),r[0]!==s[G]&&(g=!0,f=!0),r[1]!==s[G+1]&&(c=!0,f=!0),r[2]!==s[G+2]&&(F=!0,f=!0),g&&(r[12]=s[G]-r[0]),c&&(r[13]=s[G+1]-r[1]),F&&(r[14]=s[G+2]-r[2]),i=a=r[9]+(r[10]+r[11]*p)*p,(r[0]>r[1])+2*(r[1]>r[2])+4*(r[2]>r[0])){case 0:s[G]=(1-r[0])*h[i+o[21]]+r[0]*h[i+o[42]],i+=m,s[G+1]=(1-r[1])*h[i+o[21]]+r[1]*h[i+o[42]],i+=m,s[G+2]=(1-r[2])*h[i+o[21]]+r[2]*h[i+o[42]];break;case 1:s[G]=(1-r[0])*h[i+o[21]]+(r[0]-r[2])*h[i+o[22]]+(r[2]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]],i+=m,s[G+1]=(1-r[0])*h[i+o[21]]+(r[0]-r[2])*h[i+o[22]]+(r[2]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]],i+=m,s[G+2]=(1-r[0])*h[i+o[21]]+(r[0]-r[2])*h[i+o[22]]+(r[2]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]];break;case 2:s[G]=(1-r[1])*h[i+o[21]]+(r[1]-r[0])*h[i+o[25]]+(r[0]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]],i+=m,s[G+1]=(1-r[1])*h[i+o[21]]+(r[1]-r[0])*h[i+o[25]]+(r[0]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]],i+=m,s[G+2]=(1-r[1])*h[i+o[21]]+(r[1]-r[0])*h[i+o[25]]+(r[0]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]];break;case 3:s[G]=(1-r[0])*h[i+o[21]]+(r[0]-r[1])*h[i+o[22]]+(r[1]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]],i+=m,s[G+1]=(1-r[0])*h[i+o[21]]+(r[0]-r[1])*h[i+o[22]]+(r[1]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]],i+=m,s[G+2]=(1-r[0])*h[i+o[21]]+(r[0]-r[1])*h[i+o[22]]+(r[1]-r[2])*h[i+o[26]]+r[2]*h[i+o[42]];break;case 4:s[G]=(1-r[2])*h[i+o[21]]+(r[2]-r[1])*h[i+o[37]]+(r[1]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]],i+=m,s[G+1]=(1-r[2])*h[i+o[21]]+(r[2]-r[1])*h[i+o[37]]+(r[1]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]],i+=m,s[G+2]=(1-r[2])*h[i+o[21]]+(r[2]-r[1])*h[i+o[37]]+(r[1]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]];break;case 5:s[G]=(1-r[2])*h[i+o[21]]+(r[2]-r[0])*h[i+o[37]]+(r[0]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]],i+=m,s[G+1]=(1-r[2])*h[i+o[21]]+(r[2]-r[0])*h[i+o[37]]+(r[0]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]],i+=m,s[G+2]=(1-r[2])*h[i+o[21]]+(r[2]-r[0])*h[i+o[37]]+(r[0]-r[1])*h[i+o[38]]+r[1]*h[i+o[42]];break;case 6:s[G]=(1-r[1])*h[i+o[21]]+(r[1]-r[2])*h[i+o[25]]+(r[2]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]],i+=m,s[G+1]=(1-r[1])*h[i+o[21]]+(r[1]-r[2])*h[i+o[25]]+(r[2]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]],i+=m,s[G+2]=(1-r[1])*h[i+o[21]]+(r[1]-r[2])*h[i+o[25]]+(r[2]-r[0])*h[i+o[41]]+r[0]*h[i+o[42]];break;default:s[G]=(((1-r[0])*h[i+o[21]]+r[0]*h[i+o[22]])*(1-r[1])+((1-r[0])*h[i+o[25]]+r[0]*h[i+o[26]])*r[1])*(1-r[2])+(((1-r[0])*h[i+o[37]]+r[0]*h[i+o[38]])*(1-r[1])+((1-r[0])*h[i+o[41]]+r[0]*h[i+o[42]])*r[1])*r[2],i+=m,s[G+1]=(((1-r[0])*h[i+o[21]]+r[0]*h[i+o[22]])*(1-r[1])+((1-r[0])*h[i+o[25]]+r[0]*h[i+o[26]])*r[1])*(1-r[2])+(((1-r[0])*h[i+o[37]]+r[0]*h[i+o[38]])*(1-r[1])+((1-r[0])*h[i+o[41]]+r[0]*h[i+o[42]])*r[1])*r[2],i+=m,s[G+2]=(((1-r[0])*h[i+o[21]]+r[0]*h[i+o[22]])*(1-r[1])+((1-r[0])*h[i+o[25]]+r[0]*h[i+o[26]])*r[1])*(1-r[2])+(((1-r[0])*h[i+o[37]]+r[0]*h[i+o[38]])*(1-r[1])+((1-r[0])*h[i+o[41]]+r[0]*h[i+o[42]])*r[1])*r[2]}f&&(l[0]=1-r[0],l[1]=r[0],u[0]=1-r[1],u[1]=r[1],L[0]=1-r[2],L[1]=r[2],g&&(i=a,r[15]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],i+=m,r[16]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],i+=m,r[17]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],s[G]+=r[12]*r[15],s[G+1]+=r[12]*r[16],s[G+2]+=r[12]*r[17]),c&&(i=a,r[15]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],i+=m,r[16]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],i+=m,r[17]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],s[G]+=r[13]*r[15],s[G+1]+=r[13]*r[16],s[G+2]+=r[13]*r[17]),F&&(i=a,r[15]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],i+=m,r[16]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],i+=m,r[17]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],s[G]+=r[14]*r[15],s[G+1]+=r[14]*r[16],s[G+2]+=r[14]*r[17]),f=!1,g=!1,c=!1,F=!1)}},LUTVolume.prototype.RGBLin=function(t){var i,a,s=new Float64Array(t),h=this.mesh,o=this.off,r=this.rgb,n=s.length,m=Math.round(this.mesh.length/3),e=this.s,p=e+2+1,l=this.R,u=this.G,L=this.B,f=!1,g=!1,c=!1,F=!1;if(this.fS)for(var y=this.fL,T=this.fLH,G=0;G<n;G+=3)s[G]=(s[G]-y[0])/T[0],s[G+1]=(s[G+1]-y[1])/T[1],s[G+2]=(s[G+2]-y[2])/T[2];this.sin&&this.ins.FCub(t);for(G=0;G<n;G+=3)s[G]*=e,s[G+1]*=e,s[G+2]*=e,r[9]=Math.max(0,Math.min(e-1,Math.floor(s[G]))),r[10]=Math.max(0,Math.min(e-1,Math.floor(s[G+1]))),r[11]=Math.max(0,Math.min(e-1,Math.floor(s[G+2]))),s[G]-=r[9],s[G+1]-=r[10],s[G+2]-=r[11],r[0]=Math.max(0,Math.min(1,s[G])),r[1]=Math.max(0,Math.min(1,s[G+1])),r[2]=Math.max(0,Math.min(1,s[G+2])),r[0]!==s[G]&&(g=!0,f=!0),r[1]!==s[G+1]&&(c=!0,f=!0),r[2]!==s[G+2]&&(F=!0,f=!0),l[0]=1-r[0],l[1]=r[0],u[0]=1-r[1],u[1]=r[1],L[0]=1-r[2],L[1]=r[2],g&&(r[12]=s[G]-r[0]),c&&(r[13]=s[G+1]-r[1]),F&&(r[14]=s[G+2]-r[2]),i=a=r[9]+(r[10]+r[11]*p)*p,s[G]=((l[0]*h[i+o[21]]+l[1]*h[i+o[22]])*u[0]+(l[0]*h[i+o[25]]+l[1]*h[i+o[26]])*u[1])*L[0]+((l[0]*h[i+o[37]]+l[1]*h[i+o[38]])*u[0]+(l[0]*h[i+o[41]]+l[1]*h[i+o[42]])*u[1])*L[1],i+=m,s[G+1]=((l[0]*h[i+o[21]]+l[1]*h[i+o[22]])*u[0]+(l[0]*h[i+o[25]]+l[1]*h[i+o[26]])*u[1])*L[0]+((l[0]*h[i+o[37]]+l[1]*h[i+o[38]])*u[0]+(l[0]*h[i+o[41]]+l[1]*h[i+o[42]])*u[1])*L[1],i+=m,s[G+2]=((l[0]*h[i+o[21]]+l[1]*h[i+o[22]])*u[0]+(l[0]*h[i+o[25]]+l[1]*h[i+o[26]])*u[1])*L[0]+((l[0]*h[i+o[37]]+l[1]*h[i+o[38]])*u[0]+(l[0]*h[i+o[41]]+l[1]*h[i+o[42]])*u[1])*L[1],f&&(g&&(i=a,r[15]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],i+=m,r[16]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],i+=m,r[17]=((h[i+o[22]]-h[i+o[21]])*u[0]+(h[i+o[26]]-h[i+o[25]])*u[1])*L[0]+((h[i+o[38]]-h[i+o[37]])*u[0]+(h[i+o[42]]-h[i+o[41]])*u[1])*L[1],s[G]+=r[12]*r[15],s[G+1]+=r[12]*r[16],s[G+2]+=r[12]*r[17]),c&&(i=a,r[15]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],i+=m,r[16]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],i+=m,r[17]=((h[i+o[25]]-h[i+o[21]])*l[0]+(h[i+o[26]]-h[i+o[22]])*l[1])*L[0]+((h[i+o[41]]-h[i+o[37]])*l[0]+(h[i+o[42]]-h[i+o[38]])*l[1])*L[1],s[G]+=r[13]*r[15],s[G+1]+=r[13]*r[16],s[G+2]+=r[13]*r[17]),F&&(i=a,r[15]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],i+=m,r[16]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],i+=m,r[17]=((h[i+o[37]]-h[i+o[21]])*l[0]+(h[i+o[38]]-h[i+o[22]])*l[1])*u[0]+((h[i+o[41]]-h[i+o[25]])*l[0]+(h[i+o[42]]-h[i+o[26]])*l[1])*u[1],s[G]+=r[14]*r[15],s[G+1]+=r[14]*r[16],s[G+2]+=r[14]*r[17]),f=!1,g=!1,c=!1,F=!1)},LUTVolume.prototype.J=function(t){if(3===t.length){var i,a,s=new Float64Array(t.buffer.slice(0)),h=new Float64Array(9),o=this.mesh,r=this.off,n=this.s,e=this.rgb,p=this.R,l=this.G,u=this.B,L=n+2+1,f=this.fL,g=this.fLH;if(this.fS)for(var c=0;c<m;c+=3)s[0]=(s[0]-f[0])/g[0],s[1]=(s[1]-f[1])/g[1],s[2]=(s[2]-f[2])/g[2];if(this.sin&&this.ins.FCub(s.buffer),s[0]*=n,s[1]*=n,s[2]*=n,e[9]=Math.max(0,Math.min(n-1,Math.floor(s[c]))),e[10]=Math.max(0,Math.min(n-1,Math.floor(s[c+1]))),e[11]=Math.max(0,Math.min(n-1,Math.floor(s[c+2]))),s[0]-=e[9],s[1]-=e[10],s[2]-=e[11],e[0]=Math.max(0,Math.min(1,s[0])),e[1]=Math.max(0,Math.min(1,s[1])),e[2]=Math.max(0,Math.min(1,s[2])),e[3]=e[0]*e[0],e[4]=e[1]*e[1],e[5]=e[2]*e[2],e[6]=e[3]*e[0],e[7]=e[4]*e[1],e[8]=e[5]*e[2],p[0]=-.5*e[6]+e[3]-.5*e[0],p[1]=1.5*e[6]-2.5*e[3]+1,p[2]=-1.5*e[6]+2*e[3]+.5*e[0],p[3]=.5*e[6]-.5*e[3],l[0]=-.5*e[7]+e[4]-.5*e[1],l[1]=1.5*e[7]-2.5*e[4]+1,l[2]=-1.5*e[7]+2*e[4]+.5*e[1],l[3]=.5*e[7]-.5*e[4],u[0]=-.5*e[8]+e[5]-.5*e[2],u[1]=1.5*e[8]-2.5*e[5]+1,u[2]=-1.5*e[8]+2*e[5]+.5*e[2],u[3]=.5*e[8]-.5*e[5],i=e[9]+(e[10]+e[11]*L)*L,p[4]=-1.5*e[3]+2*e[0]-.5,p[5]=4.5*e[3]-5*e[0],p[6]=-4.5*e[3]+4*e[0]+.5,p[7]=1.5*e[3]-e[0],a=i,h[0]=((p[4]*o[a+r[0]]+p[5]*o[a+r[1]]+p[6]*o[a+r[2]]+p[7]*o[a+r[3]])*l[0]+(p[4]*o[a+r[4]]+p[5]*o[a+r[5]]+p[6]*o[a+r[6]]+p[7]*o[a+r[7]])*l[1]+(p[4]*o[a+r[8]]+p[5]*o[a+r[9]]+p[6]*o[a+r[10]]+p[7]*o[a+r[11]])*l[2]+(p[4]*o[a+r[12]]+p[5]*o[a+r[13]]+p[6]*o[a+r[14]]+p[7]*o[a+r[15]])*l[3])*u[0]+((p[4]*o[a+r[16]]+p[5]*o[a+r[17]]+p[6]*o[a+r[18]]+p[7]*o[a+r[19]])*l[0]+(p[4]*o[a+r[20]]+p[5]*o[a+r[21]]+p[6]*o[a+r[22]]+p[7]*o[a+r[23]])*l[1]+(p[4]*o[a+r[24]]+p[5]*o[a+r[25]]+p[6]*o[a+r[26]]+p[7]*o[a+r[27]])*l[2]+(p[4]*o[a+r[28]]+p[5]*o[a+r[29]]+p[6]*o[a+r[30]]+p[7]*o[a+r[31]])*l[3])*u[1]+((p[4]*o[a+r[32]]+p[5]*o[a+r[33]]+p[6]*o[a+r[34]]+p[7]*o[a+r[35]])*l[0]+(p[4]*o[a+r[36]]+p[5]*o[a+r[37]]+p[6]*o[a+r[38]]+p[7]*o[a+r[39]])*l[1]+(p[4]*o[a+r[40]]+p[5]*o[a+r[41]]+p[6]*o[a+r[42]]+p[7]*o[a+r[43]])*l[2]+(p[4]*o[a+r[44]]+p[5]*o[a+r[45]]+p[6]*o[a+r[46]]+p[7]*o[a+r[47]])*l[3])*u[2]+((p[4]*o[a+r[48]]+p[5]*o[a+r[49]]+p[6]*o[a+r[50]]+p[7]*o[a+r[51]])*l[0]+(p[4]*o[a+r[52]]+p[5]*o[a+r[53]]+p[6]*o[a+r[54]]+p[7]*o[a+r[55]])*l[1]+(p[4]*o[a+r[56]]+p[5]*o[a+r[57]]+p[6]*o[a+r[58]]+p[7]*o[a+r[59]])*l[2]+(p[4]*o[a+r[60]]+p[5]*o[a+r[61]]+p[6]*o[a+r[62]]+p[7]*o[a+r[63]])*l[3])*u[3],a+=mm,h[3]=((p[4]*o[a+r[0]]+p[5]*o[a+r[1]]+p[6]*o[a+r[2]]+p[7]*o[a+r[3]])*l[0]+(p[4]*o[a+r[4]]+p[5]*o[a+r[5]]+p[6]*o[a+r[6]]+p[7]*o[a+r[7]])*l[1]+(p[4]*o[a+r[8]]+p[5]*o[a+r[9]]+p[6]*o[a+r[10]]+p[7]*o[a+r[11]])*l[2]+(p[4]*o[a+r[12]]+p[5]*o[a+r[13]]+p[6]*o[a+r[14]]+p[7]*o[a+r[15]])*l[3])*u[0]+((p[4]*o[a+r[16]]+p[5]*o[a+r[17]]+p[6]*o[a+r[18]]+p[7]*o[a+r[19]])*l[0]+(p[4]*o[a+r[20]]+p[5]*o[a+r[21]]+p[6]*o[a+r[22]]+p[7]*o[a+r[23]])*l[1]+(p[4]*o[a+r[24]]+p[5]*o[a+r[25]]+p[6]*o[a+r[26]]+p[7]*o[a+r[27]])*l[2]+(p[4]*o[a+r[28]]+p[5]*o[a+r[29]]+p[6]*o[a+r[30]]+p[7]*o[a+r[31]])*l[3])*u[1]+((p[4]*o[a+r[32]]+p[5]*o[a+r[33]]+p[6]*o[a+r[34]]+p[7]*o[a+r[35]])*l[0]+(p[4]*o[a+r[36]]+p[5]*o[a+r[37]]+p[6]*o[a+r[38]]+p[7]*o[a+r[39]])*l[1]+(p[4]*o[a+r[40]]+p[5]*o[a+r[41]]+p[6]*o[a+r[42]]+p[7]*o[a+r[43]])*l[2]+(p[4]*o[a+r[44]]+p[5]*o[a+r[45]]+p[6]*o[a+r[46]]+p[7]*o[a+r[47]])*l[3])*u[2]+((p[4]*o[a+r[48]]+p[5]*o[a+r[49]]+p[6]*o[a+r[50]]+p[7]*o[a+r[51]])*l[0]+(p[4]*o[a+r[52]]+p[5]*o[a+r[53]]+p[6]*o[a+r[54]]+p[7]*o[a+r[55]])*l[1]+(p[4]*o[a+r[56]]+p[5]*o[a+r[57]]+p[6]*o[a+r[58]]+p[7]*o[a+r[59]])*l[2]+(p[4]*o[a+r[60]]+p[5]*o[a+r[61]]+p[6]*o[a+r[62]]+p[7]*o[a+r[63]])*l[3])*u[3],a+=mm,h[6]=((p[4]*o[a+r[0]]+p[5]*o[a+r[1]]+p[6]*o[a+r[2]]+p[7]*o[a+r[3]])*l[0]+(p[4]*o[a+r[4]]+p[5]*o[a+r[5]]+p[6]*o[a+r[6]]+p[7]*o[a+r[7]])*l[1]+(p[4]*o[a+r[8]]+p[5]*o[a+r[9]]+p[6]*o[a+r[10]]+p[7]*o[a+r[11]])*l[2]+(p[4]*o[a+r[12]]+p[5]*o[a+r[13]]+p[6]*o[a+r[14]]+p[7]*o[a+r[15]])*l[3])*u[0]+((p[4]*o[a+r[16]]+p[5]*o[a+r[17]]+p[6]*o[a+r[18]]+p[7]*o[a+r[19]])*l[0]+(p[4]*o[a+r[20]]+p[5]*o[a+r[21]]+p[6]*o[a+r[22]]+p[7]*o[a+r[23]])*l[1]+(p[4]*o[a+r[24]]+p[5]*o[a+r[25]]+p[6]*o[a+r[26]]+p[7]*o[a+r[27]])*l[2]+(p[4]*o[a+r[28]]+p[5]*o[a+r[29]]+p[6]*o[a+r[30]]+p[7]*o[a+r[31]])*l[3])*u[1]+((p[4]*o[a+r[32]]+p[5]*o[a+r[33]]+p[6]*o[a+r[34]]+p[7]*o[a+r[35]])*l[0]+(p[4]*o[a+r[36]]+p[5]*o[a+r[37]]+p[6]*o[a+r[38]]+p[7]*o[a+r[39]])*l[1]+(p[4]*o[a+r[40]]+p[5]*o[a+r[41]]+p[6]*o[a+r[42]]+p[7]*o[a+r[43]])*l[2]+(p[4]*o[a+r[44]]+p[5]*o[a+r[45]]+p[6]*o[a+r[46]]+p[7]*o[a+r[47]])*l[3])*u[2]+((p[4]*o[a+r[48]]+p[5]*o[a+r[49]]+p[6]*o[a+r[50]]+p[7]*o[a+r[51]])*l[0]+(p[4]*o[a+r[52]]+p[5]*o[a+r[53]]+p[6]*o[a+r[54]]+p[7]*o[a+r[55]])*l[1]+(p[4]*o[a+r[56]]+p[5]*o[a+r[57]]+p[6]*o[a+r[58]]+p[7]*o[a+r[59]])*l[2]+(p[4]*o[a+r[60]]+p[5]*o[a+r[61]]+p[6]*o[a+r[62]]+p[7]*o[a+r[63]])*l[3])*u[3],l[4]=-1.5*e[4]+2*e[1]-.5,l[5]=4.5*e[4]-5*e[1],l[6]=-4.5*e[4]+4*e[1]+.5,l[7]=1.5*e[4]-e[1],a=i,h[1]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[4]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[5]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[6]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[7])*u[0]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[4]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[5]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[6]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[7])*u[1]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[4]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[5]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[6]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[7])*u[2]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[4]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[5]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[6]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[7])*u[3],a+=mm,h[4]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[4]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[5]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[6]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[7])*u[0]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[4]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[5]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[6]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[7])*u[1]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[4]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[5]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[6]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[7])*u[2]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[4]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[5]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[6]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[7])*u[3],a+=mm,h[7]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[4]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[5]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[6]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[7])*u[0]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[4]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[5]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[6]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[7])*u[1]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[4]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[5]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[6]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[7])*u[2]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[4]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[5]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[6]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[7])*u[3],u[4]=-1.5*e[5]+2*e[2]-.5,u[5]=4.5*e[5]-5*e[2],u[6]=-4.5*e[5]+4*e[2]+.5,u[7]=1.5*e[5]-e[2],a=i,h[2]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[0]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[1]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[2]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[3])*u[4]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[0]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[1]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[2]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[3])*u[5]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[0]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[1]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[2]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[3])*u[6]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[0]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[1]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[2]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[3])*u[7],a+=mm,h[5]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[0]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[1]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[2]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[3])*u[4]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[0]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[1]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[2]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[3])*u[5]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[0]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[1]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[2]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[3])*u[6]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[0]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[1]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[2]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[3])*u[7],a+=mm,h[8]=((p[0]*o[a+r[0]]+p[1]*o[a+r[1]]+p[2]*o[a+r[2]]+p[3]*o[a+r[3]])*l[0]+(p[0]*o[a+r[4]]+p[1]*o[a+r[5]]+p[2]*o[a+r[6]]+p[3]*o[a+r[7]])*l[1]+(p[0]*o[a+r[8]]+p[1]*o[a+r[9]]+p[2]*o[a+r[10]]+p[3]*o[a+r[11]])*l[2]+(p[0]*o[a+r[12]]+p[1]*o[a+r[13]]+p[2]*o[a+r[14]]+p[3]*o[a+r[15]])*l[3])*u[4]+((p[0]*o[a+r[16]]+p[1]*o[a+r[17]]+p[2]*o[a+r[18]]+p[3]*o[a+r[19]])*l[0]+(p[0]*o[a+r[20]]+p[1]*o[a+r[21]]+p[2]*o[a+r[22]]+p[3]*o[a+r[23]])*l[1]+(p[0]*o[a+r[24]]+p[1]*o[a+r[25]]+p[2]*o[a+r[26]]+p[3]*o[a+r[27]])*l[2]+(p[0]*o[a+r[28]]+p[1]*o[a+r[29]]+p[2]*o[a+r[30]]+p[3]*o[a+r[31]])*l[3])*u[5]+((p[0]*o[a+r[32]]+p[1]*o[a+r[33]]+p[2]*o[a+r[34]]+p[3]*o[a+r[35]])*l[0]+(p[0]*o[a+r[36]]+p[1]*o[a+r[37]]+p[2]*o[a+r[38]]+p[3]*o[a+r[39]])*l[1]+(p[0]*o[a+r[40]]+p[1]*o[a+r[41]]+p[2]*o[a+r[42]]+p[3]*o[a+r[43]])*l[2]+(p[0]*o[a+r[44]]+p[1]*o[a+r[45]]+p[2]*o[a+r[46]]+p[3]*o[a+r[47]])*l[3])*u[6]+((p[0]*o[a+r[48]]+p[1]*o[a+r[49]]+p[2]*o[a+r[50]]+p[3]*o[a+r[51]])*l[0]+(p[0]*o[a+r[52]]+p[1]*o[a+r[53]]+p[2]*o[a+r[54]]+p[3]*o[a+r[55]])*l[1]+(p[0]*o[a+r[56]]+p[1]*o[a+r[57]]+p[2]*o[a+r[58]]+p[3]*o[a+r[59]])*l[2]+(p[0]*o[a+r[60]]+p[1]*o[a+r[61]]+p[2]*o[a+r[62]]+p[3]*o[a+r[63]])*l[3])*u[7],h[0]*=n,h[1]*=n,h[2]*=n,h[3]*=n,h[4]*=n,h[5]*=n,h[6]*=n,h[7]*=n,h[8]*=n,this.sin){var F=this.ins.dRGB(t.buffer);h[0]*=F[0],h[1]*=F[1],h[2]*=F[2],h[3]*=F[0],h[4]*=F[1],h[5]*=F[2],h[6]*=F[0],h[7]*=F[1],h[8]*=F[2]}return this.fS&&(h[0]/=g[0],h[1]/=g[1],h[2]/=g[2],h[3]/=g[0],h[4]/=g[1],h[5]/=g[2],h[6]/=g[0],h[7]/=g[1],h[8]/=g[2]),h}return!1},LUTVolume.prototype.JInv=function(t){var i=this.J(t),a=i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]);return 0!==a&&new Float64Array([(i[4]*i[8]-i[5]*i[7])/a,(i[2]*i[7]-i[1]*i[8])/a,(i[1]*i[5]-i[2]*i[4])/a,(i[5]*i[6]-i[3]*i[8])/a,(i[0]*i[8]-i[2]*i[6])/a,(i[2]*i[3]-i[0]*i[5])/a,(i[3]*i[7]-i[4]*i[6])/a,(i[1]*i[6]-i[0]*i[7])/a,(i[0]*i[4]-i[1]*i[3])/a])},LUTVolume.prototype.getDetails=function(){return{title:this.title,format:this.format,dims:3,s:this.d,min:new Float64Array([this.fL[0],this.fL[1],this.fL[2]]),max:new Float64Array([this.fH[0],this.fH[1],this.fH[2]]),C:this.getRGB(),meta:this.meta}},LUTVolume.prototype.getL=function(){return this.L.getL()},LUTVolume.prototype.getRGB=function(){for(var t,i,a=this.d,s=a+2,h=a*a*a,o=s*s*s,r=new Float64Array(h),n=new Float64Array(h),m=new Float64Array(h),e=this.mesh,p=0;p<a;p++)for(var l=0;l<a;l++)for(var u=0;u<a;u++)i=u+1+(l+1+(p+1)*s)*s,r[t=u+(l+p*a)*a]=e[i],i+=o,n[t]=e[i],i+=o,m[t]=e[i];return[r.buffer,n.buffer,m.buffer]},LUTVolume.prototype.getSize=function(){return this.d},LUTVolume.prototype.is1D=function(){return!1},LUTVolume.prototype.is3D=function(){return!0},LUTVolume.prototype.getTitle=function(){return this.title},LUTVolume.prototype.getMetadata=function(){return this.meta},LUTVolume.prototype.isClamped=function(){if(void 0===this.clamped){var t=this.minMax(),i=Math.min(t[0],t[1],t[2]),a=Math.max(t[3],t[4],t[5]);this.clamped=0===i&&a<=1||i>=0&&1===a}return this.clamped},LUTVolume.prototype.deClamp=function(){this.isClamped()&&(this.deClamp1D(),this.deClamp3D())},LUTVolume.prototype.getColourSpace=function(){this.d;var t=this.fL,i=this.fH,a=(this.fLH,{title:this.title+"CS",format:this.format,fLR:t[0],fLG:t[1],fLB:t[2],fHR:i[0],fHG:i[1],fHB:i[2]}),s=new LUTRSpline({buff:this.L.getL(),fH:i[3],fL:t[3]}),h=this.getRGB();return s.R(h[0]),s.R(h[1]),s.R(h[2]),a.buffR=h[0],a.buffG=h[1],a.buffB=h[2],new LUTVolume(a)},LUTVolume.prototype.deClamp1D=function(){for(var t,i=this.d,a=new Float64Array(i),s=new Float64Array(i),h=new Float64Array(i),o=0,r=0,n=0,m=i-1,e=i-1,p=i-1,l=this.d+2,u=l*l*l,L=this.mesh,f=!1,g=!1,c=!1,F=Math.min(this.fL[0],this.fL[1],this.fL[2]),y=Math.max(this.fH[0],this.fH[1],this.fH[2]),T=y-F,G=0;G<i;G++)t=G+1+(G+1+(G+1)*l)*l,a[G]=L[t],t+=u,s[G]=L[t],t+=u,h[G]=L[t],G>0&&(0===a[G]&&(f=!0,o=G+1),0===s[G]&&(g=!0,r=G+1),0===h[G]&&(c=!0,n=G+1));for(G=i-2;G>=0;G--)1===a[G]&&(f=!0,m=G-1),1===s[G]&&(g=!0,e=G-1),1===h[G]&&(c=!0,p=G-1);if(f||g||c){var b,U,w,M;o>m&&(b=m,m=Math.min(o-2,i-1),o=Math.max(b+2,0)),r>e&&(b=e,e=Math.min(r-2,i-1),r=Math.max(b+2,0)),n>p&&(b=p,p=Math.min(n-2,i-1),n=Math.max(b+2,0)),U=new LUTQSpline(f?new Float64Array(a.subarray(o,m-o+1)).buffer:a.buffer),w=new LUTQSpline(g?new Float64Array(s.subarray(r,e-r+1)).buffer:s.buffer),M=new LUTQSpline(c?new Float64Array(h.subarray(n,p-n+1)).buffer:h.buffer);var D=i;i<65&&(D=65);new Float64Array(D);var d=new Float64Array(D);for(G=0;G<D;G++)d[G]=G*T/(D-1)+F;var S=new Float64Array(d),v=new Float64Array(d);if(this.fS)for(G=0;G<D;G++)d[G]=(d[G]-this.fL[0])/this.fLH[0],S[G]=(S[G]-this.fL[1])/this.fLH[1],v[G]=(v[G]-this.fL[2])/this.fLH[2];this.sin&&(this.ins.FCub(d.buffer),this.ins.FCub(S.buffer),this.ins.FCub(v.buffer));for(G=0;G<D;G++)d[G]=(d[G]*(i-1)-o)/(m-o),S[G]=(S[G]*(i-1)-r)/(e-r),v[G]=(v[G]*(i-1)-n)/(p-n);U.FCub(d.buffer),w.FCub(S.buffer),M.FCub(v.buffer);for(G=0;G<D;G++)d[G]=d[G]*this.Y[0]+S[G]*this.Y[1]+v[G]*this.Y[2];return this.L=new LUTSpline({buff:d.buffer,fH:y,fL:F}),this.clamped=!1,!0}return!1},LUTVolume.prototype.deClamp3D=function(){for(var t,i,a,s,h,o,r,n,e,p,l,u=this.d,L=u+2,f=L*L*L,g=this.mesh,c=new Float64Array(u),F=new Float64Array(u),y=new Float64Array(u),T=this.minMax(),G=Math.min(0,Math.min(T[0],T[1],T[2])),b=Math.max(1,Math.max(T[3],T[4],T[5])),U=new Float64Array([G,b,G-.1,b+.175]),w=0;w<u;w++)for(var M=0;M<u;M++){h=0,o=0,r=0,n=u-1,e=u-1,p=u-1,i=!1,a=!1,s=!1;for(var D=0;D<u;D++)t=D+1+(M+1+(w+1)*L)*L,c[D]=g[t],t=M+1+(D+1+(w+1)*L)*L+f,F[D]=g[t],t=M+1+(w+1+(D+1)*L)*L+2*f,y[D]=g[t],D>0&&(0===c[D]&&(i=!0,h=D+1),0===F[D]&&(a=!0,o=D+1),0===y[D]&&(s=!0,r=D+1));for(D=u-2;D>=0;D--)1===c[D]&&(i=!0,n=D-1),1===F[D]&&(a=!0,e=D-1),1===y[D]&&(s=!0,p=D-1);if(i){h>n&&(l=n,n=Math.min(h-2,m-1),h=Math.max(l+2,0)),this.extrap(c,h,n,U);for(D=0;D<u;D++)D===h&&(D=n),g[t=D+1+(M+1+(w+1)*L)*L]=c[D]}if(a){o>e&&(l=e,e=Math.min(o-2,m-1),o=Math.max(l+2,0)),this.extrap(F,o,e,U);for(D=0;D<u;D++)D===o&&(D=e),g[t=M+1+(D+1+(w+1)*L)*L+f]=F[D]}if(s){r>p&&(l=p,p=Math.min(r-2,m-1),r=Math.max(l+2,0)),this.extrap(y,r,p,U);for(D=0;D<u;D++)D===r&&(D=p),g[t=M+1+(w+1+(D+1)*L)*L+2*f]=y[D]}}u--;for(w=1;w<u;w++){for(M=0;M<u;M++)this.n3b(w,M,0),this.n3b(w,M,u),this.n3b(w,0,M),this.n3b(w,u,M),this.n3b(0,w,M),this.n3b(u,w,M);this.n3b(w,0,0),this.n3b(w,0,u),this.n3b(w,u,0),this.n3b(w,u,u),this.n3b(0,w,0),this.n3b(0,w,u),this.n3b(u,w,0),this.n3b(u,w,u),this.n3b(0,0,w),this.n3b(0,u,w),this.n3b(u,0,w),this.n3b(u,u,w)}this.n3b(0,0,0),this.n3b(0,0,u),this.n3b(0,u,0),this.n3b(0,u,u),this.n3b(u,0,0),this.n3b(u,0,u),this.n3b(u,u,0),this.n3b(u,u,u),this.fillEdges(),this.clamped=!1},LUTVolume.prototype.extrap=function(t,i,a,s){var h,o,r=t.length;if(a-i>2?(h=.1*t[i+3]-.8*t[i+2]+2.3*t[i+1]-1.6*t[i],o=-.1*t[a-3]+.8*t[a-2]-2.3*t[a-1]+1.6*t[a]):a-i>1?(h=1,o=1):(h=t[i+1]-t[i],o=t[a]-t[a-1]),i>0)for(var n=0;n<i;n++)t[n]=t[i]+(n-i)*h;if(a<r-1)for(n=a+1;n<r;n++)t[n]=t[a]+(n-a)*o;if(void 0!==s){var m=s[0],e=s[1],p=s[2],l=s[3],u=Math.pow(p-m,2),L=p-m,f=Math.pow(l-e,2),g=l-e;for(n=0;n<r;n++)n===i&&(n=a+1),t[n]<m?t[n]=p-u/(h*(t[n]-m)+L):t[n]>e&&(t[n]=l-f/(o*(t[n]-e)+g))}},LUTVolume.prototype.fillEdges=function(){for(var t=this.d,i=0;i<t;i++){for(var a=0;a<t;a++)this.n3(i,a,-1),this.n3(i,a,t),this.n3(i,-1,a),this.n3(i,t,a),this.n3(-1,i,a),this.n3(t,i,a);this.n3(i,-1,-1),this.n3(i,-1,t),this.n3(i,t,-1),this.n3(i,t,t),this.n3(-1,i,-1),this.n3(-1,i,t),this.n3(t,i,-1),this.n3(t,i,t),this.n3(-1,-1,i),this.n3(-1,t,i),this.n3(t,-1,i),this.n3(t,t,i)}this.n3(-1,-1,-1),this.n3(-1,-1,t),this.n3(-1,t,-1),this.n3(-1,t,t),this.n3(t,-1,-1),this.n3(t,-1,t),this.n3(t,t,-1),this.n3(t,t,t)},LUTVolume.prototype.setP=function(t,i,a,s){var h=this.mesh,o=this.d-1,r=o-4,n=this.nd,m=n*n,e=m*n,p=2*e,l=t+1+(i+1)*n+(a+1)*m,u=new Float64Array([h[l],h[l+e],h[l+p]]);return h[l]=s[0],h[l+e]=s[1],h[l+p]=s[2],t<4&&(this.n3(-1,i,a),i===t&&this.n3(-1,-1,a),i===r-t&&this.n3(-1,o,a),a===t&&this.n3(-1,i,-1),a===r-t&&this.n3(-1,i,o),i===t&&a===t&&this.n3(-1,-1,-1),i===r-t&&a===t&&this.n3(-1,o,-1),i===r-t&&a===r-t&&this.n3(-1,o,o),i===t&&a===r-t&&this.n3(-1,-1,o)),t>r&&(this.n3(o,i,a),i===t&&this.n3(o,o,a),i===t-r&&this.n3(o,-1,a),a===t&&this.n3(o,i,o),a===t-r&&this.n3(o,i,-1),i===t&&a===t&&this.n3(o,o,o),i===t-r&&a===t&&this.n3(o,-1,o),i===t-r&&a===t-r&&this.n3(o,-1,-1),i===t&&a===t-r&&this.n3(o,o,-1)),i<4&&(this.n3(t,-1,a),a===i&&this.n3(t,-1,-1),a===r-i&&this.n3(t,-1,o)),i>r&&(this.n3(t,o,a),a===i&&this.n3(t,o,-1),a===i-r&&this.n3(t,o,o)),a<4&&this.n3(t,i,-1),a>r&&this.n3(t,i,o),u},LUTVolume.prototype.getP=function(t,i,a){var s=this.mesh,h=this.nd,o=h*h,r=o*h,n=2*r,m=t+1+(i+1)*h+(a+1)*o;return new Float64Array([s[m],s[m+r],s[m+n]])},LUTVolume.prototype.n3=function(t,i,a,s){var h,o,r,n,m,e=this.d-1,p=this.pR,l=this.pG,u=this.pB,L=this.nd,f=L*L,g=t+1+(i+1)*L+(a+1)*f;h=t<0?1:t>e?-1:0,o=i<0?1:i>e?-1:0,r=a<0?1:a>e?-1:0;var c=this.mesh,F=f*L,y=2*F,T=g+h+o*L+r*f;p[3]=c[T],l[3]=c[T+F],u[3]=c[T+y],T+=h+o*L+r*f,p[2]=c[T],l[2]=c[T+F],u[2]=c[T+y],T+=h+o*L+r*f,p[1]=c[T],l[1]=c[T+F],u[1]=c[T+y],T+=h+o*L+r*f,p[0]=c[T],l[0]=c[T+F],u[0]=c[T+y],m=0,p[3]===p[1]?c[g]=p[2]:m=p[3]>p[1]?1:-1,0!==m&&(((n=-.4*p[0]+2.2*p[1]-4.2*p[2]+3.4*p[3])-p[2])*m<=0&&((n=p[1]-3*p[2]+3*p[3])-p[2])*m<=0&&(n=p[2]),c[g]=n),m=0,l[3]===l[1]?c[g+F]=l[2]:m=l[3]>l[1]?1:-1,0!==m&&(((n=-.4*l[0]+2.2*l[1]-4.2*l[2]+3.4*l[3])-l[2])*m<=0&&((n=l[1]-3*l[2]+3*l[3])-l[2])*m<=0&&(n=l[2]),c[g+F]=n),m=0,u[3]===u[1]?c[g+y]=u[2]:m=u[3]>u[1]?1:-1,0!==m&&(((n=-.4*u[0]+2.2*u[1]-4.2*u[2]+3.4*u[3])-u[2])*m<=0&&((n=u[1]-3*u[2]+3*u[3])-u[2])*m<=0&&(n=u[2]),c[g+y]=n)},LUTVolume.prototype.n3b=function(t,i,a){var s,h,o,r=this.d-1,n=this.pR,m=this.pG,e=this.pB,p=this.nd,l=p*p,u=t+1+(i+1)*p+(a+1)*l;s=t<=0?1:t>=r?-1:0,h=i<=0?1:i>=r?-1:0,o=a<=0?1:a>=r?-1:0;var L=this.mesh,f=l*p,g=2*f,c=u+s+h*p+o*l;n[3]=L[c],m[3]=L[c+f],e[3]=L[c+g],c+=s+h*p+o*l,n[2]=L[c],m[2]=L[c+f],e[2]=L[c+g],c+=s+h*p+o*l,n[1]=L[c],m[1]=L[c+f],e[1]=L[c+g],c+=s+h*p+o*l,n[0]=L[c],m[0]=L[c+f],e[0]=L[c+g],L[u]=-.1*n[0]+.8*n[1]-2.3*n[2]+2.6*n[3],L[u+f]=-.1*m[0]+.8*m[1]-2.3*m[2]+2.6*m[3],L[u+g]=-.1*e[0]+.8*e[1]-2.3*e[2]+2.6*e[3]},LUTVolume.prototype.compare=function(t,i,a){var s=new Float64Array(t.slice(0)),h=new Float64Array(i.slice(0)),o=s.length;if(o!==h.length)return!1;void 0!==a?"1"===(a=a.toString().toLowerCase())||"tet"===a?this.RGBTet(h.buffer):"2"===a||"lin"===a?this.RGBLin(h.buffer):this.RGBCub(h.buffer):this.RGBCub(h.buffer);for(var r=new Float64Array(3),n=0;n<o;n+=3)r[0]+=Math.pow(h[n]-s[n],2),r[1]+=Math.pow(h[n+1]-s[n+1],2),r[2]+=Math.pow(h[n+2]-s[n+2],2);return r[0]=Math.pow(3*r[0]/o,.5),r[1]=Math.pow(3*r[1]/o,.5),r[2]=Math.pow(3*r[2]/o,.5),r},LUTVolume.prototype.NR3D=function(t,i,a,s){if(3!==t.length)return!1;var h,o,r,n,m;h="number"==typeof i?i:1e-8,h*=h,o="number"==typeof maxItrss?maxItrs:50,r=void 0!==s&&3===s.length?new Float64Array([s[0],s[1],s[2]],0):new Float64Array([t[0],t[1],t[2]],0);for(var e=0;e<o;e++){if(n=this.rgbCub(r),JInv=this.JInv(r),!JInv)return!1;if(n[0]-=t[0],n[1]-=t[1],n[2]-=t[2],r[3]=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],r[3]<h)return r[3]=0,r;if(e===o-1)return r[3]=Math.pow(r[3],.5),r;r[0]-=m[0]*n[0]+JInv[1]*n[1]+JInv[2]*n[2],r[1]-=m[3]*n[0]+JInv[4]*n[1]+JInv[5]*n[2],r[2]-=m[6]*n[0]+JInv[7]*n[1]+JInv[8]*n[2]}},LUTVolume.prototype.minMax=function(){for(var t,i=this.mesh,a=new Float64Array([9999,9999,9999,-9999,-9999,-9999]),s=(new Float64Array(3),this.d),h=this.d+2,o=h*h*h,r=0;r<s;r++)for(var n=0;n<s;n++)for(var m=0;m<s;m++)i[t=m+1+(n+1+(r+1)*h)*h]<a[0]?a[0]=i[t]:i[t]>a[3]&&(a[3]=i[t]),i[t+=o]<a[1]?a[1]=i[t]:i[t]>a[4]&&(a[4]=i[t]),i[t+=o]<a[2]?a[2]=i[t]:i[t]>a[5]&&(a[5]=i[t]);return a},LUTVolume.prototype.getLimits=function(t){var i,a=this.mesh;i=void 0!==t?t:this.minMax();for(var s,h,o=new Float64Array([9999,9999,9999,-9999,9999,9999,-9999,-9999,9999,9999,-9999,9999,9999,-9999,-9999,9999,9999,-9999,-9999,9999,-9999,-9999,-9999,-9999]),r=new Float64Array(24),n=new Float64Array([9999,9999,9999,9999,9999,9999,9999,9999]),m=new Float64Array(3),e=this.d,p=this.d+2,l=p*p*p,u=e-1,L=0;L<e;L++)for(var f=0;f<e;f++)for(var g=0;g<e;g++)h=g+1+(f+1+(L+1)*p)*p,m[0]=a[h],h+=l,m[1]=a[h],h+=l,m[2]=a[h],(s=Math.pow(m[0]-i[0],2)+Math.pow(m[1]-i[1],2)+Math.pow(m[2]-i[2],2))<n[0]&&(o[0]=m[0],o[1]=m[1],o[2]=m[2],r[0]=g,r[1]=f,r[2]=L,n[0]=s),(s=Math.pow(m[0]-i[3],2)+Math.pow(m[1]-i[1],2)+Math.pow(m[2]-i[2],2))<n[1]&&(o[3]=m[0],o[4]=m[1],o[5]=m[2],r[3]=g,r[4]=f,r[5]=L,n[1]=s),(s=Math.pow(m[0]-i[3],2)+Math.pow(m[1]-i[4],2)+Math.pow(m[2]-i[2],2))<n[2]&&(o[6]=m[0],o[7]=m[1],o[8]=m[2],r[6]=g,r[7]=f,r[8]=L,n[2]=s),(s=Math.pow(m[0]-i[0],2)+Math.pow(m[1]-i[4],2)+Math.pow(m[2]-i[2],2))<n[3]&&(o[9]=m[0],o[10]=m[1],o[11]=m[2],r[9]=g,r[10]=f,r[11]=L,n[3]=s),(s=Math.pow(m[0]-i[0],2)+Math.pow(m[1]-i[4],2)+Math.pow(m[2]-i[5],2))<n[4]&&(o[12]=m[0],o[13]=m[1],o[14]=m[2],r[12]=g,r[13]=f,r[14]=L,n[4]=s),(s=Math.pow(m[0]-i[0],2)+Math.pow(m[1]-i[1],2)+Math.pow(m[2]-i[5],2))<n[5]&&(o[15]=m[0],o[16]=m[1],o[17]=m[2],r[15]=g,r[16]=f,r[17]=L,n[5]=s),(s=Math.pow(m[0]-i[3],2)+Math.pow(m[1]-i[1],2)+Math.pow(m[2]-i[5],2))<n[6]&&(o[18]=m[0],o[19]=m[1],o[20]=m[2],r[18]=g,r[19]=f,r[20]=L,n[6]=s),(s=Math.pow(m[0]-i[3],2)+Math.pow(m[1]-i[4],2)+Math.pow(m[2]-i[5],2))<n[7]&&(o[21]=m[0],o[22]=m[1],o[23]=m[2],r[21]=g,r[22]=f,r[23]=L,n[7]=s);for(var c=0;c<24;c++)r[c]/=u;this.sin&&new LUTRSpline({buff:this.ins.getL()}).R(r.buffer);if(this.fS){var F=this.fL,y=this.fLH;for(c=0;c<24;c+=3)r[c]=r[c]*y[0]+F[0],r[c+1]=r[c+1]*y[1]+F[1],r[c+2]=r[c+2]*y[2]+F[2]}return{minMax:i,i:r,o:o}};var workerLUTString=getLUTString();